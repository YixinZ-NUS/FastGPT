|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# ODCによるOceanBaseデータベースへの接続

ODCはOceanBaseデータベースのMySQLテナントへの接続をサポートしています。本記事では、この接続方法の前提条件と接続操作について説明します。

## 前提条件

OceanBase開発者センター(ODC)がデプロイされていることを確認し、Web版ODCのURLを取得します。デプロイの詳細な操作については、[ODCデプロイ](https://en.oceanbase.com/docs/community-odc-en-10000000000841976)を参照してください。

## 操作手順

Web版ODCにおける個人接続(mysql@tenant)を作成する例を挙げます。具体的な操作手順は以下のとおりです。

1. ODCのログイン画面にアクセスし、ログイン画面に登録したアカウント、パスワード、そして認証コードを入力した後、**ログイン**をクリックします。

   <!-- ![ODCにログイン](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/340/ODC%20%E7%99%BB%E5%BD%95%E9%A1%B5.png) -->

2. ODCのホームページの**個人接続**タブを開き、右上の**新規接続**をクリックして個人接続を作成します。

   <!-- ![作成1](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/400/OBServer%20create%20connection.png) -->

   <main id="notice" type='explain'>
    <h4>説明</h4>
    <p>ODCが初めて実行されるとき、ロード時間が長くなる場合がありますので、しばらくお待ちください。</p>
   </main>

3. 接続タブを作成するには、以下の情報を入力または選択する必要があります。既にOceanBaseデータベース接続文字列をお持ちの場合、以下の情報は接続文字列から直接取得できます(mysql -h **ホスト名** -P **ポート番号** -u **データベースユーザー名@テナント名** # **クラスタ名** -D **デフォルトデータベース** -p '**データベースパスワード**')。または、タブ内のスマート解析ツールを使用して自動入力することも可能です。

   <!-- ![作成2](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/odc/400/%E6%96%B0%E5%BB%BA%E4%B8%AA%E4%BA%BA%E8%BF%9E%E6%8E%A5-1.png) -->

   |     情報項目     |  説明  |
   |-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | データベースタイプ       | **物理データベース**または**論理データベース**を選択します。<ul><li> 物理データベース：通常のデータベース。</li><li> 論理データベース：ODP (Sharding)。 </li></ul>  |
   | **所属リージョン** | 接続が存在するリージョンとして**独立デプロイ/プライベートクラウド**を選択します。 |
   | 接続名        | この接続の名前を指定します。    |
   | タグの設定        | タグを利用して、接続に補足説明などの情報を追加できます。<br>**接続名**テキストボックスの後ろにある**タグの設定**ボタンをクリックして、現在の接続にタグを指定します。表示されるドロップダウンリストで、タグの設定や管理ができます： <ul><li>タグの設定：ドロップダウンリストから対象のタグを選択して設定を完了します。リストが空の場合は、まず新しいタグを作成してください。   </li><li>タグの管理：リスト最下部の**新規タグ**ボタン、またはリスト上部の設定アイコンをクリックすると、**タグ管理**ウィンドウが表示されます。タグ管理ウィンドウでは、作成したタグを編集または削除できます。また、上部の**新規タグ**ボタンをクリックして、新しいタグ名とアイコンの色を指定できます。</li></ul> |
   | スマート解析        | テキストボックスに接続文字列を貼り付けると、ODCが自動的にそれを認識し、各接続情報をウィンドウに自動入力します。 |
   | 接続モード        | **MySQL**を選択します(論理データベースはMySQLモードのみをサポートしています)。 |
   | 接続アドレス        |<ul><li>**ホストIPアドレス**：接続先のデータベース存在するサーバーのIPアドレス情報。</li><li>**ポート**：接続先データベースが存在するサーバーのポート番号情報。</li><li>**クラスタ名**：接続先のデータベースが存在するクラスタの名前(論理データベースは入力不要)。</li><li>**テナント名**：接続先のデータベースが存在するテナントの名前(論理データベースは入力不要)。 </li></ul> <main id="notice" type='explain'><h4>説明</h4><p>ホスト名とポート番号は、パブリッククラウドやOCP上で作成されたテナントなど、接続先のデータベースが存在するテナントの情報ページから取得できます。</p></main>|
   | データベースアカウント       | <ul><li>**データベースユーザー名**：テナント内で作成されたアカウント(MySQLモードの場合、このアカウントはデフォルトデータベースへのアクセス権限が必要です)。</li><li>**データベースパスワード**：テナント内で作成されたアカウントのパスワード。パスワード入力欄の隣にある**接続テスト**ボタンをクリックして、対象のデータベースに接続できるかどうかをテストします。</li><li>**パスワードの保存**：この項目をオフにすると、接続情報にデータベースのパスワード情報が保存されません。接続または接続テストを行うたびに、表示されるウィンドウでパスワードを入力する必要があります。この項目をオンにすると、接続情報にパスワードが保存され、次回の接続時からパスワード入力が不要になります。</li></ul><main id="notice" type='explain'><h4>説明</h4><p><ul><li>設定情報が誤っている場合、ユーザー名またはパスワードが間違っている、ネットワーク異常など、エラーメッセージが表示されます。</li><li>ユーザーは自身が所属するテナント内のデータベースにのみ接続できます。それ以外の場合、接続テストが失敗したエラーが報告されます。</li><li>ODC V4.0.0以降のバージョンでは、アカウントとパスワードを入力しなくても接続を保存することができます。</li></ul></p></main>|
   | デフォルトデータベース/schema(オプション)       | MySQLテナント内のデータベースに接続する際に、この接続で使用されるデフォルトデータベースを入力する必要があります。<main id="notice" type='explain'><h4>説明</h4><p>MySQLモードでは、デフォルトのデータベースを指定しない場合、自動的にinformation_schemaデータベースに接続されます。information_schemaデータベースへの接続に失敗した場合は、デフォルトデータベースをそのユーザーが権限を持つデータベースに設定してください。</p></main>|
   | SQLクエリのタイムアウト  | SQLのタイムアウト時間はカスタマイズ可能で、SQLクエリが指定された時間を超えると自動的にクエリが終了します(デフォルトは60秒)。  |
   | sysテナントアカウント設定 | sysテナントアカウントを使用してテナントビューを照会するかどうかを選択し、チェックを入れた場合は**アカウント**と**パスワード**を入力します。<br>データベースタイプが物理データベースの場合、`sys`テナントビューの照会権限を持つアカウントとパスワードを入力してください。**接続アドレス**に**テナント**がsysとして指定されている場合、この項目は自動的に入力されます。<ul><li>**アカウント**：sysテナントビューの表示権限を持つアカウント。</li><li>**パスワード**：アカウントに対応するパスワード。</li></ul> アカウントとパスワード情報を入力した後、パスワード入力欄の隣にある**接続テスト**ボタンをクリックして、アカウント情報が正しいかどうか確認します。<main id="notice" type='explain'><h4>説明</h4><p><ul><li> ODC V2.3.0以降のバージョンでは、インポートおよびエクスポート機能は、接続作成時の詳細設定でroot@sysユーザーを設定する必要があります。</li><li> ODC V2.4.1以降のバージョンでは、インポートおよびエクスポート機能のビュー情報のクエリにおけるroot@sysアカウントへの強い依存が解除されました(root@sysアカウントが設定されていない場合、ODCの一部のオブジェクト、例えばストアドプロシージャや関数などはエクスポート機能をサポートしていません。root@sysアカウントが設定されている場合、`sys`テナント下のビュー情報にアクセスすることで最適なデータルーティング戦略が得られ、エクスポート速度が向上します)。</li><li> **sysテナントアカウントとパスワード**は、クラスタテナント内のユーザーのアカウントとパスワードです(アカウントに「@sys#クラスタ」と入力しないでください)。例：アカウントはrootです。 </li></ul></p></main>|

4. ページ下部の**保存**ボタンをクリックすると、現在の設定情報がODC接続リストに永続的に保存されます。再度ODCにログインする際、接続設定リストからその接続を直接選択することができます。接続設定を保存する際、接続テストが成功している必要はありません。

   <main id="notice" type='explain'>
    <h4>説明</h4>
    <p>保存する前に、<b>接続テスト</b>をクリックしてデータベース接続テストを行うことができます。データベースのユーザー名とパスワードが正しい場合、<b>接続成功</b>と表示されます。</p>
   </main>

## 関連ドキュメント

ODCのその他の機能の紹介と使用方法については、対応するバージョンの[ODCプロダクトドキュメント](https://en.oceanbase.com/docs/odc-en)を参照してください。
