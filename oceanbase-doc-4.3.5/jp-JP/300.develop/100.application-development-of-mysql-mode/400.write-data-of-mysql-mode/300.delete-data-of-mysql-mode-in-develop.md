|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# データの削除

テーブルにデータを挿入した後、`DELETE` ステートメントやその他のステートメントを使用して、テーブルのレコードを削除することができます。本記事では、関連するステートメントの使い方と例を紹介します。

## データ削除の準備

テーブルデータを削除する前に、以下の点を確認してください：

* データベースのMySQLテナントに接続していることを確認してください。データベースへの接続操作については、[接続方法の概要](../100.connect-to-oceanbase-database-of-mysql-mode/100.connection-methods-overview-of-mysql-mode.md)を参照してください。

  <main id="notice" type='explain'>
     <h4>説明</h4>
     <p>現在ログインしているテナントが属するテナントモードは、<code>sys</code> テナントで <code>oceanbase.DBA_OB_TENANTS</code> ビューをクエリすることで確認できます。</p>
  </main>

* 操作対象テーブルに対する `DELETE` 権限を保有していることを確認してください。`TRUNCATE TABLE` ステートメントでテーブルデータを削除するには、そのテーブルに対する `CREATE` 権限も必要です。現在のユーザー権限を確認する操作の詳細については、[ユーザー権限の確認](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974756)を参照してください。該当する権限を持っていない場合は、管理者に連絡し権限の付与を依頼してください。ユーザー権限に関する操作については、[直接権限付与](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974754)を参照してください。

## DELETEステートメントによるデータの削除

通常、テーブルの一部またはすべてのデータを削除するには、[DELETE](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974138) ステートメントを使用します。

  <main id="notice" type='explain'>
    <h4>説明</h4>
    <p><code>DELETE</code> ステートメントの他に、<code>REPLACE INTO</code> ステートメントでもデータを削除される場合があります。<code>REPLACE INTO</code> ステートメントに関する操作と例については、<a href="400.replace-data-of-mysql-mode-in-develop.md">データの置換</a>を参照してください。</p>
  </main>

シンプルな `DELETE` ステートメントの構文は次のとおりです：

```sql
DELETE FROM table_name [ WHERE condition ] ;
```

|          パラメータ           | 必須 |                説明                                    |
|-------------------------|---------|--------------------------------------------------------|
| table_name              | はい      | 削除対象のテーブルを指定します。                                     |
| [ WHERE condition ]     | いいえ      | 条件句は、削除対象のデータが満たす必要がある条件を指定します。条件句が指定されない場合、テーブル全体が削除されます。 |

### 一部データの削除

`DELETE` ステートメントに `WHERE` 条件を追加することで、条件に合致する一部データをテーブルから削除できます。

`t_insert` テーブルから `value = 10004` に一致するすべての行レコードを削除します。例：

```sql
obclient [test]> DELETE FROM t_insert WHERE value = 10004;
Query OK, 1 row affected
```

### すべてのデータの削除

テーブル内のデータ量が少ない場合、`DELETE` ステートメントを使用してすべての行を直接削除できます。

例：

* `t_insert` テーブルからすべての行データを削除します。

  ```sql
  obclient [test]> DELETE FROM t_insert;
  Query OK, 3 row affected
  ```

  テーブル内のデータレコードが100万件を超える場合、一度に削除を実行するとパフォーマンスに影響を与える恐れがあるため、テーブル内の情報に基づいて `WHERE` 条件を使用して、データを数回に分けて削除するか、直接 **TRUNCATE TABLEステートメントを使用してテーブルデータを削除する** ことを推奨します。

* `t_insert` テーブル内の `value` 列のデータをフィルタリングし、複数のステートメントを個別に実行し、`value < 10000`、`value < 20000`、`value < 30000` のデータを数回に分けて削除します。

  ```sql
  obclient [test]> DELETE FROM t_insert WHERE value < 100000;

  obclient [test]> DELETE FROM t_insert WHERE value < 200000;

  obclient [test]> DELETE FROM t_insert WHERE value < 300000;
  ```

## TRUNCATE TABLEステートメントによるテーブルデータの削除

`TRUNCATE TABLE` ステートメントは、指定されたテーブルを完全に削除しますが、テーブルの構造、つまりテーブルで定義されたパーティション情報は保持します。論理的には、このステートメントは、すべての行を削除する `DELETE FROM` ステートメントと同じです。

`TRUNCATE TABLE` ステートメントの構文は以下のとおりです：

```sql
TRUNCATE [TABLE] table_name;
```

`TRUNCATE TABLE` ステートメントを使用して、`t_insert` テーブル内のすべてのデータを削除します。例：

```sql
obclient [test]> TRUNCATE TABLE t_insert;
```

`TRUNCATE TABLE` ステートメントの使用方法と説明の詳細については、[TRUNCATE TABLE](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974163)を参照してください。

## 関連ドキュメント

* [データの挿入](../400.write-data-of-mysql-mode/100.insert-data-of-mysql-mode-in-develop.md)

* [データの更新](../400.write-data-of-mysql-mode/200.update-data-of-mysql-mode-in-develop.md)

* [データの置換](../400.write-data-of-mysql-mode/400.replace-data-of-mysql-mode-in-develop.md)
