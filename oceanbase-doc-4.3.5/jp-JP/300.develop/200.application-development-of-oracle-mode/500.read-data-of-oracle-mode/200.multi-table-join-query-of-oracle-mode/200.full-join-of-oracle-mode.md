|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|

# FULL JOIN

完全結合（FULL JOIN）とは、完全外部結合を表します。このステートメントを使用することで、結合したすべてのテーブルのすべての行を、マッチするかどうかに関係なく返すことができます。

## 背景情報

外部結合（OUTER JOIN）は、比較演算子を使用して2つのテーブルのデータを比較します。結合結果には結合条件に合致する行だけでなく、条件に合致しない行も含まれます。

外部結合には、完全結合（FULL JOIN）、左結合（LEFT JOIN）、右結合（RIGHT JOIN）が含まれます。外部結合は、結合条件を満たすすべての行を返すと同時に、どちらか一方のテーブルにのみ存在する（もう一方のテーブルに対応する行がない）行も返します。その際、対応する行がない側のテーブルの列は`NULL`で補完されます。

本記事では主に完全結合の例を説明します。左結合に関連する例については、[左結合](../200.multi-table-join-query-of-oracle-mode/300.left-join-of-oracle-mode.md) を、右結合に関連する例については [右結合](../200.multi-table-join-query-of-oracle-mode/400.right-join-of-oracle-mode.md)を参照してください。

## FULL JOIN構文

外部結合ステートメントには一般的に左テーブルと右テーブルが含まれ、`JOIN` 句の最も左側に記述されているテーブルが左テーブル、`JOIN` 句の最も右側に記述されているテーブルが右テーブルです。

FULL JOINの構文は以下のとおりです：

```sql
SELECT select_list FROM table_name1 FULL JOIN table_name2 ON join_condition
[ WHERE query_condition ]
[ ORDER BY column_list ];
```

ここで、`table_name1` が左テーブル、`table_name2` が右テーブルとなります。

## 例

サンプルテーブルを作成し、適切なデータを挿入します。

```sql
obclient [SYS]> CREATE TABLE tbl_a(id NUMBER NOT NULL PRIMARY KEY, name VARCHAR2(50));
Query OK, 0 rows affected

obclient [SYS]> CREATE TABLE tbl_b(num NUMBER NOT NULL PRIMARY KEY, value NUMBER);
Query OK, 0 rows affected

obclient [SYS]> INSERT INTO tbl_a VALUES(1,'ab'),(2,'cd'),(3,'ef'),(4,'gh');
Query OK, 6 rows affected
Records: 6  Duplicates: 0  Warnings: 0

obclient [SYS]> INSERT INTO tbl_b VALUES(1,1001),(3,1003),(5,1005);
Query OK, 4 rows affected
Records: 4  Duplicates: 0  Warnings: 0
```

### シンプルな完全結合クエリ

完全結合クエリを使用する場合、左テーブルまたは右テーブルの行でマッチする行が見つからない場合、システムは自動的に `NULL` を埋めます。

例1：テーブル `tbl_a` とテーブル `tbl_b` で完全結合クエリを実行し、実行結果を取得します。

```sql
obclient [SYS]> SELECT * FROM tbl_a;
+----+------+
| ID | NAME |
+----+------+
|  1 | ab   |
|  2 | cd   |
|  3 | ef   |
|  4 | gh   |
+----+------+
4 rows in set

obclient [SYS]> SELECT * FROM tbl_b;
+-----+-------+
| NUM | VALUE |
+-----+-------+
|   1 |  1001 |
|   3 |  1003 |
|   5 |  1005 |
+-----+-------+
3 rows in set

obclient [SYS]> SELECT * FROM tbl_a FULL JOIN tbl_b ON tbl_a.id=tbl_b.num;
+------+------+--------+-------+
| ID   | NAME |   NUM  | VALUE |
+------+------+--------+-------+
|    1 | ab   |      1 |  1001 |
|    2 | cd   |   NULL |  NULL |
|    3 | ef   |      3 |  1003 |
|    4 | gh   |   NULL |  NULL |
| NULL | NULL |      5 |  1005 |
+------+------+--------+-------+
5 rows in set
```

ご覧のように、テーブル `tbl_a` には値が `5` の行がないため、実行結果でその行のレコードは `NULL` が埋め込まれています。テーブル `tbl_b` には値が `2`、`4` の行がないため、結果でこれら2行は `NULL` が埋め込まれています。

### 完全結合とWHERE句の組み合わせ使用

完全結合で結合結果を取得した後、`WHERE` 句を使用して結合結果をフィルタリングできます。

例2：テーブル `tbl_a` とテーブル `tbl_b` で完全結合クエリを実行した後、`tbl_b` テーブルの `value=1003` のデータを返します。

```sql
obclient [SYS]> SELECT * FROM tbl_a;
+----+------+
| ID | NAME |
+----+------+
|  1 | ab   |
|  2 | cd   |
|  3 | ef   |
|  4 | gh   |
+----+------+
4 rows in set

obclient [SYS]> SELECT * FROM tbl_b;
+-----+-------+
| NUM | VALUE |
+-----+-------+
|   1 |  1001 |
|   3 |  1003 |
|   5 |  1005 |
+-----+-------+
3 rows in set

obclient [SYS]> SELECT * FROM tbl_a FULL JOIN tbl_b ON tbl_a.id=tbl_b.num WHERE tbl_b.value=1003;
+----+------+-----+-------+
| ID | NAME | NUM | VALUE |
+----+------+-----+-------+
|  3 | ef   |   3 |  1003 |
+----+------+-----+-------+
1 row in set
```

## 関連ドキュメント

* [INNER JOIN](../200.multi-table-join-query-of-oracle-mode/100.inner-join-of-oracle-mode.md)

* [LEFT JOIN](../200.multi-table-join-query-of-oracle-mode/300.left-join-of-oracle-mode.md)

* [RIGHT JOIN](../200.multi-table-join-query-of-oracle-mode/400.right-join-of-oracle-mode.md)
