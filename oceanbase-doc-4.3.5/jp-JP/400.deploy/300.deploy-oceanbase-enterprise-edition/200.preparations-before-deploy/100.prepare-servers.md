|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# サーバーの準備

## OCPを使用したOceanBaseクラスタのデプロイ

サーバーの最小構成要件は以下の表のとおりです：

| デプロイするプロダクト | サーバー数 | 機能最小構成 | パフォーマンス最小構成 | ディスクタイプ |
|---------|-----------|-------------|-------------|------|
| OAT | 1台、OCPサーバーと共用可能 | CPU：2コア</br>メモリ：4GB | N/A | N/A |
| OCPとMetaDB | 1台 | CPU：16コア</br>メモリ：32GB</br>ディスク：1.5TBストレージ(OATに必要なリソースを含む)<main id="notice" type='explain'><h4>説明</h4><p>16C32Gの構成ではOCPの安定性を保証できません。検証用途のみでの使用を推奨します。</p></main>| CPU：32コア</br>メモリ：128GB</br>ディスク：1.5TB、10ギガビットNIC(OATに必要なリソースを含む) | SSDストレージ |
| OceanBaseクラスタ | 3台 <main id="notice" type='explain'><h4>説明</h4><p>スタンドアロン版のOceanBaseデータベースをデプロイする場合は、1台のサーバーのみ必要です。</p></main> | CPU：4コア</br>メモリ：16GB <main id="notice" type='explain'><h4>説明</h4><p><ul><li>ディスクのログディスクはメモリの3倍以上の容量が必要であり、データディスクはターゲットデータの容量を満たす必要があります。</li><li>OBServerサーバーのメモリ設定は1TB以下を推奨します。</li><li>OBServerサーバーのCPUコア数は512コア以下を推奨します。</li></ul></p></main> | CPU：32コア</br>メモリ：256GB、10ギガビットNIC<main id="notice" type='explain'><h4>説明</h4><p><ul><li>ディスクのログディスクはメモリの3倍以上の容量が必要であり、データディスクはターゲットデータの容量を満たす必要があります。</li><li>OBServerサーバーのメモリ設定は1TB以下を推奨します。</li><li>OBServerサーバーのCPUコア数は512コア以下を推奨します。</li></ul></p></main> | SSDストレージ |
| (オプション)ODP | 3台、OBServerノードサーバーと共用可能 | CPU：4コア</br>メモリ：8GB</br>ディスク：200GB | N/A | N/A |

<main id="notice" type='explain'>
  <h4>説明</h4>
  <p><ul><li>OceanBaseデータベースクラスタは、高可用性とディザスタリカバリのために、少なくとも3つのノードで構成されます。各ノードは1つのobserverプロセスに対応し、異なるノード上の複数のobserverプロセスが1つのクラスタを形成して外部にサービスを提供します。</li><li>OCP管理サービスに高可用性が必要な場合は、複数の管理サーバーによる高可用性デプロイが必要です。詳細は<a href="https://en.oceanbase.com/docs/common-ocp-10000000002169955">OCPデプロイの概要</a>を参照してください。</li><li>OceanBaseクラスタのデプロイ後、ODPのデプロイが必要かどうかは、主にアプリケーションのシナリオとニーズによって決まります：<ul><li>アプリケーションがOceanBaseクラスタの高可用性、ロードバランシング、接続プール管理などを必要とする場合は、ODPのデプロイを検討することができます。ODPは、OceanBaseクラスタの接続数やロードバランシングなどの問題を効果的に解決し、アプリケーションの安定性と信頼性を向上させます。</li><li>アプリケーションがOceanBaseクラスタに接続してクエリと操作のみを行い、高可用性、ロードバランシング、接続プール管理などの機能を必要としない場合は、ODPをデプロイせずに、OceanBaseが提供するクライアントライブラリを使用してクラスタに直接接続することで、アプリケーションのニーズを満たせます。</li><li>カラムストアレプリカント(columnstore replica)を使用する場合は、独立したODPをデプロイする必要があります。カラムストアレプリカントに関する情報は、<a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974664">カラムストアレプリカント</a>を参照してください。</li></ul>ODPの詳細な特性については、<a href="https://en.oceanbase.com/docs/common-odp-doc-en-10000000002135903">ODPの概要</a>を参照してください。</li></ul></p>
</main>

## コマンドラインを使用したOceanBaseクラスタのデプロイ

サーバーの最小構成要件は以下の表のとおりです：

| デプロイするプロダクト | サーバー数 | 機能最小構成 | パフォーマンス最小構成 | ディスクタイプ |
|---------|-----------|-------------|-------------|------|
| OAT | 1台 | CPU：2コア</br>メモリ：4GB | N/A | N/A |
| OceanBaseクラスタ | 3台 <main id="notice" type='explain'><h4>説明</h4><p>スタンドアロン版のOceanBaseデータベースをデプロイする場合は、1台のサーバーのみ必要です。</p></main> | CPU：4コア</br>メモリ：16GB <main id="notice" type='explain'><h4>説明</h4><p><ul><li>ディスクのログディスクはメモリの3倍以上の容量が必要であり、データディスクはターゲットデータの容量を満たす必要があります。</li><li>OBServerサーバーのメモリ設定は1TB以下を推奨します。</li><li>OBServerサーバーのCPUコア数は512コア以下を推奨します。</li></ul></p></main> | CPU：32コア</br>メモリ：256GB、10ギガビットNIC<main id="notice" type='explain'><h4>説明</h4><p><ul><li>ディスクのログディスクはメモリの3倍以上の容量が必要であり、データディスクはターゲットデータの容量を満たす必要があります。</li><li>OBServerサーバーのメモリ設定は1TB以下を推奨します。</li><li>OBServerサーバーのCPUコア数は512コア以下を推奨します。</li></ul></p></main> | SSDストレージ |
| (オプション)ODP | 3台、OBServerノードサーバーと共用可能 | CPU：4コア</br>メモリ：8GB</br>ディスク：200GB | N/A | N/A |

<main id="notice" type='explain'>
  <h4>説明</h4>
  <p><ul><li>OceanBaseデータベースクラスタは、高可用性とディザスタリカバリのために、少なくとも3つのノードで構成されます。各ノードは1つのobserverプロセスに対応し、異なるノード上の複数のobserverプロセスが1つのクラスタを形成して外部にサービスを提供します。</li><li>OceanBaseクラスタのデプロイ後、ODPのデプロイが必要かどうかは、主にアプリケーションのシナリオとニーズによって決まります：<ul><li>アプリケーションがOceanBaseクラスタの高可用性、ロードバランシング、接続プール管理などを必要とする場合は、ODPのデプロイを検討することができます。ODPは、OceanBaseクラスタの接続数やロードバランシングなどの問題を効果的に解決し、アプリケーションの安定性と信頼性を向上させます。</li><li>アプリケーションがOceanBaseクラスタに接続してクエリと操作のみを行い、高可用性、ロードバランシング、接続プール管理などの機能を必要としない場合は、ODPをデプロイせずに、OceanBaseが提供するクライアントライブラリを使用してクラスタに直接接続することで、アプリケーションのニーズを満たせます。</li><li>カラムストアレプリカントを使用する場合は、独立したODPをデプロイする必要があります。カラムストアレプリカントに関する情報は、<a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974664">カラムストアレプリカント</a>を参照してください。</li></ul>ODPの詳細な特性については、<a href="https://en.oceanbase.com/docs/common-odp-doc-en-10000000002135903">ODPの概要</a>を参照してください。</li></ul></p>
</main>

## アービトレーションサーバー

3台のサーバーを使用して2レプリカのOceanBaseクラスタとアービトレーションサービスをデプロイする場合、アービトレーションサーバーは以下の最低マシン仕様を満たしている必要があります：

| バージョン | サポートされる最小構成 | 帯域幅 | 備考 |
| ------ | ------ | ------ | ------ |
| V4.1.0.0 | <ul><li>CPU：2コア </li><li>メモリ：8GB </li><li>ディスク：CLogディスクには、少なくとも5GBのディスク容量が必要です。| 入出力データの転送速度がいずれも20Mbps以上であること。 | データ保存用のディスク容量(`data`ディスク)の設定は不要です。ログファイル保存用の`log`ディレクトリには、別途容量を確保する必要があります。|
| V4.1.0 BP1以降のバージョン | <ul><li>CPU：2コア </li><li>メモリ：4GB </li><li>ディスク：CLogディスクには、少なくとも5GBのディスク容量が必要です。 | 入出力データの転送速度がいずれも20Mbps以上であること。 | データ保存用のディスク容量(`data`ディスク)の設定は不要です。ログファイル保存用の`log`ディレクトリには、別途容量を確保する必要があります。 |

### リソース計画

CPU型番の参考：Intel(R) Xeon(R) CPU E5-2682 v4 @ 2.50GHz

アービトレーションサーバーのリソース計画は以下のルールを参考にしてください：

* 最小構成マシン(2C4G)は、デフォルトで32個のユーザーテナントと`sys`テナントが同時にアービトレーションを有効にできます(2Fまたは4F、`primary_zone=RANDOM`、`unit_num=1`)。
* シングルユニットのテナント（2Fまたは4F、`primary_zone=RANDOM`、`unit_num=1`）が32個増えるごとに、アービトレーションサーバーのリソースを少なくとも以下のように増やす必要があります：1C1G、ログディスク2GB、ネットワーク帯域幅20Mbps。
* `unit_num=N`(N>1)の場合、単純にN個のシングルユニットテナントとして扱うことができます。

<main id="notice" type='explain'>
  <h4>説明</h4>
  <p><ul><li> 2F：2レプリカクラスタ。</li><li> 4F：4レプリカクラスタ。</li><li> <code>primary_zone=RANDOM</code>：<code>PRIMARY_ZONE</code>を指定する場合、その値を<code>RANDOM</code>(必ず大文字)に設定できます。これは、最も高い優先度を持つゾーンをの中からランダムに1つを選択して<code>Primary Zone</code>とすることを示します。</li><li> <code>unit_num=1</code>：リソースプールにおける対象ZoneのUnit数が1であることを示します。</li><li>シングルユニットテナント：あるゾーン内のユニット数が1のテナントを指します。</li></ul>  <code>primary_zone</code>と<code>unit_num</code>に関する詳細情報は、<a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001971591">テナントの作成</a>を参照してください。</p>
</main>

### ネットワーク遅延要件

アービトレーションサーバーとOceanBaseクラスタノード間の片道ネットワーク遅延は800ms以下である必要があります。
