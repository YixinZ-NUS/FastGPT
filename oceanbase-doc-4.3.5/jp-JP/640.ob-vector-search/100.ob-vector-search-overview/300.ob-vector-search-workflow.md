| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |

# OceanBaseのベクトル検索を利用したAIアプリケーションのワークフロー

この記事では、OceanBaseのベクトル検索を使用したAIアプリケーションのワークフローについて説明します。

## 概要

従来のリレーショナルデータベースの機能と、高度なベクトル検索および大規模言語モデル技術を組み合わせることで、最新のAIアプリケーション開発におけるアーキテクチャを提供します。これにより、マルチモーダルデータのインテリジェントな処理と効率的な活用が実現します。OceanBaseデータベースは、その中で重要な役割を果たし、強力なデータストレージとベクトル検索機能を提供することで、このようなAIアプリケーションを構築するための強固な基盤を築きます。

<!--AI应用工作流图示 ![AI应用工作流](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V4.3.5/vector_search/AI-Workflow1.jpg)

## 主要なステップの解説

**1. 非構造化データをベクトル埋め込み処理を経て特徴ベクトルに変換**

ワークフローは、ビデオ、ドキュメント、画像などの非構造化データから始まります。様々な形式の非構造化データは、ベクトル埋め込み(vector embedding)モデルによってベクトルデータ表現に変換されます。このモデルのタスクは、元の形式では類似度の直接計算が困難な非構造化データを、高次元のベクトルデータ(Vectors)に変換することです。これらのベクトルは、データのセマンティック情報と特徴を捉えることができ、ベクトル空間におけるベクトル同士の距離を計算することで、データの類似度を表現できます。詳細については、[ベクトル埋め込み技術](../150.ob-vector-search-generate-vector-embeddings.md)を参照してください。

**2. OceanBaseデータベースにベクトル埋め込みの保存、およびベクトルインデックスの作成**

OceanBaseデータベースは、コアとなるストレージ層として、すべてのデータの保存を担当します。これには、従来のリレーショナルテーブル（ビジネスデータの保存に使用されるもの）や、非構造化データ、ベクトル埋め込みによって生成されたベクトルデータが含まれます。詳細については、[ベクトルデータの保存](../160.ob-vector-search-store-vector-embeddings.md)を参照してください。

高効率なベクトル検索を実現するために、OceanBaseデータベース内ではベクトルデータのためのベクトルインデックスが構築されます。ベクトルインデックスは、特定のデータ構造であり、高次元のベクトル空間内での近傍検索を大幅に加速することができます。ベクトルの類似度計算は負荷が高いため、精度を重視した逐次的な距離計算による検索は、結果の正確さは保証しますが、クエリのパフォーマンスが急激に低下します。ベクトルインデックスを使用することで、システムは候補となるベクトルを迅速に特定し、計算すべきベクトルの数を大幅に削減することができます。これにより、高い精度を維持しながら、クエリの効率を大幅に向上させることが可能です。詳細については、[ベクトルインデックスの作成](../200.ob-vector-index.md)を参照してください。

**3. SQL/SDKによる最近傍探索とハイブリッド検索の実行**

ユーザーはクライアントまたはプログラミング言語を使用してAIアプリケーションとインタラクションし、検索リクエストを提出します。これらのリクエストは、テキスト、画像、その他の形式である可能性があります。詳細については、[対応クライアントとプログラミング言語](../700.ob-vector-search-reference/900.ob-vector-search-supported-clients-and-languages/100.ob-vector-search-supported-clients-and-languages-overview.md)を参照してください。

OceanBaseは、SQL文を使用してリレーショナルデータの検索と管理を行い、スカラー（標準）データとベクトルデータを組み合わせたハイブリッド検索を実現します。ユーザーが検索を発行すると、もしその検索が非構造化データに関連している場合、システムはまずベクトル埋め込みモデルを用いてそのデータをベクトルに変換します。次に、システムはベクトルインデックスとスカラーインデックスを活用して、クエリベクトルに最も類似した、かつスカラー条件を満たすベクトルデータを迅速に検索し、最も関連性の高い非構造化データを取得します。詳細については、[最近傍探索](../300.ob-vector-similarity-search.md)を参照してください。

**4. プロンプトを生成し、LLMに送信して推論を実行**

最終的な段階では、ハイブリッド検索の結果を基に最適化されたプロンプト(Prompt)を生成し、それを大規模言語モデル(LLM)に提出して完全な推論処理を実行します。LLMはこれらのコンテキスト情報を元に自然言語のレスポンスを生成します。また、LLMとベクトル埋め込みモデルの間にはフィードバックループが存在し、LLMの出力やユーザーのフィードバックがベクトル埋め込みモデルの最適化に活用され、継続的な学習と改善のサイクルが形成されます。
