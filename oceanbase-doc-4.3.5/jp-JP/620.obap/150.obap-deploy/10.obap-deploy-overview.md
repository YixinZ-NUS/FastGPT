# デプロイの概要

必要に応じて、適切なプロダクトの形態、デプロイプラン、デプロイ方法を選択できます。

## 適切なプロダクトの形態の選択

OceanBaseデータベースではEnterprise EditionとCommunity Editionの2つのバージョンが用意されています。

* OceanBaseデータベースEnterprise Edition：完全に自社開発のエンタープライズレベルのネイティブ分散データベースであり、一般的なハードウェア上で金融業界が求める高可用性を実現し、「3リージョン5データセンター(IDC)」アーキテクチャにより、都市レベルの無損失自動ディザスタリカバリの新基準を確立し、TPC-Cベンチマークにおいて世界記録を更新したことがあります。単一クラスタで1,500ノードを超える規模にも対応可能で、クラウドネイティブ、強い整合性、そしてOracleやMySQLとの高い互換性を誇ります。
* OceanBaseデータベースCommunity Edition：MySQLと互換性があり完全に自社開発された、集中型と分散型が統合されたオープンソースデータベースで、ネイティブ分散アーキテクチャを採用しています。金融業界が求める高可用性、透過的なスケーラビリティ、分散トランザクション、マルチテナント、構文の互換性などのエンタープライズ向けの機能をサポートしています。

OceanBase Enterprise EditionとCommunity Editionの機能の違いについては、[Enterprise EditionとCommunity Editionの機能の違い](../../100.learn-more-about-oceanbase/200.differences-between-enterprise-edition-and-community-edition.md)を参照してください。

## 適切なデプロイプランの選択

OceanBaseデータベースは、単一サーバー（単一データセンターでのOceanBaseクラスタのデプロイ）、データセンター（同一都市内の複数データセンターでのOceanBaseクラスターのデプロイ、以下「IDC」と総称）、都市（複数都市にまたがるOceanBaseクラスタのデプロイ）といったレベルでの高可用性と災害対策をサポートしています。単一データセンター構成、二重データセンター構成、二リージョン三センター構成、三リージョン五センター構成での展開が可能であり、さらにアービトレーションサービスを導入することでコストを抑えることもできます。

各デプロイプランの詳細については、[OceanBaseクラスタ高可用性デプロイプランの概要](../../400.deploy/200.introduction-to-oceanbase-cluster-high-availability-deployment-scheme.md)を参照してください。

## 適切なデプロイ方法の選択

|**プロダクト形態**|**使用シナリオ**|**推奨デプロイ方式**|**デプロイツール**|
|---|---|---|---|
| **OceanBase Enterprise Edition** | 本番環境 | OceanBaseクラスタのデプロイには、OCPの使用を推奨します。<br/>具体的な操作については、[OCPを使用した3レプリカOceanBaseクラスタのデプロイ](../../400.deploy/300.deploy-oceanbase-enterprise-edition/300.deploy-through-a-graphical-interface/300.deploy-oceanbase-cluster-use-ocp/500.deploy-three-oceanbase-replica-clusters-use-ocp.md)を参照してください。 | OAT + OCP |
|**OceanBase Enterprise Edition** | 非本番環境 | コマンドラインを使用してOceanBaseクラスタをデプロイできます。<br/>詳細な操作方法については、[コマンドラインを使用した3レプリカOceanBaseクラスタのデプロイ](../../400.deploy/300.deploy-oceanbase-enterprise-edition/400.deploy-through-the-command-line/200.deploy-the-oceanbase-cluster-command-line/400.deploy-three-oceanbase-replica-clusters.md)を参照してください。 | oatcliコマンドラインツール |
| **OceanBase Community Edition** | オンライン環境 | 標準的なデプロイには、obdを使用することを推奨します。<br/>具体的な操作については、[obd GUIによるOceanBaseクラスタのデプロイ](../../400.deploy/500.deploy-oceanbase-database-community-edition/200.local-deployment/400.deploy-by-ui/100.deploy-by-obd.md)を参照してください。 | obd |
| **OceanBase Community Edition**  | kubernetes環境 | ob-operatorを使用してデプロイすることを推奨します。<br/>具体的な操作については、[KubernetesクラスタでのOceanBaseデータベースのデプロイ](../../400.deploy/500.deploy-oceanbase-database-community-edition/300.deploy-in-the-k8s-cluster.md)を参照してください。 | ob-operator |
| **OceanBase Community Edition**  | ネイティブ対応ではないOS(例：MACおよびWindows)でのクイックスタートシナリオ | Dockerイメージを使用したデプロイを推奨します。<br/>具体的な操作については、[OceanBaseデータベースコンテナ環境のデプロイ](../../400.deploy/500.deploy-oceanbase-database-community-edition/200.local-deployment/700.deploy-by-docker.md)の**プラン3：OceanBaseコンテナ環境のデプロイ**の項を参照してください。 |  |
| **OceanBase Community Edition**  | ネイティブ対応のOS (Linuxシリーズ、詳細はサポート対象OS一覧を参照)のクイックスタートシナリオ | obdを使用してデプロイすることを推奨します。具体的な操作については、公式Webサイトの『OceanBaseインストール・デプロイツール』記事の [クイックスタート/OceanBaseデータベースのクイックデプロイ](https://en.oceanbase.com/docs/community-obd-en-10000000002136403)の **プラン1：OceanBaseデモ環境のデプロイ** または **プラン2：OceanBaseクラスタ環境のデプロイ** を参照してください。 | obd |

## リソースの計画

適切なデプロイプランを選択してデプロイを開始する前に、デプロイに必要なリソースを計画して準備する必要があります。
* サーバの設定要件については、[サーバの準備](../../400.deploy/300.deploy-oceanbase-enterprise-edition/200.preparations-before-deploy/100.prepare-servers.md)を参照してください。

## カラムストアレプリカント(columnstore replica)のデプロイ

TP強化型の混合ワークロード（準リアルタイムの意思決定分析）シナリオに対応するため、OceanBaseデータベースは読み取り専用カラムストアレプリカント(Column Store Replica)をサポートしています。ユーザーはカラムストアレプリカントを独立したゾーン（Zone）にデプロイできます。カラムストアレプリカントでは、すべてのユーザーテーブル(レプリケーションテーブルを含み、インデックステーブル、内部テーブル、システムテーブルを除く)は、カラムストア形式で格納されます。OLAP系のワークロードは、専用のODPアクセスポイントを経由してこのカラムストアレプリカントにアクセスし、弱い整合性読み取り方式で意思決定分析などの処理を実行します。

<!-- ![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/ap/ap-deploy-1.png) -->

ログストリームに注目すると、カラムストアレプリカント上の同じログストリームのすべてのユーザーテーブルは、major sstableレベルで純粋なカラムストア形式で格納されます。さらに、カラムストアレプリカントは、一般的な読み取り専用レプリカと同様に、レプリカ分散や弱い整合性読み取りreleaseの仕組みなど、すべてのルールに従います。major sstableの保存形式が異なる点を除けば、カラムストアレプリカントと読み取り専用レプリカは似ており、選出やログ投票に参加せず、完全なsstable/clog/memtableをすべて保持しています。

カラムストアレプリカントをデプロイした後は、ルーティング転送ポリシーと弱整合性読み取りリクエストを設定する必要があります。これにより、OLAPリクエストが自動的に弱整合性読み取りクエストに変換され、対応するカラムストアレプリカントに転送されるようになります。

## カラムストアレプリカントを使用する際の注意事項

- カラムストアレプリカントを使用する場合、OceanBaseクラスタは追加操作なしで、通常のアーキテクチャに応じてデプロイできます。

- カラムストアレプリカントへのアクセスには独立したODPの配置が必要となるため、カラムストアレプリカントが存在するゾーンには、カラムストアレプリカントのみをデプロイすることを推奨します。さらに、ODPをデプロイする際には、バージョンがODP V4.3.2以降である必要があります。

- テナントを作成する際には、Localityを設定することで、特定のゾーン上のレプリカをカラムストアレプリカントとして指定できます。テナント作成の詳細については、CREATE TENANTを参照してください。

- カラムストアレプリカントを使用する際には、ルーティング転送ポリシーと弱い整合性読み取りリクエストを設定する必要があります。カラムストアレプリカント使用の詳細については、[カラムストアレプリカントの使用](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001976349)を参照してください。
