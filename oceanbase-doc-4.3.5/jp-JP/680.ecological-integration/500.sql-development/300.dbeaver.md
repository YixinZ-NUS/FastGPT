|description||
|---|---|
|keywords||
|dir-name|DBeaver|
|dir-name-en|DBeaver|
|tenant-type|MySQL Mode|

# DBeaverを使用してOceanBaseデータベースに接続する

DBeaverは汎用的なデータベースクライアントツールであり、各データベースが提供するJDBCドライバーを使用してデータベースに接続します。リレーショナルデータベース、非リレーショナルデータベース、分散データベースなど、一般的なデータベースに対応しています。

DBeaverに付属するOceanBaseドライバーまたはMySQLドライバーのいずれかを使用して、OceanBaseデータベースのMySQLテナントに接続できます。本記事では、OceanBaseドライバーを例に、DBeaverを使用してOceanBaseデータベースのMySQLテナントに接続する方法を紹介します。

## 前提条件

* DBeaverを取得しインストール済みであることを確認してください。[DBeaver公式ダウンロードURL](https://dbeaver.io/download/)から、お使いのシステムに対応するDBeaverをダウンロードしてください。

* 接続するOBServerノードのIPアドレスとDBeaverが配置されているマシンとの間でネットワーク接続が確立されていることを確認してください。

* OceanBaseデータベースがインストール済みで、MySQLモードのテナントが作成されていること。

## 操作手順

### ステップ1：データベース接続文字列を取得する

OceanBaseデータベースのデプロイ担当者または管理者から、該当するデータベース接続文字列を取得します。例：

```
obclient -h$host -P$port -u$user_name -p$password -D$database_name
```

**パラメータの説明：**

* `$host`：OceanBaseデータベースへの接続IPアドレスを提供します。OceanBaseデータベースプロキシ(OceanBase Database Proxy、ODP)接続方式はODPアドレスを使用し、直接接続方式はOBServerノードのIPアドレスを使用します。
* `$port`：OceanBaseデータベースへの接続ポートを提供します。ODP接続方式のデフォルトポートは `2883` で、ODPデプロイ時にカスタマイズ可能です。直接接続方式のデフォルトポートは `2881` で、OceanBaseデータベースのデプロイ時にカスタマイズ可能です。
* `$database_name`：アクセスするデータベースの名前です。

    <main id="notice" type='notice'>
        <h4>注意</h4>
        <p>テナントに接続するユーザーに、データベースに対する <code>CREATE</code>、<code>INSERT</code>、<code>DROP</code>、および <code>SELECT</code> 権限が付与されていなければなりません。ユーザー権限の詳細については、<a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001974758">MySQLモードの権限分類</a>を参照してください。</p>
    </main>

* `$user_name`：テナントの接続アカウント。ODP接続の一般的な形式：`ユーザー名@テナント名#クラスタ名` または `クラスタ名:テナント名:ユーザー名`。直接接続方式の形式：`ユーザー名@テナント名`。
* `$password`：アカウントのパスワード。

接続文字列の詳細については、[OBClientを使用してOceanBaseテナントに接続する](https://en.oceanbase.com/docs/common-oceanbase-database-10000000001971649)を参照してください。

**例：**

```shell
obclient -hxxx.xxx.xxx.xxx -P2881 -utest_user001@mysql001 -p****** -Dtest
```

### ステップ2：DBeaverコンソールを使用してOceanBaseデータベースに接続する

<main id="notice" type='notice'>
    <h4>説明</h4>
    <p>DBeaverのバージョンによって操作画面が異なる場合があります。本記事では、DBeaver 22.0.5を例にデータベース接続の手順を説明します。他のバージョンでの操作については、DBeaverの対応するバージョンのプロダクトドキュメントを参照してください。</p>
</main>

1. (オプション)ドライバーファイルのバージョンを変更します。

   DBeaver内のOceanBaseドライバーのデフォルトのドライバーファイルはmysql-connector-java-5.1.44です。この記事ではmysql-connector-java-5.1.47を例に説明します。ドライバーファイルの変更については次の手順を参照してください。

   1. MySQL公式 [JDBCドライバーのダウンロード](https://downloads.mysql.com/archives/c-j/) URLから5.1.47バージョンのドライバーファイルをダウンロードします。

   2. **データベース** > **ドライバーマネージャー** をクリックし、OceanBaseを検索します。OceanBaseドライバーを選択し、**編集** をクリックしてドライバー編集ページに入ります。

   3. **ライブラリ** タブを選択し、OceanBaseドライバーに付属するドライバーファイルを選択して **削除** をクリックします。

   4. **ファイルの追加** をクリックして、ダウンロードしたドライバーファイルをライブラリに追加し、**OK** をクリックするとドライバーファイルの置き換えが完了します。

2. **データベース** > **データベース接続の新規作成** をクリックして、**データベースの選択** ページに入ります。**ファイル** の下のコネクターをクリックすることもできます！[コネクター](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V3.1.3/zh-CN/1.users-guide/5.database-connection-and-routing/4.administrator-guide-connect-to-oceanbase-database/4.connect-to-oceanbase-database-through-dbeaver-01.png)直接 **データベースの選択** ページに入ります。

   <!-- ![データベースの選択](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V3.1.3/zh-CN/1.users-guide/5.database-connection-and-routing/4.administrator-guide-connect-to-oceanbase-database/4.connect-to-oceanbase-database-through-dbeaver-02.png) -->

3. **データベースの選択** ページで **OceanBase** を選択し、**次へ** をクリックします。**接続の設定** ページに入り、`Host`、`Port`、`Tenant`、ユーザー名、パスワードを入力し、**接続テスト** をクリックします。

   <!-- ![テスト](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V3.1.3/zh-CN/1.users-guide/5.database-connection-and-routing/4.administrator-guide-connect-to-oceanbase-database/4.connect-to-oceanbase-database-through-dbeaver-03.png) -->

   <main id="notice" type='notice'>
       <h4>説明</h4>
       <p>IPアドレスを介する直接接続、またはOBProxyプロキシを介する接続の2つの方法でデータベースに接続することができます。直接接続する場合は、Portに設定された<code>mysql_port</code>を入力して接続します。デフォルトのポートは2881です。OBProxyを使用して接続する場合は、Portに設定された <code>proxy_port</code> を入力します。デフォルトポートは2883です。</p>
   </main>

4. **接続テスト** でポップアップウィンドウに **接続済み** と表示された場合、接続が成功したことを表します。**OK** をクリックし、**完了** をクリックすると、OceanBaseデータベースに接続できます。

   <!-- ![接続成功](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V3.1.3/zh-CN/1.users-guide/5.database-connection-and-routing/4.administrator-guide-connect-to-oceanbase-database/4.connect-to-oceanbase-database-through-dbeaver-04.png) -->

5. **データベースナビゲーション** バーのデータベース名をダブルクリックして開くと、以下のように表示されます。これはOceanBaseデータベースへの接続に成功したことを表します。

   <!-- ![接続結果](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V3.1.3/zh-CN/1.users-guide/5.database-connection-and-routing/4.administrator-guide-connect-to-oceanbase-database/4.connect-to-oceanbase-database-through-dbeaver-05.png) -->

## 詳細情報

DBeaverを使用してOceanBaseデータベースに接続する際に問題が発生した場合は、[DBeaverクライアント公式使用ドキュメント](https://dbeaver.com/docs/dbeaver/)を参照することを推奨します。
