|description||
|---|---|
|keywords||
|dir-name|WebLogic|
|dir-name-en|WebLogic|
|tenant-type|Oracle Mode, MySQL Mode|

# WebLogicを使用してOceanBaseデータベースに接続する

WebLogicは、Oracle社が提供するJava EE (Jakarta EE)アプリケーションサーバーであり、エンタープライズ向けのJavaアプリケーションをデプロイおよび実行するために使用されます。銀行、証券、保険などの金融機関で広く利用されており、高同時実行性、分散アーキテクチャ、クラスタ管理をサポートし、勘定系システムや証券取引システムなどの大規模な業務システムで頻繁に使用されます。

## 前提条件

* Oracle JDKがインストールされていることを確認してください(WebLogicはOpenJDKをサポートしていません)。
* WebLogic Server 14.1.1以降のバージョンを取得し、インストール済みであることを確認してください。
* 接続対象のOBServerノードのIPと、WebLogicがインストールされているマシンとの間でネットワーク接続が確立されていることを確認してください。
* OceanBaseデータベースV4.3.5以降のバージョンを作成し、テナントが作成済みであることを確認してください。

## 操作手順

### ステップ1：インストールファイルのダウンロードと準備

1. [Oracle WebLogic Serverのダウンロードページ](https://www.oracle.com/technetwork/middleware/weblogic/downloads/index.html)にアクセスし、Generic Installer (`fmw_14.1.1.0.0_wls.jar`)をダウンロードします。

2. WebLogicのインストールと実行に使用するシステムユーザーを作成します（root権限での実行が必要です）：

   ```bash
   # rootユーザーに切り替えてから以下のコマンドを実行します
   groupadd weblogic
   useradd -g weblogic weblogic
   passwd weblogic
   # ユーザーのパスワードを2回入力して設定を完了します
   ```

3. ダウンロードした`fmw_14.1.1.0.0_wls.jar`をサーバーの`/home/weblogic/`ディレクトリにアップロードし、権限を設定します：

   ```bash
   chown weblogic:weblogic /home/weblogic/fmw_14.1.1.0.0_wls.jar
   ```

4. rootユーザーで`/opt/weblogic`ディレクトリを作成し、権限を付与します：

   ```bash
   mkdir -p /opt/weblogic/oraInventory
   mkdir -p /opt/weblogic/Oracle
   mkdir -p /opt/weblogic/Oracle/Middleware
   chmod 777 /opt/weblogic
   chown -R weblogic:weblogic /opt/weblogic
   ```

5. oraInst.locファイルを作成します：

   ```bash
   cd /opt/weblogic
   echo "inventory_loc=/opt/weblogic/oraInventory
   inst_group=weblogic" > oraInst.loc
   ```

6. レスポンスファイルwls.rspを作成します：

   ```bash
   echo "[ENGINE]
   Response File Version=1.0.0.0.0
   [GENERIC]
   ORACLE_HOME=/opt/weblogic/Oracle/Middleware
   INSTALL_TYPE=WebLogic Server" > wls.rsp
   ```

### ステップ2：WebLogicのインストール

1. weblogicユーザーに切り替えてインストールを実行します：

   ```bash
   su - weblogic
   cd /home/weblogic
   java -jar fmw_14.1.1.0.0_wls.jar -silent -responseFile /opt/weblogic/wls.rsp -invPtrLoc /opt/weblogic/oraInst.loc
   ```

2. インストール完了後、WebLogicドメインを作成します：

   ```bash
   source /opt/weblogic/Oracle/Middleware/wlserver/server/bin/setWLSEnv.sh
   mkdir -p /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain
   cd /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain
   $JAVA_HOME/bin/java $JAVA_OPTIONS -Xmx1024m -XX:MaxPermSize=2048m weblogic.Server
   ```

3. OceanBaseクライアントをドメインディレクトリにアップロードします：

   ```bash
   # oceanbase-clientを以下のディレクトリにアップロードします
   /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain/lib/
   ```

### ステップ3：OceanBaseデータソースの設定

1. WebLogic管理コンソールにログインします(デフォルトのアドレス：`http://<hostname>:7001/console`)

2. 左側のナビゲーションパネルで、**サービス** > **データソース**を選択します。

3. **新規** > **汎用データソース**をクリックします。

4. データソース情報を入力します：

   * 名前：`obmysql`
   * JNDI名：`JNDI/obmysql`
   * データベースのタイプ：`其他`

5. データベース接続を設定します：

   * ドライバ・クラス名：`com.oceanbase.jdbc.Driver`
   * URL：`jdbc:oceanbase://<host>:<port>/<database>`
   * ユーザー名：`<username>`
   * パスワード：`<password>`

6. **構成のテスト**をクリックして接続を検証します。

7. **終了**をクリックして設定を保存します。

## 詳細情報

WebLogic経由でOceanBaseデータベースに接続する際に問題が発生した場合は、[Oracle WebLogicの公式ドキュメント](https://www.oracle.com/java/weblogic/)を参照するか、OceanBaseのテクニカルサポートにお問い合わせください。
