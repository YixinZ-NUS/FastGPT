|description||
|---|---|
|keywords|PowerJob, 任务调度, OceanBase|
|dir-name|PowerJob|
|dir-name-en|PowerJob|

# PowerJobとOceanBaseデータベースの連携

PowerJobは分散型のタスクスケジューリングプラットフォームであり、メタデータストレージデータベースとしてOceanBaseをサポートしています。このガイドでは、PowerJobがバックエンドデータベースとしてOceanBaseを使用するように設定し、さまざまなタイプのタスクをスケジューリングする方法について説明します。

## 前提条件

- Java 8以降がインストール済みであること
- OceanBaseデータベース4.0以降がデプロイ済みであること

## 操作手順

### ステップ1：PowerJobのダウンロード

以下のコマンドを実行してPowerJobをダウンロードします。

```bash
git clone https://github.com/PowerJob/PowerJob.git
```

### ステップ2：OceanBaseデータベース接続の設定

1. OceanBaseデータベースとユーザーを作成します。

    ```sql
    -- データベースの作成
    CREATE DATABASE powerjob_db;

    -- ユーザーの作成
    CREATE USER 'powerjob'@'%' IDENTIFIED BY 'your_password';

    -- 権限の付与
    GRANT ALL ON powerjob_db.* TO 'powerjob'@'%';
    ```

2. PowerJob Serverのサブプロジェクトにある日常環境用の設定ファイル`application-daily.properties`を修正し、OceanBaseデータベースへの接続を設定します：

    ```properties
    # データベースドライバ
    spring.datasource.core.driver-class-name=com.mysql.cj.jdbc.Driver
    # データベース接続情報
    spring.datasource.core.jdbc-url=jdbc:mysql://your_host:2881/powerjob_db?useUnicode=true&characterEncoding=UTF-8
    # データベースのユーザー名
    spring.datasource.core.username=powerjob
    # データベースのパスワード
    spring.datasource.core.password=your_password
    # データベース接続プールの設定
    spring.datasource.core.maximum-pool-size=20
    spring.datasource.core.minimum-idle=5
    ```

### ステップ3：PowerJobプロジェクトをIDEにインポートする

1. 普段お使いのJava IDE (IntelliJ IDEAやEclipseなど)を開きます。
2. **プロジェクトのインポート**または**Open Project**を選択し、先ほどダウンロードした`PowerJob`ディレクトリを選択して、IDEのウィザードに従ってプロジェクトのインポートと依存関係の読み込みを完了させます。

### ステップ4：PowerJob Serverの起動

1. IDEでエントリクラス`tech.powerjob.server.PowerJobServerApplication`を起動します。
2. 起動後、ブラウザで `http://localhost:7700`にアクセスすると、PowerJobの管理画面が表示されます。

## 参考ドキュメント

- [PowerJob公式ドキュメント](http://www.powerjob.tech/)
- [OceanBaseドキュメント](https://jp.oceanbase.com/docs/oceanbase-database)
