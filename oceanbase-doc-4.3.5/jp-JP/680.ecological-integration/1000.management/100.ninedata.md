|description|  |
|---|---|
|keywords| |
|dir-name|NineData|
|dir-name-en|NineData|
|tenant-type|MySQL Mode|

# NineDataを使用したOceanBaseデータソースの管理

NineDataデータベースDevOpsは、データアセット管理、データクエリ、SQL実行、データ編集、データインポートとエクスポート、SQL承認フロー、SQL規範事前検査、承認プロセス、機密データ保護などの強力な機能を備えており、ユーザーがさまざまな環境でのデータ管理タスクを迅速に完了するのに役立ちます。

## 前提条件

* NineDataプラットフォームのアカウントを登録していること。詳細については、[NineData](https://www.ninedata.cloud/home)の登録を参照してください。
* OceanBaseデータベースがインストール済みであること。
* ターゲットデータソースに対する読み取り専用、DML、またはDDL権限を持っていることを確認する必要があります。
* 商用版(データベースDevOpsプロフェッショナル版、データベースDevOps Enterprise Edition)をご利用の場合、年間または月間サブスクリプションの有効期限が切れていないことをご確認ください。有効期限が切れている場合、データベースDevOpsサービスをご利用いただけなくなりますのでご注意ください。

## 操作手順

### ステップ1：OceanBaseデータベース接続情報を取得する

OceanBaseデータベースのデプロイ担当者または管理者に連絡して、対応するデータベース接続情報を取得します。

```sql
obclient -hxx.xx.xx.xx -P2883 -uroot@mysql#cluster -p**** -A
```

### ステップ2：OceanBase for MySQLデータソースを追加する

1. [NineData](https://console.ninedata.cloud)コンソールにログインします。
2. 左側のナビゲーションバーで、**データソース管理** > **データソース** をクリックします。

    <!-- ![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V4.3.2/1..png) -->

3. **データソース** タブをクリックし、ページ上の **データソースの作成** をクリックします。表示されるデータソースタイプのポップアップで、**カスタムデータベース** > **OceanBase for MySQL** を選択し、**データソースの作成** ページで以下のテーブルに基づいてパラメータを設定します。

    <!-- ![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V4.3.2/2.png) -->

    **パラメータの説明**

    |パラメータ|説明|
    |----|----|
    |データソースの名前|データソースの名前を入力します。後の検索や管理を容易にするため、できるだけ意味のある名前を使用することを推奨します。|
    |接続方式|データソースへのアクセス方法を選択します。インターネットアドレス、ゲートウェイ、SSH Tunnelの3つの方法でアクセスできます。<ul><li>インターネットアドレス：インターネットアドレス経由でデータソースにアクセスします。</li><li>ゲートウェイ：NineDataが提供する安全かつ迅速なイントラネットアクセス方式は、まずデータソースが配置されているホストに接続する必要があります</li><li>SSH Tunne：SSHトンネル経由でデータソースにアクセスします。</li>|
    |接続方式がインターネットアドレスを選択する構成パラメータ|接続先アドレス：データソースのインターネット接続アドレスとポート。|
    |接続方式がゲートウェイを選択する構成パラメータ|<ul><li>ゲートウェイ：データソースが配置されているホストにインストールされているNineDataゲートウェイを選択します。</li><li>接続先アドレス：localhost (データソースがローカルマシンにある場合)またはデータソースが配置されているホストのイントラネットIPアドレスとして記述できます。</li>|
    |接続方式がSSH Tunnelを選択する構成パラメータ|<ul><li>SSHホスト：ターゲットデータソースが配置されているサーバーのインターネットIPアドレスまたはドメイン名、および対応するポート番号(SSHサービスのデフォルトポート番号は22です)を入力します。<li>SSH認証方式：SSHの認証方法を選択します。</li><ul><li>パスワード認証：SSHユーザー名(つまりサーバーのログイン名)とパスワード(つまりサーバーのログインパスワード)を使用して接続します。</li><ul><li>SSHユーザー名：ターゲットデータソースが配置されているサーバーのログインユーザー名を入力します。</li><li>パスワード：ターゲットデータソースが配置されているサーバーのログインパスワードを入力します。</li></ul><li>秘密鍵認証(推奨)：SSHユーザ名と秘密鍵ファイルを使って接続します。</li><ul><li>SSHユーザー名：ターゲットデータソースが配置されているサーバーのログインユーザー名を入力します。</li><li>秘密鍵ファイル：ファイルのアップロードをクリックして秘密鍵ファイルをアップロードします。つまり、サフィックスのない秘密鍵ファイルをアップロードします。</li><li>合言葉：秘密鍵ファイルの生成時に設定したパスワードを入力します。秘密鍵の生成時にパスワードを設定しなかった場合は、空白のままにしてください。</li><main id="notice" type='explain'><h4>説明</h4><p>SSHの設定が完了した後、右側の接続テストをクリックする必要があります。以下の2つの結果が表示される可能性があります：<ul><li>接続成功と提示される場合：SSH Tunnelが確立されたことを示します。</li><li>エラーメッセージが提示される場合：接続に失敗したことを示します。エラーメッセージに従ってトラブルシューティングを行い、再試行する必要があります。</li></p></main></ul> <li>接続先アドレス：localhost (データソースがローカルマシンにある場合)またはデータソースが配置されているホストのイントラネットIPアドレスとして記述できます。</li></ul>|
    |データベースアカウント|データソースのユーザー名。|
    |データベースパスワード|データソースのパスワード。|
    |アクセスリージョン | データソースの所在地に最も近いリージョンを選択することで、ネットワーク遅延を効果的に低減させることができます。|
    |環境 | データソースの実際のビジネス用途に基づいて選択し、データソースの環境識別子として設定します。デフォルトで本番環境と開発環境を提供しており、お客様がカスタム環境の作成にも対応しています。<main id="notice" type='explain'><h4>説明</h4><p>組織モードでは、データベース環境は権限ポリシー管理にも適用できます。例えば、デフォルトの本番環境の管理者ロールは、本番環境のデータソースへのアクセスのみをサポートし、他の環境のデータソースにはアクセスできません。</p></main>|
    |暗号化転送 | データソースへのアクセスにSSL暗号化方式を使用するかどうか(デフォルトでは有効)。データソースがSSL暗号化接続を強制する場合は、このスイッチを有効にする必要があります。有効にしないと接続に失敗します。<br>右側のスイッチをクリックすると、暗号化転送のオンとオフを切り替えることができます。暗号化転送の左側にある \> をクリックすると、詳細な設定を展開できます。<ul><li>暗号化オプション：以下の2つの方式をサポートしています。<ul><li>可能な限り暗号化転送の使用：サーバーのSSLステータスを自動検出します。サーバーでSSLが有効になっている場合は、SSL接続が優先され、サーバーでSSLが有効になっていない場合は、非SSL方式で接続します。</li><li>強制的に暗号化転送の使用：必ずSSL方式でデータソースに接続します。サーバーがこの方式をサポートしていない場合や、その他の理由でSSL接続を確立できない場合は、接続が失敗します。</li></ul><li>暗号化秘密鍵(SSL Cipher)の指定：SSL-Cipher暗号化アルゴリズムを指定します。</li><li>サーバー証明書(SSL CA)の検証：OceanBaseサーバーが自己署名CAによって発行された証明書を使用している場合は、ここでCAのルート証明書をアップロードする必要があります。</li><li>サーバー側身元の検証(SSL Identify)：サーバーの名前やIPアドレスなどを検証するためにチェックを入れ、接続先が実際のOceanBaseサーバーであることを確認します。これにより、中間者攻撃(Man-in-the-Middle Attack)を防止します。</li><li>クライアントの検証：OceanBaseサーバーがクライアントからの証明書を要求する場合、ここでクライアントの証明書と秘密鍵をアップロードする必要があります。OceanBaseサーバーはアップロードされた情報を検証し、接続のセキュリティを確保します。</li></ul><main id="notice" type='explain'><h4>説明</h4><p>通常、OceanBaseサーバーがSSL暗号化接続をサポートしている場合、暗号化転送を強制的に使用するのを、選択するだけで済みます。他のオプションを設定する必要はありません。システムが接続するために自動的に秘密鍵を生成します。</li></p></main>|

4. サービスが正常に接続できるようにするため、**データソースの作成** ページで **アクセスリージョン** を選択し、以下の図に示された位置にあるNineDataサービスのIPアドレスをサーバーのアローリストに追加してください。

    <!-- ![](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V4.3.2/3.png) -->

5. すべての設定が完了したら、**データソースの作成** の右側にある **接続テスト** をクリックして、データソースに正常にアクセスできるかどうかをテストできます。接続に成功した旨のメッセージが表示されたら、**データソースの作成** をクリックして、データソースの追加を完了します。そうでなければ、接続設定を再度確認し、接続テストが成功するまで行ってください。

## 次のステップ

接続操作が完了した後、NineDataの使用を開始することができます。NineDataの詳細な操作ガイドについては、[NineData](https://docs.ninedata.cloud/en/)の公式ドキュメントを参照してください。
