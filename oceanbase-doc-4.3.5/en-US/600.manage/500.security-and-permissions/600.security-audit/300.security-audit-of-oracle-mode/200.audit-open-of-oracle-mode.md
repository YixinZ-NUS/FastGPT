|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|

# Enable security auditing

This topic describes how to enable the auditing feature and set the storage location for auditing records.

In OceanBase Database, auditing-related operations are performed by the built-in `ORAAUDITOR` user. The password and privileges for this user are specified by the `SYS` user.

## Procedure

1. Log in to the Oracle-compatible tenant as the `SYS` user and unlock the `ORAAUDITOR` user.

   ```shell
   obclient> ALTER USER ORAAUDITOR ACCOUNT UNLOCK;
   ```

   <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>By default, the <code>ORAAUDITOR</code> user is created in OceanBase Database and is locked. You must unlock this user before enabling security auditing.</p>
   </main>

2. Set the login password for the `ORAAUDITOR` user.

   For security, the login password for the `ORAAUDITOR` user must be specified by the `SYS` user. If you need to change the password later, set a new one.

   ```shell
   obclient> ALTER USER ORAAUDITOR IDENTIFIED BY ******;
   ```

3. Grant privileges to the `ORAAUDITOR` user.

   By default, the `ORAAUDITOR` user has no privileges. To perform security auditing operations, grant the `CREATE SESSION` privilege to the `ORAAUDITOR` user using the `GRANT` statement. To allow the user to view auditing records, also grant the `SELECT ANY DICTIONARY` privilege.

   ```shell
   obclient> GRANT CREATE SESSION, SELECT ANY DICTIONARY TO ORAAUDITOR;
   ```

4. Enable the auditing feature and set the storage location for auditing records.

   Enable the auditing feature by setting the `audit_trail` parameter. The setting takes effect immediately. Valid values for this parameter are:

   * `NONE`: disables auditing (default value).

   * `OS`: writes auditing records to local disk files.

   * `DB`: writes auditing records to internal tables.

   * `DB,EXTENDED` / `DB_EXTENDED`: writes auditing records to internal tables and includes executed SQL statements.

   Example:

   ```shell
   obclient> ALTER SYSTEM SET audit_trail = 'DB,EXTENDED';
   ```

   For more information about the `audit_trail` parameter, see [audit_trail](../../../../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/400.audit_trail.md).

   <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>Auditing records can be written to internal tables or local disk files:</p>
      <ul>
      <li>Disk files: Auditing records are asynchronously written to the <code><installation directory>/audit/</code> directory. The default file is <code>/home/admin/oceanbase/audit/observer_xx_xxxxxx.aud</code>.</li>
      <li>Internal tables: Audit information is written directly to system tables. The internal table <code>__all_tenant_security_audit_record</code> stores audit records. The internal tables <code>__all_virtual_audit_operation</code> and <code>__all_virtual_audit_action</code> store mappings between audit-related <code>ID</code> and <code>Name</code> fields.</li>
      </ul>
   </main>

## What to do next

After enabling security auditing, you can set specific security auditing rules. For more information, see [Set and view auditing rules](300.set-up-and-view-audit-rules-of-oracle-mode.md).

   <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>Security auditing begins only after the <code>ORAAUDITOR</code> user sets auditing rules.</p>
   </main>

## References

For more information about security auditing, see:

* [Set and view auditing rules](300.set-up-and-view-audit-rules-of-oracle-mode.md)
* [View auditing records](500.audit-records-of-oracle-mode.md)