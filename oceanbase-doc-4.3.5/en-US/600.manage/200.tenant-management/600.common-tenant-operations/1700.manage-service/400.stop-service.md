|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# Stop a service

You can execute the `STOP SERVICE` statement to stop a running service.

## Limitations

You cannot execute the `STOP SERVICE` statement in a session created based on a service name.

## Prerequisites

* You have the `ALTER SYSTEM` privilege.

* The units for the tenant do not contain temporarily offline OBServer nodes.

  For more information about how to query temporarily offline OBServer nodes in the units for a tenant, see **Prerequisites** in [Create a service](100.create-service.md).
  
  If the units for a tenant contains permanently offline OBServer nodes, make sure that the OBServer nodes are offline due to breakdown. Otherwise, the OBServer nodes may still provide the service after the service is changed to the `STOPPED` state.

## Procedure

1. Log in to a user tenant or the `sys` tenant of the cluster as the tenant administrator.

   Note that you must specify the corresponding parameters in the following sample code based on your actual database configurations.

   ```shell
   obclient -h10.xx.xx.xx -P2883 -uroot@sys#obdemo -p***** -A
   ```

2. Check whether the service to be stopped is in the `STOPPED` state.

   For more information, see [Query the service status](200.view-service-status.md).

   If the service is not in the `STOPPED` state, verify that the `SWITCHOVER_STATUS` value of the tenant is `NORMAL`, which indicates that the tenant is not in an intermediate state during primary/standby switchover. You can query the `SWITCHOVER_STATUS` value of a tenant in either of the following ways:

   * Query the `SWITCHOVER_STATUS` value of a specified tenant in the `sys` tenant.

      ```shell
      obclient [oceanbase]> SELECT TENANT_ID, TENANT_NAME, SWITCHOVER_STATUS FROM oceanbase.DBA_OB_TENANTS WHERE TENANT_NAME = mysql_tenant;
      ```

   * Query the `SWITCHOVER_STATUS` value of a user tenant in the current tenant.

      :::tab
      tab MySQL mode

      The query statement in MySQL mode is as follows:

      ```shell
      obclient [oceanbase]> SELECT TENANT_ID, TENANT_NAME, SWITCHOVER_STATUS FROM oceanbase.DBA_OB_TENANTS;
      ```

      tab Oracle mode

      The query statement in Oracle mode is as follows:

      ```shell
      obclient [SYS]> SELECT TENANT_ID, TENANT_NAME, SWITCHOVER_STATUS FROM SYS.DBA_OB_TENANTS;
      ```

      :::

3. Stop the service.

   Here is an example:

   ```sql
   ALTER SYSTEM STOP SERVICE service_name [TENANT [=] tenant_name];
   ```

   The parameters are described as follows:

   * `service_name`: the name of the service to be stopped.
   * `TENANT [=] tenant_name`: the name of the tenant for which you want to stop the service. This parameter is valid only in the `sys` tenant.

   Here are some examples:

   * Stop a service named `s_hz` for a tenant named `mysql_tenant` in the `sys` tenant.

      ```shell
      obclient [oceanbase]> ALTER SYSTEM STOP SERVICE s_hz TENANT = mysql_tenant;
      ```

   * Stop a service named `s_hz` in a user tenant.

      ```shell
      obclient > ALTER SYSTEM STOP SERVICE s_hz;
      ```

   After the service is stopped, sessions created based on the service name are interrupted, and you cannot create a session based on the service name.

## References

* [Query the service status](200.view-service-status.md)
* [Start a service](300.start-service.md)
* [Delete a service](500.delete-service.md)