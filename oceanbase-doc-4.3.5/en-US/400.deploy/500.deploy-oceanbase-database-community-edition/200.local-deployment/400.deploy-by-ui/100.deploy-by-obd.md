# Deploy an OceanBase cluster through the GUI of obd

This topic describes how to deploy an OceanBase cluster in an x86-based CentOS Linux 7.9 system through the GUI of OceanBase Deployer (obd).

## Terms

* OceanBase Database

  OceanBase Database is an enterprise-level, native distributed database independently developed by the OceanBase team. For more information, see [OceanBase Database documentation](https://en.oceanbase.com/docs/oceanbase-database).

* ODP

  OceanBase Database Proxy (ODP), also known as OBProxy, is a dedicated proxy server for OceanBase Database. For more information, see [ODP documentation](https://en.oceanbase.com/docs/odp-en).

* OCP Express

  OceanBase Cloud Platform (OCP) Express (OCP Express) is a web-based management tool for OceanBase Database V4.x. Integrated with an OceanBase cluster, OCP Express allows you to view key performance metrics of the cluster and perform basic database management operations on the cluster.

* OBAgent

  OceanBase Agent (OBAgent) is a framework for data monitoring and collection in OceanBase Database. It supports both pushing and pulling modes for data collection in different scenarios.

* obconfigserver

  OceanBase Configserver (obconfigserver) provides metadata registration, storage, and query services for OceanBase Database. For more information, see [ob-configserver](https://github.com/oceanbase/oceanbase/tree/master/tools/ob-configserver).

## Prerequisites

Before you begin, make sure that the following conditions are met:

* Your server meets the software and hardware requirements. For more information, see [Software and hardware requirements](../../200.local-deployment/100.requirements-for-software-and-hardware.md).

* In a production environment, you need to perform environment and configuration checks. For specific operations, see [Check resources](../200.environment-and-configuration-checks/100.view-resources-optional.md).

* To deploy OceanBase Database only, make sure that at least 2 vCPUs, 8 GB of memory, and 19 GB of disk space are available.

* To deploy OceanBase Database and all its components, make sure that at least 4 vCPUs, 10 GB of memory, and 25 GB of disk space are available. We recommend that more than 16 GB of memory be available.

* To deploy OceanBase Cloud Platform (OCP) Express, make sure that the Java environment is installed and configured. At present, only Java Development Kit (JDK) 1.8 is supported. For more information, see **How do I configure the Java environment before I deploy OCP Express?** in [FAQ](https://en.oceanbase.com/docs/community-obd-en-10000000000860050).

  <main id="notice" type='notice'>
    <h4>Notice</h4>
    <p>obd remotely performs installation and deployment by using the Secure Shell (SSH) protocol. Therefore, you must use SSH to verify whether the Java environment is available. For more information, see <b>Verify the Java environment</b>. </p>
  </main>

## Prepare the software

You can deploy OceanBase Database through the GUI of obd either online or offline.

* Online deployment: Make sure that the server where obd resides can connect to the Internet. In this deployment mode, obd obtains the installation package from a remote image repository during deployment. Therefore, you do not need to deploy and configure the installation package in advance.

* Offline deployment: The server where obd resides does not need to connect to the Internet during deployment. In this deployment mode, you must upload the installation package to the local image repository of obd in advance. If you choose offline deployment, we recommend that you download the all-in-one package of the desired version.

You can select the appropriate method to prepare the software based on your specific circumstances.

### Online deployment

If you choose online deployment, run the following commands to install obd on the central control server:

```shell
[admin@test001 ~]$ sudo yum install -y yum-utils
[admin@test001 ~]$ sudo yum-config-manager --add-repo https://mirrors.aliyun.com/oceanbase/OceanBase.repo
[admin@test001 ~]$ sudo yum install -y ob-deploy
[admin@test001 ~]$ source /etc/profile.d/obd.sh
```

### Offline deployment

If you choose offline deployment, run the following commands to download and install the all-in-one package.

You can download the latest all-in-one package from [OceanBase Download Center](https://en.oceanbase.com/softwarecenter) and copy it to the central control server.

```shell
[admin@test001 ~]$ tar -xzf oceanbase-all-in-one-*.tar.gz
[admin@test001 ~]$ cd oceanbase-all-in-one/bin/
[admin@test001 bin]$ ./install.sh
[admin@test001 bin]$ source ~/.oceanbase-all-in-one/bin/env.sh
```

## Procedure

 <main id="notice" type='explain'>
  <h4>Note</h4>
  <p>This article provides operational guidance using obd V3.0.0 as an example. The interface may vary with different versions of obd, so please refer to the actual interface. For more information on obd, see <a href="https://en.oceanbase.com/docs/obd-en">obd documentation</a>.</p>
</main>  

### Step 1: Start the GUI

1. Start to the GUI.

   Run the `obd web` command on the CLI to start the GUI, and click the generated URL to go to the GUI.

   ```shell
   [admin@test001 ~]$ obd web
   start OBD WEB in 0.0.0.0:8680
   please open http://10.10.10.1:8680
   ```

   <main id="notice" type='explain'>
     <h4>Note</h4>
     <ul>
     <li>
     <p>The default port in the URL is 8680. You can use the <code>obd web -p &lt;PORT&gt;</code> command to specify a port. </p>
     </li>
     <li>
     <p>On Alibaba Cloud or other cloud environments, the program may fail to obtain a public IP address but return an intranet IP address. You must use a correct public IP address to access the GUI. </p>
     </li>
     <li>
     <p>The <code>obd web</code> command is bound to the IP address <code>0.0.0.0</code>. In a deployment where multiple network interface cards (NICs) are used, you can access the GUI through any accessible IP address. </p>
     </li>
     </ul>
   </main>

2. (Optional) To change the display language, click the **English** icon in the upper-right corner of the page and select a language as needed.

   <img width="677" height="419.5" src="https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.4.0/en-US/200.quick-start/3.deploy-ocp-by-ui-01.png" alt="English">

3. On the GUI, click **<UI-TERM>Try Now</UI-TERM>** to go to the **<UI-TERM>Welcome to the OceanBase Deployment Wizard</UI-TERM>** page. On the page that appears, select **<UI-TERM>OceanBase and supporting tools</UI-TERM>** and click **<UI-TERM>Installation**</UI-TERM> to go to the OceanBase Database deployment page.

### Step 2: Configure the deployment information

On the **<UI-TERM>Deployment Configuration</UI-TERM>** page, you can specify the cluster name, load type, and components to deploy, as shown in the following figure:

![Deployment configuration](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.10.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-02.png)

| Section | Description |
|---------|--------|
| **<UI-TERM>Deployment Configuration</UI-TERM>** | The cluster name is a unique identifier for obd, with a default value of `myoceanbase`. You can customize the name, but it must not conflict with any existing deployments. The cluster name must begin with a letter, end with either a letter or a number, and can only include letters, numbers, and underscores. It must also be between 2 and 32 characters in length. To view the clusters managed by obd, you can use the `obd cluster list` command. |
| **<UI-TERM>Deploy a database</UI-TERM>** | You can select an OceanBase Database version from the **<UI-TERM>Version</UI-TERM>** drop-down list and click **<UI-TERM>Learn more</UI-TERM>** to view its documentation. |
| **<UI-TERM>Load Type</UI-TERM>** | You can select a load type for the OceanBase cluster from the **<UI-TERM>Type</UI-TERM>** drop-down list and view its applicable scenarios in the **<UI-TERM>Description</UI-TERM>** column. |
| **<UI-TERM>Optional components</UI-TERM>** | By default, only ODP is selected. You can deselect the components that you do not want to deploy under **<UI-TERM>Components</UI-TERM>**. You can also click **<UI-TERM>Learn More</UI-TERM>** in the row of a component to view its documentation. <main id="notice" type='explain'><h4>Note</h4><p>OCP Express is selected along with OBAgent automatically. When you deselect OBAgent, OCP Express is automatically deselected. </p></main> |

Click **<UI-TERM>Next Step</UI-TERM>** to go to the **<UI-TERM>Node Configuration</UI-TERM>** page.

### Step 3: Configure the nodes

On the **<UI-TERM>Node Configuration</UI-TERM>** page, you can configure the database and component nodes, and specify the user information and software installation path, as shown in the following figure:

![Node configuration](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.10.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-03.png)

<table>
  <thead>
    <tr>
      <th>Section</th>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tr>
    <td rowspan="3"><UI-TERM>Database Node</UI-TERM></td>
    <td><UI-TERM>Zone Name</UI-TERM></td>
    <td>The name of a zone in OceanBase Database. You can specify a custom zone name. The zone name can contain letters, digits, and underscores (_). It must start with a letter and end with a letter or digit, and must be 2 to 32 characters in length. In an OceanBase cluster that consists of multiple zones, the cluster must have a zone that shares the same region as that of the primary zone. You can click <b><UI-TERM>+ Add Zone</UI-TERM></b> to add a zone or the Delete icon next to a zone to remove the zone. </td>
  </tr>
  <tr>
    <td><UI-TERM>OBServer Node</UI-TERM></td>
    <td>The IP address of an OBServer node in the OceanBase cluster. After you specify the IP address of an OBServer node, you can press Enter to specify the IP address of another OBServer node. <main id="notice" type='notice'><h4>Notice</h4><p>The IP address <code>127.0.0.1</code> cannot be used. </p></main></td>
  </tr>
  <tr>
    <td><UI-TERM>RootService Node</UI-TERM></td>
    <td>You can select an IP address specified in the <b><UI-TERM>OBServer Node</UI-TERM></b> column from the <b><UI-TERM>RootService Node</UI-TERM></b> drop-down list to specify the OBServer node to be used as the RootService node of the OceanBase cluster. In an OceanBase cluster that has multiple replicas, you must specify a RootService node for each zone. </td>
  </tr>
  <tr>
    <td rowspan="3"><UI-TERM>Component Node</UI-TERM></td>
    <td><UI-TERM>OCP Express Node</UI-TERM></td>
    <td>You can select the IP address of an OBServer node from the drop-down list or enter the IP address of a new node. You can select or enter only one IP address. <main id="notice" type='notice'><h4>Notice</h4><p>The IP address <code>127.0.0.1</code> cannot be used. </p></main> </td>
  </tr>
  <tr>
    <td><UI-TERM>OBProxy Node</UI-TERM></td>
    <td>You can configure multiple OBProxy (also known as ODP) nodes. You can select the IP address of an OBServer node or enter the IP address of a new node. After you specify the IP address of an OBProxy node, you can press Enter to specify the IP address of another OBProxy node. <main id="notice" type='notice'><h4>Notice</h4><p>The IP address <code>127.0.0.1</code> cannot be used. </p></main></td>
  </tr>
  <tr>
    <td><UI-TERM>obconfigserver Node</UI-TERM></td>
    <td>You can configure multiple obconfigserver nodes. You can select the IP address of an OBServer node or enter the IP address of a new node. After you specify the IP address of a obconfigserver node, you can press Enter to specify the IP address of another obconfigserver node. If you want to deploy obconfigserver on multiple nodes, configure load balancing in advance and specify the <code>vip_address</code> and <code>vip_port</code> parameters on the GUI. To specify the parameters, go to the <b>Cluster Configuration</b> page and enable <b>More Configurations</b> in the <b>Component Configuration</b> section.<main id="notice" type='notice'><h4>Notice</h4><p>The IP address <code>127.0.0.1</code> cannot be used. </p></main> </td>
  </tr>
  <tr>
    <td rowspan="3"><UI-TERM>User</UI-TERM></td>
    <td><UI-TERM>User Name</UI-TERM></td>
    <td>The username used to deploy the OceanBase cluster. The default value is the name of the user who started the current process. You can specify a custom username. </td>
  </tr>
  <tr>
    <td><UI-TERM>Password</UI-TERM></td>
    <td>The logon password of the user specified by <b>User Name</b>. If password-free access is not configured for the nodes, you must enter the password of the specified user. </td>
  </tr>
  <tr>
    <td><UI-TERM>SSH Port</UI-TERM></td>
    <td>The SSH port number. The default value is <code>22</code>. You can specify a custom port number. </td>
  </tr>
  <tr>
    <td ><UI-TERM>Software Path</UI-TERM></td>
    <td><UI-TERM>Software Path</UI-TERM></td>
    <td>The software path. The default value is the home directory of the user who performed the deployment. You can change the path as needed. After you specify this parameter, the <code>myoceanbase</code> folder is created in the specified directory. </td>
  </tr>
</table>

Click **<UI-TERM>Next Step</UI-TERM>** to go to the **<UI-TERM>Cluster Configuration</UI-TERM>** page.

### Step 4: Configure the cluster

On the **<UI-TERM>Cluster Configuration</UI-TERM>** page, configure related cluster information, including the password of the administrator user in the `sys` tenant (`root@sys`), data directory, log directory, and ports and parameters of OceanBase Database and its components.

1. Cluster configuration

   ![Cluster configuration](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.10.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-04.png)

   | Parameter | Description |
   |-------|-----|
   | <UI-TERM>Mode Configuration</UI-TERM> | Valid values include **<UI-TERM>Maximum Utilization</UI-TERM>** (recommended) and **<UI-TERM>Minimum Availability</UI-TERM>**. The **<UI-TERM>Maximum Utilization</UI-TERM>** mode maximizes resource utilization to ensure cluster performance and stability. In **<UI-TERM>Minimum Availability</UI-TERM>** mode, minimum resources required for the normal running of the cluster are configured. For more information about the two modes, see [Mode configuration rules](https://en.oceanbase.com/docs/community-obd-en-10000000000904952). |
   | <UI-TERM>root@sys Password</UI-TERM> | You can click **<UI-TERM>Randomly generated</UI-TERM>** to generate a random password or enter a custom password. The password must meet the following complexity requirements: <ul><li>It must be 8 to 32 characters in length.</li><li>It must contain characters of at least three of the following types: digits (0 to 9), uppercase letters (A to Z), lowercase letters (a to z), and special characters. Supported special characters are <code>~!@#%^&*_-+=\|(){}[]:;,.?/</code>.</li></ul>You can click **<UI-TERM>copy password</UI-TERM>** to copy the password and save it. |
   | <UI-TERM>Data Directory</UI-TERM> | By default, the data directory is in the software path configured on the **<UI-TERM>Node Configuration</UI-TERM>** page. The data directory must be an absolute path beginning with a forward slash (`/`). You can change the data directory. Make sure that the specified directory is empty.  |
   | <UI-TERM>Log Directory</UI-TERM> | By default, the log directory is in the software path configured on the **<UI-TERM>Node Configuration</UI-TERM>** page. The log directory must be an absolute path beginning with a forward slash (`/`). You can change the log directory. Make sure that the specified directory is empty.  |
   | <UI-TERM>SQL Port</UI-TERM> | The SQL port number. The default value is `2881`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>RPC Port</UI-TERM> | The port number used for the remote access protocol. The default value is `2882`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>More Configurations</UI-TERM> | You can enable **<UI-TERM>More Configurations</UI-TERM>** to view more cluster parameters. You can retain the default settings or modify the settings. <main id="notice" type='explain'><h4>Note</h4><p>After you enable <b>More Configurations</b>, you can configure the <code>scenario</code> parameter to specify a load type for the cluster. The default value of this parameter is <code>htap</code>. </p></main> |

2. Component configuration

   ![Component configuration](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.10.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-05.png)

   | Parameter | Description |
   |--------|--------|
   | <UI-TERM>OCP Express administrator password</UI-TERM> | The logon password of the administrator account of OCP Express. You can click **<UI-TERM>Randomly generated</UI-TERM>** to generate a random password or enter a custom password. The password must meet the following complexity requirements: <ul><li>It must be 8 to 32 characters in length.</li><li>It must contain two characters of each of the following four types: digits (0 to 9), uppercase letters (A to Z), lowercase letters (a to z), and special characters. Supported special characters are <code>~!@#%^&*_-+=`\|(){}[]:;',.?/</code>.</li></ul>You can click **<UI-TERM>copy password</UI-TERM>** to copy the password and save it. |
   | <UI-TERM>Port OBProxy SQL</UI-TERM>  | The listening port of ODP. The default value is `2883`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>OBProxy Exporter Port</UI-TERM> | The exporter port of ODP. It is used for Prometheus to pull monitoring data from ODP. The default value is `2884`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>Port OBProxy RPC</UI-TERM>  | The RPC port of ODP. The default value is `2885`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>OBAgent Monitoring Service Port</UI-TERM> | The monitoring service port of ODP. The default value is `8088`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>OBAgent Management Service Port</UI-TERM> | The management service port of ODP. The default value is `8089`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>OCP Express Port</UI-TERM> | The HTTP port for accessing OCP Express. The default value is `8180`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>obconfigserver Service Port</UI-TERM> | The listening port of obconfigserver. The default value is `8080`. You can specify a custom port number ranging from `1025` to `65535`. Make sure that the specified port is not occupied. |
   | <UI-TERM>More Configurations</UI-TERM> | You can enable **<UI-TERM>More Configurations</UI-TERM>** to view more component parameters. You can retain the default settings or modify the settings. <main id="notice" type='explain'><h4>Note</h4><p>If multiple nodes are configured in the <b>obconfigserver Node</b> section on the <b>Node Configuration</b> page, you must enable <b>More Configurations</b> and specify the <code>vip_address</code> and <code>vip_port</code> parameters. Otherwise, an error occurs during the pre-check. </p></main> |

Click **<UI-TERM key="oms-cloud.Performance.componentsAdd.FileParsingAddOSS.NextStep">Next</UI-TERM>** to go to the **<UI-TERM key="odc.component.CommonTaskDetailModal.TaskFlow.PreCheck">Pre-check</UI-TERM>** page.

### Step 5: Pre-check

On the **<UI-TERM>Pre-check</UI-TERM>** page, confirm all the configuration information. If any information is incorrect, you can click **<UI-TERM>Previous Step</UI-TERM>** to modify the information. After you confirm that all the information is correct, click **<UI-TERM>Pre-check</UI-TERM>**.

If the pre-check reports an error, and the error can be automatically fixed, you can click **<UI-TERM>Automatic Repair</UI-TERM>** to fix the error. You can also click **<UI-TERM>Learn More</UI-TERM>** to fix the reported error by referring to the error code document. After all the errors are fixed, click **<UI-TERM>Re-check</UI-TERM>** to perform a pre-check again.

<img width="1069.6" height="539" src="https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.9.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-05.png" alt="Precheck">

After the pre-check is passed, click **<UI-TERM>Deploy</UI-TERM>** to start the deployment.

### Step 6: Deployment

<img width="1060.5" height="683.2" src="https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.9.0/en-US/200.quick-start/300.use-ui-deploy-oceanbase-06.png" alt="Deploy">

You can perform the following operations:

* After the deployment succeeds, you can copy the displayed connection string and use it to connect to the corresponding component. On the CLI, you can copy the connection string corresponding to OceanBase Database and use it to connect to the OceanBase cluster as the root@sys user, or copy the connection string corresponding to ODP and use it to connect to ODP as the `root@proxysys` user.

* Click the connection string of OCP Express to go to the logon page of OCP Express. Log on with the account username and password provided on the deployment page, and then change the password. Then, you can manage the cluster on the GUI.

  <main id="notice" type='explain'>
    <h4>Note</h4>
    <p>On Alibaba Cloud or other cloud environments, the program may fail to obtain a public IP address but return an intranet IP address. You must use a correct public IP address to access the GUI. </p>
  </main>

* In the **<UI-TERM>Deployment Report</UI-TERM>** section, click the Expand icon before a component to view the deployment log on the GUI. Find the component and click **<UI-TERM>View Details</UI-TERM>**. Then, you can click the Copy icon next to a command to copy the command and run the command on the central control server to view the log location of the component.

* Click **<UI-TERM>Copy Information</UI-TERM>** to save the access address and account information of the OceanBase cluster. Then, click **<UI-TERM>Finish</UI-TERM>** to exit.

<main id="notice" type='notice'>
  <h4>Notice</h4>
  <p>To deploy multiple clusters, click <b>Finish</b> on the GUI to end the current obd process and then run the <code>obd web</code> command to start the deployment of another cluster. </p>
</main>

## Related operations

### Verify the Java environment

obd remotely executes a script to deploy OCP Express. Therefore, you must use SSH to verify the Java environment. You cannot directly run the `java -version` command on the server where OCP Express is deployed to verify the Java environment.

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>Interactions between the client and server initialize the environment variables, but the SSH access mode does not initialize environment variables. As a result, the system prompts that the Java command does not exist or the Java version is invalid when you use SSH. </p>
</main>

You can run the following command on any server that has established a network connection with the node where OCP Express resides.

```shell
# ocp_express_node_username: the username of the node where OCP Express resides
# ocp_express_node_ip: the IP address of the node where OCP Express resides
[admin@test001 ~]$ ssh <ocp_express_node_username>@<ocp_express_node_ip> 'java -version'

# Command output
openjdk version "1.8.0_xxx" 
OpenJDK Runtime Environment (build 1.8.0_362-b08)
OpenJDK 64-Bit Server VM (build 25.362-b08, mixed mode)
```

If the required Java environment has been installed but failed the verification, you can resolve the issue in the following ways:

* Method 1: Specify the **java_bin** parameter in the **More Configurations** section.

  As shown in the following figure, set `java_bin` to the real path of Java, such as `/jdk8/bin/java`.

   <img width="808.8" height="540.6" src="https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/obd/V2.1.0/en-US/2.quick-start/3.use-ui-deploy-oceanbase-07.png" alt="More Settings">

* Method 2: Create a soft link from the executable file of Java to `/usr/bin/java`.

  ```shell
  [admin@test001 bin]$ pwd
  /jdk8/bin
  [admin@test001 bin]$ ln -s /jdk8/bin/java  /usr/bin/java
  ```

### Manage the cluster

You can run the following commands to manage a cluster deployed by using obd. For more information, see [Cluster commands](https://en.oceanbase.com/docs/community-obd-en-10000000000904961).

```shell
# View the cluster list.
[admin@test001 ~]$ obd cluster list

# View the status of the myoceanbase cluster.
[admin@test001 ~]$ obd cluster display myoceanbase

# Stop the myoceanbase cluster in the running state.
[admin@test001 ~]$ obd cluster stop myoceanbase

# Destroy the myoceanbase cluster.
[admin@test001 ~]$ obd cluster destroy myoceanbase
```

### Deploy a component of the desired version

The all-in-one package is iterated based on OceanBase Database versions. If any component in the package has a later version, you can download the component of the latest version from [OceanBase Download Center](https://en.oceanbase.com/softwarecenter) and then upload it to the local image repository of obd. obd automatically obtains the latest version from the local image repository during deployment.

1. Go to the directory where the component installation package is located, run the following command to add it to the local image repository:

   ```shell
   [admin@test001 rpm]$ obd mirror clone *.rpm
   ```

2. View the list of installation packages in the local image repository.

   ```shell
   [admin@test001 rpm]$ obd mirror list local
   ```