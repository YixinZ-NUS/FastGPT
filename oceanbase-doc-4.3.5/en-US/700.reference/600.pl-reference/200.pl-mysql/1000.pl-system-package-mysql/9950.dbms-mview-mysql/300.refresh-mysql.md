| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |
|machine-translation||

# REFRESH

The `REFRESH` procedure refreshes the specified materialized view.

<main id="notice" >
  <h4>Applicability</h4>
  <p>This topic applies only to OceanBase Database Enterprise Edition. OceanBase Database Community Edition provides only MySQL mode. </p>
</main>

## Syntax

```sql
DBMS_MVIEW.REFRESH (
    mv_name             IN    VARCHAR(65535),
    method              IN    VARCHAR(65535) DEFAULT NULL,
    refresh_parallel    IN    INT DEFAULT 0,
    nested              IN    BOOLEAN DEFAULT FALSE,
    nested_refresh_mode IN    VARCHAR DEFAULT NULL
);
```

## Parameters

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>For non-nested materialized views, cascaded refreshes do not exist. Therefore, the <code>nested</code> and <code>nested_refresh_mode</code> parameters are invalid and the default value is independent refreshes. </p>
</main>

| **Parameter** | **Description** |
|--------------|---------------------------------------------------------------------------------------------------------------|
| mv_name | The name of the materialized view to be refreshed.  |
| method | The refresh strategy for the materialized view. You can specify a default strategy when you create a materialized view. Valid values:<ul><li>'f' or 'F': indicates fast refresh. </ul></li> <ul><li>'?': indicates forcible refresh. </ul></li> <ul><li>'C' or 'c': indicates full refresh. </ul></li> <ul><li> 'A' or 'a': indicates full refresh. </ul></li> |
| refresh_parallel | The number of threads that execute the refresh operation at the same time. <main id="notice" type='explain'> <h4>Note</h4> <p>For OceanBase Database V4.3.5, the default value for this parameter is changed to 0 starting from version V4.3.5 BP1.</p> </main> |
| nested | The refresh mode of the nested materialized view. Valid values:<ul><li>`FALSE`: the default value. Indicates independent refreshes of the nested materialized view. </li><li>`TRUE`: indicates cascaded refreshes of the nested materialized view. </li></ul> <main id="notice" type='explain'><h4>Note</h4><p>For OceanBase Database V4.3.5, the <code>nested</code> parameter is supported starting from V4.3.5 BP3.</p></main>|
| nested_refresh_mode | The refresh mode of the cascaded nested materialized view. Valid values:<ul><li>When the `nested` parameter is set to `FALSE`, an error is returned if the `nested_refresh_mode` parameter is specified. </li><li>When the `nested` parameter is set to `TRUE`, the `nested_refresh_mode` parameter can be set to the following values:  <ul><li>`inconsistent`: indicates cascaded inconsistent refreshes. </li><li>`consistent`: indicates cascaded consistent refreshes. </li></ul>  </li><li>When the `nested_refresh_mode` parameter is not specified, cascaded inconsistent refreshes are performed by default. </li></ul>  </li></ul> <main id="notice" type='explain'><h4>Note</h4><p>For OceanBase Database V4.3.5, the <code>nested_refresh_mode</code> parameter is supported starting from V4.3.5 BP3.</p></main>|

## Examples

* Independent refreshes:

  * Specify only the `mv_name` parameter.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1');
    ```

  * Specify the `mv_name` and `nested` parameters and set their values to `false`.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1', nested=> false);
    ```

* Cascaded inconsistent refreshes:

  * Specify the `mv_name`, `nested` parameters, and do not specify the `nested_refresh_mode` parameter.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',   nested=> true);
    ```

  * Specify the `mv_name`, `nested` parameters, and set their values to `true` and `inconsistent`, respectively.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> true,
        nested_refresh_mode => 'inconsistent');
    ```

* Cascaded consistent refreshes:

  Specify the `mv_name`, `nested` parameters, and set their values to `true` and `consistent`, respectively.

  ```sql
  CALL DBMS_MVIEW.REFRESH(
      'mv1',
      nested=> true,
      nested_refresh_mode => 'consistent');
  ```

* Error scenarios:

  * The `nested` parameter is set to `false`, and the `nested_refresh_mode` parameter is specified. An error is returned.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> false,
        nested_refresh_mode => 'xxxx');
    ```

  * The `nested_refresh_mode` parameter is specified, but the `nested` parameter is not specified. An error is returned.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1', nested_refresh_mode => 'xxxx');
    ```

  * The `nested` parameter is set to `true`, and the `nested_refresh_mode` parameter is set to an invalid string. An error is returned.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> true,
        nested_refresh_mode => 'Invalid string');
    ```

## References

For more information about refreshing materialized views, see [Refresh a materialized view](../../../../300.database-object-management/100.manage-object-of-mysql-mode/600.manage-views-of-mysql-mode/200.manage-materialized-views-of-mysql-mode/400.refresh-materialized-views-of-mysql-mode.md).
