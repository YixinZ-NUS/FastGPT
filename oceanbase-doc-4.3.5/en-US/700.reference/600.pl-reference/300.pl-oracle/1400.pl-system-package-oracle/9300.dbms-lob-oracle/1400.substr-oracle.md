|description||
|---|---|
|machine-translation||

# SUBSTR

The `SUBSTR` function returns `amount` bytes or characters from a `LOB` value, starting at the absolute offset of the `LOB` value.

For a fixed-width `CLOB` value of `n` bytes, if the `amount` parameter exceeds 32767/n, the `SUBSTR` function returns a value of length 32767/n or the length of the `CLOB` value, whichever is smaller. `n` is the maximum width in bytes of the `CLOB` value.

  <main id="notice" >
    <h4>Applicability</h4>
    <p>This topic applies only to OceanBase Database Enterprise Edition. OceanBase Database Community Edition provides only MySQL mode. </p>
  </main>

## Syntax

```sql
DBMS_LOB.SUBSTR (
lob_loc     IN    BLOB,
amount      IN    INTEGER := 32767,
offset      IN    INTEGER := 1)
RETURN RAW;

DBMS_LOB.SUBSTR (
lob_loc     IN    CLOB CHARACTER SET ANY_CS,
amount      IN    INTEGER := 32767,
offset      IN    INTEGER := 1)
RETURN VARCHAR2;
```

## Parameters

| **Parameter**  |                                    **Description**                                    |
|---------|------------------------------------------------------------------------------|
| lob_loc | The locator of the `LOB` value to be read. For more information, see [Use DBMS_LOB](../9300.dbms-lob-oracle/100.dbms-lob-overview-oracle.md). |
| amount  | The number of bytes to be read from the `BLOB` value or the number of characters to be read from the `CLOB` value.                                            |
| offset  | The offset, in bytes, from which to start reading the `BLOB` value or the offset, in characters, from which to start reading the `CLOB` value. The default value is 1.                       |

## Return value

| **Return value**  |                                                                                                                                                                 **Description**                                                                                                                                                                 |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| RAW      | The function overload that contains the `BLOB` parameter.                                                                                                                                                                                                                                                                                                                    |
| VARCHAR2 | The `CLOB` version.                                                                                                                                                                                                                                                                                                                             |
| NULL     | The return value is NULL in the following cases: <ul><li> Any input parameter is `NULL`.   </li><li> `amount` is less than 1.   </li><li> `amount` exceeds 32767 bytes (or equivalent characters).   </li><li> `offset` is less than 1.   </li><li> `offset` exceeds `LOBMAXSIZE`. </li></ul>   |

## Considerations

* The `VARCHAR2` buffer must match the format of the `CLOB` parameter. In other words, if the input `LOB` parameter is of type `CLOB`, the buffer must contain `CHAR` data.

* When you call `DBMS_LOB.SUBSTR` from a client, the returned buffer contains data in the client character set. Before returning the buffer to the user, the database converts the `LOB` value from the server character set to the client character set.

* `DBMS_LOB.SUBSTR` returns 8191 or more characters based on the characters stored in the `LOB` value. If not all characters are returned because the number of bytes required for the characters exceeds the available buffer size, you can call `DBMS_LOB.SUBSTR` again with a new offset to read the remaining characters, or call the procedure repeatedly until all data is extracted.

* `SUBSTR` retrieves the `LOB` value before reading it.