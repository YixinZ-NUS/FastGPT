| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |
|machine-translation||

# REFRESH

The `REFRESH` procedure refreshes the specified materialized view.

<main id="notice" >
  <h4>Applicability</h4>
  <p>This topic applies only to OceanBase Database Enterprise Edition. OceanBase Database Community Edition provides only MySQL mode. </p>
</main>

## Syntax

```sql
DBMS_MVIEW.REFRESH (
   { list                 IN     VARCHAR2,
   | tab                  IN     DBMS_UTILITY.UNCL_ARRAY,}
   method                 IN     VARCHAR2       := NULL,
   rollback_seg           IN     VARCHAR2       := NULL,
   push_deferred_rpc      IN     BOOLEAN        := true,
   refresh_after_errors   IN     BOOLEAN        := false,
   purge_option           IN     BINARY_INTEGER := 1,
   parallelism            IN     BINARY_INTEGER := 0,
   heap_size              IN     BINARY_INTEGER := 0,
   atomic_refresh         IN     BOOLEAN        := true,
   nested                 IN     BOOLEAN        := false,
   out_of_place           IN     BOOLEAN        := false,
   skip_ext_data   	      IN     BOOLEAN        := false,
   refresh_parallel       IN     BINARY_INTEGER := 0,
   nested_refresh_mode    IN     VARCHAR2       := NULL
);
```

## Parameters

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>Non-nested materialized views do not support cascading refreshes. The <code>nested</code> and <code>nested_refresh_mode</code> parameters are invalid and will be ignored. By default, they are independently refreshed.</p>
</main>

| **Parameter** | **Description** |
|----------------------|-----------------------------------------------------------------------------------------------------------|
| list | The list of names of materialized views to be refreshed, which are separated with commas (,). You can specify only one materialized view at a time in the current version.  |
| tab | The array of names of materialized views to be refreshed. You can specify only one materialized view at a time in the current version.  |
| method | The refresh strategy for the materialized view. You can specify a default strategy when you create a materialized view. Valid values:<ul><li>'f' or 'F': indicates fast refresh. </ul></li> <ul><li>'?': indicates forcible refresh. </ul></li> <ul><li>'C' or 'c': indicates full refresh. </ul></li> <ul><li> 'A' or 'a': indicates full refresh. </ul></li> |
| rollback_seg | This parameter is reserved only for compatibility with Oracle.  |
| push_deferred_rpc | This parameter is reserved only for compatibility with Oracle.  |
| refresh_after_errors | This parameter is reserved only for compatibility with Oracle.  |
| purge_option | This parameter is reserved only for compatibility with Oracle.  |
| parallelism | This parameter is reserved only for compatibility with Oracle.  |
| heap_size | This parameter is reserved only for compatibility with Oracle.  |
| atomic_refresh | This parameter is reserved only for compatibility with Oracle.  |
| nested | The refresh mode of the nested materialized view. Valid values: <ul><li>`FALSE`: the default value, indicating to refresh the nested materialized view independently.</li><li>`TRUE`: indicating to refresh the nested materialized view in cascade.</li></ul> <main id="notice" type='explain'><h4>Note</h4><p>For OceanBase Database V4.3.5, this parameter takes effect starting from V4.3.5 BP3.</p></main>|
| out_of_place | This parameter is reserved only for compatibility with Oracle.  |
| skip_ext_data | This parameter is reserved only for compatibility with Oracle.  |
| refresh_parallel | The number of threads that execute the refresh operation at the same time. <main id="notice" type='explain'> <h4>Note</h4> <p>For OceanBase Database V4.3.5, the default value for this parameter is changed to 0 starting from version V4.3.5 BP1.</p> </main> |
| nested_refresh_mode | Specifies whether to perform consistent refreshes or inconsistent refreshes for a nested materialized view in cascade. Valid values: <ul><li>If the `nested` parameter is set to `FALSE`, specifying this parameter will result in an error.</li><li>If the `nested` parameter is set to `TRUE`, specify this parameter with one of the following values:  <ul><li>`inconsistent`: specifies to perform inconsistent refreshes in cascade.</li><li>`consistent`: specifies to perform consistent refreshes in cascade.</li></ul>  </li><li>If this parameter is not specified, cascade inconsistent refreshes will be used by default.</li></ul>  </li></ul> <main id="notice" type='explain'><h4>Note</h4><p>For OceanBase Database V4.3.5, this parameter takes effect starting from V4.3.5 BP3.</p></main>|

## Examples

* Independent refresh mode:

  * Only specify the `mv_name` parameter.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1');
    ```

  * Specify the `mv_name` parameter and set the `nested` parameter to `false`.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1', nested=> false);
    ```

* Inconsistent cascade refresh mode:

  * Specify the `mv_name`, `nested` parameters, and do not specify the `nested_refresh_mode` parameter.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',   nested=> true);
    ```

  * Specify the `mv_name`, `nested` parameters, and set the `nested_refresh_mode` parameter to `inconsistent`.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> true,
        nested_refresh_mode => 'inconsistent');
    ```

* Consistent cascade refresh mode:

  Specify the `mv_name`, `nested`, and `nested_refresh_mode` parameters.

  ```sql
  CALL DBMS_MVIEW.REFRESH(
      'mv1',
      nested=> true,
      nested_refresh_mode => 'consistent');
  ```

* Error scenarios:

  * The `nested` parameter is set to `false`, and the `nested_refresh_mode` parameter is also specified. An error occurs.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> false,
        nested_refresh_mode => 'xxxx');
    ```

  * The `nested_refresh_mode` parameter is specified, but the `nested` parameter is not specified. An error occurs.

    ```sql
    CALL DBMS_MVIEW.REFRESH('mv1', nested_refresh_mode => 'xxxx');
    ```

  * The `nested` parameter is set to `true`, and the `nested_refresh_mode` parameter is set to an invalid string. An error occurs.

    ```sql
    CALL DBMS_MVIEW.REFRESH(
        'mv1',
        nested=> true,
        nested_refresh_mode => 'Invalid string');
    ```

## References

For more information about refreshing a materialized view, see [Refresh a materialized view](../../../../300.database-object-management/200.manage-object-of-oracle-mode/500.manage-views-of-oracle-mode/200.manage-materialized-views-of-oracle-mode/400.refresh-materialized-views-of-oracle-mode.md).
