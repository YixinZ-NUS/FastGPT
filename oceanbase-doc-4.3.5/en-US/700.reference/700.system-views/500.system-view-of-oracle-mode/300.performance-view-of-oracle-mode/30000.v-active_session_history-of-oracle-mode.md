|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|
|machine-translation||

# V$ACTIVE_SESSION_HISTORY

<main id="notice" type='explain'>
  <h4>Note</h4>
    <ul><li>For V4.3.x, the view was renamed to <a href="31200.v-ob_active_session_history-of-oracle-mode.md">V$OB_ACTIVE_SESSION_HISTORY</a> since V4.3.5. For V4.2.x, the view was renamed to <a href="31200.v-ob_active_session_history-of-oracle-mode.md">V$OB_ACTIVE_SESSION_HISTORY</a> since V4.2.2.</li>
  <li>This view is introduced in V4.0.0.</li></ul>
</main>

## Purpose

The `V$ACTIVE_SESSION_HISTORY` view displays the active session history of the current OBServer node in the tenant.

## Columns

| Column | Type | Nullable? | Description |
| --- | --- | --- | --- |
| SVR_IP | VARCHAR2(46) | NO | The IP address of the server to which the sample belongs. |
| SVR_PORT | NUMBER | NO | The port number of the server to which the sample belongs. |
| SAMPLE_ID | NUMBER | NO | The unique identifier of the sample on the local server. |
| SAMPLE_TIME | TIMESTAMP(6) | NO | The sampling time. |
| CON_ID | NUMBER | NO | The tenant ID. |
| USER_ID | NUMBER | NO | The user ID of the sampled session. |
| SESSION_ID | bigint(20) | NO | ID of the sampled session.<br>For V4.3.x:<ul><li>For versions earlier than V4.3.5 BP2:<br>In both direct connection mode and ODP mode, this field indicates the server session ID.</li><li>V4.3.5 BP2 and later:<ul><li>In direct connection mode:<br>This field indicates the server session ID. </li> <li>In ODP mode:<ul><li>If <code>client_session_id_version = 2</code> is configured in ODP, this field indicates the Client Session ID. </li> <li>If <code>client_session_id_version = 1</code>, this field indicates the server session ID.</li></ul></li></ul></li></ul> |
| SESSION_TYPE | VARCHAR2(10) | NO | Session type. <li>FOREGROUND: A foreground session, which is a user session. <li>(Not supported) BACKGROUND: A background session. |
| SESSION_STATE | VARCHAR2(7) | NO | Session status. <li>ON CPU: No wait, SQL logic is being executed. <li>WAITING: Waiting. For more information, see the `EVENT` field. |
| SQL_ID | VARCHAR2(32) | NO | The SQL ID. |
| PLAN_ID | NUMBER | NO | The plan ID of the sampled SQL statement in the plan cache. This field associates sampling points with plans. |
| TRACE_ID | VARCHAR2(64) | NO | The trace ID of the operator. |
| EVENT | VARCHAR2(64) | NO | The description of the waiting event. |
| EVENT_NO | NUMBER | NO | The internal number of the waiting event, which is used for queries in conjunction with other tables. |
| EVENT_ID | NUMBER | NO | The ID of the current waiting event. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| P1TEXT | VARCHAR2(64) | NO | The name of parameter 1 of the waiting event. The name varies with the value of the `EVENT` field. |
| P1 | NUMBER | NO | The value of parameter 1 of the waiting event. |
| P2TEXT | VARCHAR2(64) | NO | The name of parameter 2 of the waiting event. The name varies with the value of the `EVENT` field. |
| P2 | NUMBER | NO | The value of parameter 2 of the waiting event. |
| P3TEXT | VARCHAR2(64) | NO | The name of parameter 3 of the waiting event. The name varies with the value of the `EVENT` field. |
| P3 | NUMBER | NO | The value of parameter 3 of the waiting event. |
| WAIT_CLASS | VARCHAR2(64) | NO | The type of the waiting event. |
| WAIT_CLASS_ID | NUMBER | NO | The ID of the type of the waiting event, which is used for queries in conjunction with other tables. |
| TIME_WAITED | NUMBER | NO | The total waiting time of the waiting event, in microseconds (us). |
| SQL_PLAN_LINE_ID | NUMBER | NO | The number of the SQL operator in the SQL plan at the sampling time. |
| GROUP_ID | NUMBER | NO | The ID of the resource group to which the sample belongs. |
| PLAN_HASH | NUMBER | NO | The plan hash value of the current SQL command. |
| THREAD_ID | NUMBER | NO | The ID of the thread in which the current active session is located. |
| STMT_TYPE | NUMBER | NO | The SQL type of the current active session. |
| TIME_MODEL | NUMBER | NO | The time model information, which is a collection of IN_XXX field values (such as IN_PARSE and IN_PL_PARSE). |
| IN_PARSE | VARCHAR2(1) | NO | Indicates whether the current active session is being parsed at the sampling time. |
| IN_PL_PARSE | VARCHAR2(1) | NO | Indicates whether the current active session is being parsed at the sampling time. |
| IN_PLAN_CACHE | VARCHAR2(1) | NO | Indicates whether the current active session is being matched in the plan cache at the sampling time. |
| IN_SQL_OPTIMIZE | VARCHAR2(1) | NO | Indicates whether the current active session is being optimized at the sampling time. |
| IN_SQL_EXECUTION | VARCHAR2(1) | NO | Indicates whether the current active session is being executed at the sampling time. |
| IN_PX_EXECUTION | VARCHAR2(1) | NO | Indicates whether the current active session is being executed in parallel at the sampling time. If the session is in this state, it is also in the IN_SQL_EXECUTION state. |
| IN_SEQUENCE_LOAD | VARCHAR2(1) | NO | Indicates whether the current active session is being used to obtain values from auto-increment columns or sequences at the sampling time. |
| IN_COMMITTING | VARCHAR2(1) | NO | Indicates whether the current sampling point is in the transaction commit phase. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| IN_STORAGE_READ | VARCHAR2(1) | NO | Indicates whether the current sampling point is in the storage read phase. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| IN_STORAGE_WRITE | VARCHAR2(1) | NO | Indicates whether the current sampling point is in the storage write phase. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| IN_REMOTE_DAS_EXECUTION | VARCHAR2(1) | NO | Indicates whether the current sampling point is in the DAS remote execution phase. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| MODULE | VARCHAR2(64) | NO | The value of the MODULE column recorded at the sampling time for the current active session. The value is set by using the `DBMS_APPLICATION_INFO.SET_MODULE` package. |
| ACTION | VARCHAR2(64) | NO | The value of the ACTION column recorded at the sampling time for the current active session. The value is set by using the `DBMS_APPLICATION_INFO.SET_ACTION` package. |
| CLIENT_ID | VARCHAR2(64) | NO | The value of the CLIENT_ID column recorded at the sampling time for the current active session. The value is set by using the `DBMS_SESSION.set_identifier` package. |
| BACKTRACE | VARCHAR2(512) | NO | The auxiliary debugging field that records the code call stack at the time of the event. The value of this field is always NULL. |
| TM_DELTA_TIME | NUMBER | NO | The time interval for calculating the time model, in microseconds. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| TM_DELTA_CPU_TIME | NUMBER | NO | The amount of time spent in CPU in the past `TM_DELTA_TIME` period. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| TM_DELTA_DB_TIME | NUMBER | NO | The amount of time spent in database calls in the past `TM_DELTA_TIME` period. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| TOP_LEVEL_SQL_ID | CHAR(32) | NO | The ID of the top-level SQL statement. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| IN_PLSQL_COMPILATION | VARCHAR2(1) | NO | The current PL compilation status: Y/N. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| IN_PLSQL_EXECUTION | VARCHAR2(1) | NO | The current PL execution status: Y/N. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_ENTRY_OBJECT_ID | NUMBER | NO | The object ID of the top-level PL. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_ENTRY_SUBPROGRAM_ID | NUMBER | NO | The subprogram ID of the top-level PL. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_ENTRY_SUBPROGRAM_NAME | VARCHAR2(32) | NO | The name of the top-level PL subprogram. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_OBJECT_ID | NUMBER | NO | The object ID of the PL being executed. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_SUBPROGRAM_ID | NUMBER | NO | The subprogram ID of the PL being executed. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| PLSQL_SUBPROGRAM_NAME | VARCHAR2(32) | NO | The name of the PL subprogram being executed. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.2. </li></ul></main> |
| TX_ID | NUMBER | NO | The ID of the current transaction. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.3. </li></ul></main> |
| BLOCKING_SESSION_ID | NUMBER | NO | The ID of the session that blocks the current session. This field takes effect only in lock conflict scenarios. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.3. </li></ul></main> |
| TABLET_ID | NUMBER | NO | The ID of the tablet on which the current SQL statement is being processed. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.5. </li></ul></main> |
| PROXY_SID | NUMBER | NO | The proxy session ID. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5. <li> For V4.2.x, this field was introduced in V4.2.5. </li></ul></main> |
| DELTA_READ_IO_REQUESTS | NUMBER(38) | NO | The number of read I/O requests between two samplings. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5 BP2. <li> For V4.2.x, this field was introduced in V4.2.5 BP3. </li></ul></main> |
| DELTA_READ_IO_BYTES | NUMBER(38) | NO | The total size of files read between two samplings. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5 BP2. <li> For V4.2.x, this field was introduced in V4.2.5 BP3. </li></ul></main> |
| DELTA_WRITE_IO_REQUESTS | NUMBER(38) | NO | The number of write I/O requests between two samplings. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5 BP2. <li> For V4.2.x, this field was introduced in V4.2.5 BP3. </li></ul></main> |
| DELTA_WRITE_IO_BYTES | NUMBER(38) | NO | The total size of files written between two samplings. <main id="notice" type='explain'><h4>Note</h4><ul><li> For V4.3.x, this field was introduced in V4.3.5 BP2. <li> For V4.2.x, this field was introduced in V4.2.5 BP3. </li></ul></main>

## Sample query

Example 1: Query the active session history of the current OBServer node in the current tenant.

```shell
obclient [SYS]> SELECT * FROM SYS.V$ACTIVE_SESSION_HISTORY WHERE ROWNUM <= 1\G
```

Example 2: Query the active session history of the current OBServer node in the current tenant.

```shell
*************************** 1. row ***************************
                     SVR_IP: xx.xx.xx.xx
                   SVR_PORT: 2882
                  SAMPLE_ID: 1164438
                SAMPLE_TIME: 28-APR-25 05.24.08.684204 PM
                     CON_ID: 1004
                    USER_ID: 200001
                 SESSION_ID: 2305843009213714805
               SESSION_TYPE: BACKGROUND
              SESSION_STATE: WAITING
                     SQL_ID: NULL
                    PLAN_ID: 0
                   TRACE_ID: YB42AC1E87E9-XXXXXXXXXXXXXXXXXX-0-0
                      EVENT: latch: config lock wait
                   EVENT_NO: 132
                   EVENT_ID: 40
                     P1TEXT: address
                         P1: 140013133706048
                     P2TEXT: number
                         P2: 1073791886
                     P3TEXT: tries
                         P3: 0
                 WAIT_CLASS: CONCURRENCY
              WAIT_CLASS_ID: 104
                TIME_WAITED: 18808
           SQL_PLAN_LINE_ID: NULL
                   GROUP_ID: 0
                  PLAN_HASH: NULL
                  THREAD_ID: 51113
                  STMT_TYPE: NULL
                 TIME_MODEL: 0
                   IN_PARSE: N
                IN_PL_PARSE: N
              IN_PLAN_CACHE: N
            IN_SQL_OPTIMIZE: N
           IN_SQL_EXECUTION: N
            IN_PX_EXECUTION: N
           IN_SEQUENCE_LOAD: N
              IN_COMMITTING: N
            IN_STORAGE_READ: N
           IN_STORAGE_WRITE: N
    IN_REMOTE_DAS_EXECUTION: N
             IN_FILTER_ROWS: N
              IN_RPC_ENCODE: N
              IN_RPC_DECODE: N
          IN_CONNECTION_MGR: N
                    PROGRAM: T1004_TimerWK
                     MODULE: TimerWK
                     ACTION: NULL
                  CLIENT_ID: NULL
                  BACKTRACE: NULL
              TM_DELTA_TIME: 74264957
          TM_DELTA_CPU_TIME: 285828
           TM_DELTA_DB_TIME: 2398159
           TOP_LEVEL_SQL_ID: NULL
       IN_PLSQL_COMPILATION: N
         IN_PLSQL_EXECUTION: N
      PLSQL_ENTRY_OBJECT_ID: NULL
  PLSQL_ENTRY_SUBPROGRAM_ID: NULL
PLSQL_ENTRY_SUBPROGRAM_NAME: NULL
            PLSQL_OBJECT_ID: NULL
        PLSQL_SUBPROGRAM_ID: NULL
      PLSQL_SUBPROGRAM_NAME: NULL
                      TX_ID: NULL
        BLOCKING_SESSION_ID: NULL
                  TABLET_ID: NULL
                  PROXY_SID: 2305843009213714805
     DELTA_READ_IO_REQUESTS: 0
        DELTA_READ_IO_BYTES: 0
    DELTA_WRITE_IO_REQUESTS: 0
       DELTA_WRITE_IO_BYTES: 0
```

## References

After you obtain the ASH, you can generate an ASH report as needed for analysis. For more information about ASH, see [ASH report](../../../../700.reference/1000.performance-tuning-guide/400.performance-diagnosis/500.ash-report-diagnosis/100.ash-introduction.md).