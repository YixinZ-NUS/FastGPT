|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# V$OB_PROCESSLIST

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>This view is introduced since OceanBase Database V4.0.0. </p>
</main>

## Purpose

The `V$OB_PROCESSLIST` view displays session information on this OBServer node.

## Columns

| Column       |  Type  | Nullable? | Description |
|----------------|-----------|----------|-------------|
| SVR_IP         | varchar(46)         | NO         | The IP address of the server.                                                    |
| SVR_PORT       | bigint(20)          | NO         | The port of the server.                                                       |
| SQL_PORT       | bigint(20)          | NO         | The port for SQL statements.                                                      |
| ID             | bigint(20) unsigned | NO         | The session ID.                                                        |
| USER           | varchar(32)         | NO         | The username.                                                          |
| HOST           | varchar(128)        | NO         | The host name of the client. (For connections through obproxy, this column displays the host address of obproxy.)                |
| DB             | varchar(128)        | NO         | The name of the database being accessed.                                              |
| TENANT         | varchar(128)        | NO         | The name of the tenant being accessed.                                                      |
| COMMAND        | varchar(4096)       | NO         | The type of the current command.                                                    |
| TIME           | bigint(20)          | NO         | The execution time of the current command in seconds. If the command is retried, the value is reset to 0.                              |
| TOTAL_TIME     | bigint(20)          | NO         | The total execution time of the current command in seconds. If the command is retried, the value is not reset.                                 |
| STATE          | varchar(128)        | NO         | The current session status.                                                       |
| INFO           | varchar(262143)     | NO         | The current command being executed.                                                  |
| PROXY_SESSID   | bigint(20) unsigned | NO         | The proxy session ID if the client is obproxy.                         |
| MASTER_SESSID  | bigint(20) unsigned | NO         | The master session ID, which is used to chain multiple subsessions of the same SQL statement.                        |
| USER_CLIENT_IP | varchar(46)         | NO         | The IP address of the user client.                                                     |
| USER_HOST      | varchar(128)        | NO         | The host name of the user client.                                                     |
| RETRY_CNT      | bigint(20)          | NO         | The number of retries of the current command.                                                    |
| RETRY_INFO     | bigint(20)          | NO         | The retry information of the current command, which is generally the error code of the last retry.                                      |
| SQL_ID         | varchar(32)         | NO         | The SQL ID.                                                    |
| TRANS_ID       | bigint(20) unsigned | NO         | The transaction ID.                                                        |
| THREAD_ID      | bigint(20) unsigned | NO         | The thread ID.                                                        |
| SSL_CIPHER     | varchar(4096)       | NO         | The name of the encryption cipher.                                                       |
| TRACE_ID       | varchar(64)         | NO         | The trace ID.                                                     |
| TRANS_STATE    | varchar(32)         | NO         | The transaction state. <ul><li>`IDLE`: The transaction is idle, indicating that the transaction has not started. </li> <li>`ACTIVE`: The transaction is explicitly started. It is started by using the `START TRANSACTION` or `BEGIN` statement. </li> <li>`IMPLICIT_ACTIVE`: The transaction is implicitly started. It is started in the `autocommit = on` mode after a DML statement that modifies data is executed. </li> <li>`ROLLBACK_SAVEPOINT`: The transaction is rolled back to a savepoint. </li> <li>`IN_TERMINATE`: The transaction is being terminated, which can be caused by internal reasons or user-initiated termination (for example, the `COMMIT` or `ROLLBACK` statement). </li> <li>`ABORTED`: The transaction is terminated due to an exception. </li> <li>`ROLLED_BACK`: The transaction has been rolled back. </li> <li>`COMMIT_TIMEOUT`: The transaction commit has timed out. </li> <li>`COMMIT_UNKNOWN`: The commit result of the transaction is unknown. </li> <li>`COMMITTED`: The transaction has been successfully committed. </li></ul>                                                         |
| ACTION         | varchar(4096)       | NO         | The name of the current operation set by calling the DBMS_APPLICATION_INFO.SET_ACTION procedure. |
| MODULE         | varchar(4096)       | NO         | The name of the current operation set by calling the DBMS_APPLICATION_INFO.SET_MODULE procedure. |
| CLIENT_INFO    | varchar(4096)       | NO         | The information set by calling the DBMS_APPLICATION_INFO.SET_CLIENT_INFO procedure.              |
| LEVEL          | bigint(20)          | NO         | The full-link trace monitoring level of the session. For example, 1 indicates level 1 diagnostic information. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| SAMPLE_PERCENTAGE | bigint(20)       | NO         | The full-link trace sampling frequency of the session. For example, 50 indicates that diagnostic information is sampled at a 50% frequency. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| RECORD_POLICY     | varchar(32)      | NO         | The full-link trace recording strategy of the session. It supports the following three strategies:<ul><li>ALL: Trace points that are traced when sampling is enabled are printed to the log file. The log file is updated when a span ends. </li><li>ONLY_SLOW_QUERY: Only request traces that are traced when sampling is enabled and identified as slow queries are printed to the log file. Other traces are discarded. For this printing strategy, the trace logs are printed to the log file after a request is identified as a slow query. In the obproxy mode, for root spans, which are transaction-level spans, the root spans are printed to the log file when a slow query is detected. </li><li>SAMPLE_AND_SLOW_QUERY: All traces that are traced when sampling is enabled and meet the following conditions are printed to the log file:<ol><li>When the probability of sampling is 1/1000 and the sampling result is selected, the trace is printed to the log file. </li><li>The trace meets the conditions for printing in the ONLY_SLOW_QUERY mode. </li></ol>For this mode, the log is not updated when a span ends. If condition 1 is met, the trace is marked as a forced print trace and the information is passed to the subsequent link component. If condition 2 is met, the log is updated based on the ONLY_SLOW_QUERY mode. </li></ul><main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VID            | bigint(20)       | NO         | If you directly connect to the database through load balancing in a public cloud environment, this column displays the VPC ID of the load balancing service. Otherwise, it displays NULL. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VIP            | varchar(46)      | NO         | If you directly connect to the database through load balancing in a public cloud environment, this column displays the IP address of the client connecting to the load balancing service. Otherwise, it displays NULL. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VPORT          | bigint(20)       | NO         | If you directly connect to the database through load balancing in a public cloud environment, this column displays the port of the client connecting to the load balancing service. Otherwise, it displays NULL. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| IN_BYTES          | bigint(20)       | NO         | The incoming traffic of the session in bytes. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| OUT_BYTES         | bigint(20)       | NO         | The outgoing traffic of the session in bytes. <main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| USER_CLIENT_PORT  | bigint(20)          | NO   |   The client address information. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.0. </li> <li>In V4.2.x, this field was introduced in V4.2.3. </li></ul></main>  |
| PROXY_USER        | varchar(128)        | NO  |<ul><li>The name of the proxy user if you log in as a proxy user. </li><li>NULL if you log in as a non-proxy user. </li></ul><main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.2. </li><li>In V4.2.x, this field was introduced in V4.2.3. </li></ul></main> |
| SERVICE_NAME     | varchar(64)       | YES         | The name of the service that created the session. The value is `NULL` if the session was not created by a service name. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.1. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP9. For other V4.2.x versions, this field was introduced in V4.2.4. </li></ul></main> |
| TOTAL_CPU_TIME   | bigint(21)        | NO          | The CPU usage time of the current command in seconds. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.1. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP5. </li></ul></main> |
| TOP_INFO         | varchar(262143)   | YES         | The information of the top-level PL statement where the executing SQL statement is located. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.3. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP9. </li></ul></main> |
| MEMORY_USAGE     | bigint(20)        | NO          | The memory occupied by a single SQL statement, in bytes.   <main id="notice" type='explain'><h4>Note</h4><p>For V4.3.5, this field was introduced in V4.3.5 BP2. </p></main>  |
|TOP_TIME|double|NO|The top_time column in the PL scenario indicates the entire PL execution time. <main id="notice" type='explain'><h4>Note</h4><p>In V4.3.x, this field was introduced in V4.3.5 BP5. </p></main>|
|TOP_TRACE_ID|varchar(64)|YES|The traceid of the top-level statement. <main id="notice" type='explain'><h4>Note</h4><p>In V4.3.x, this field was introduced in V4.3.5 BP5. </p></main>|

## Sample queries

Query the session information of this OBServer node.

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.V$OB_PROCESSLIST LIMIT 1\G
```

The query result is as follows:

```shell
*************************** 1. row ***************************
*************************** 1. row ***************************
           SVR_IP: 172.xx.xxx.xxx
         SVR_PORT: 2882
         SQL_PORT: 2881
               ID: 3221735835
             USER: root
             HOST: 100.xx.xxx.xxx:28135
               DB: demo
           TENANT: mysql001
          COMMAND: Query
             TIME: 120.800875
       TOTAL_TIME: 0.000136
            STATE: ACTIVE
             INFO: INSERT INTO orders (
            user_id,
            product_name,
            order_amount,
            order_date,
            order_status
        ) VALUES (
            FLOOR(RAND() * 10000),
            CONCAT('Product ', FLOOR(RAND() * 1000)),
            ROUND(RAND() * 1000, 2),
            DATE_SUB(NOW(), INTERVAL FLOOR(RAND() * 1500) DAY),
            ELT(FLOOR(RAND() * 3 + 1), 'pending', 'completed', 'cancelled')
        )
     PROXY_SESSID: NULL
    MASTER_SESSID: NULL
   USER_CLIENT_IP: 100.xx.xxx.xxx
        USER_HOST: %
        RETRY_CNT: 0
       RETRY_INFO: 0
           SQL_ID: A2572E6AF77AEF27E893F08559A9FA67
         TRANS_ID: 1463901
        THREAD_ID: 2443
       SSL_CIPHER: NULL
         TRACE_ID: YB4***************************************-0-0
      TRANS_STATE: IN_TERMINATE
           ACTION:
           MODULE:
      CLIENT_INFO:
            LEVEL: 1
SAMPLE_PERCENTAGE: 50
    RECORD_POLICY: ALL
           LB_VID: NULL
           LB_VIP: NULL
         LB_VPORT: NULL
         IN_BYTES: 447
        OUT_BYTES: 0
 USER_CLIENT_PORT: 28135
       PROXY_USER:
     SERVICE_NAME: NULL
   TOTAL_CPU_TIME: 121
         TOP_INFO: CALL generate_test_orders()
     MEMORY_USAGE: NULL
1 row in set
```

## References

* [GV$OB_PROCESSLIST](2500.gv-ob_processlist-of-sys-tenant.md)
* [Methods](../../../../600.manage/900.daily-inspection/900.full-link-detection/300.full-link-diagnosis.md)