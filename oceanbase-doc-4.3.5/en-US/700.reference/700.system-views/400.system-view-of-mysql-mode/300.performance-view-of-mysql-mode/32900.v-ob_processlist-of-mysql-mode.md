|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# V$OB_PROCESSLIST

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>This view is introduced since OceanBase Database V4.0.0. </p>
</main>

## Purpose

The `V$OB_PROCESSLIST` view displays session information on the current OBServer node.

## Columns

|      Column      |         Type          | Nullable? | Description |
|----------------|---------------------|------------|--------------------------------------------------------------|
| SVR_IP         | varchar(46)         | NO         | The IP address of the server.                                                    |
| SVR_PORT       | bigint(20)          | NO         | The port of the server.                                                       |
| SQL_PORT       | bigint(20)          | NO         | The port for SQL statements.                                                      |
| ID             | bigint(20) unsigned | NO         | The session ID.                                                        |
| USER           | varchar(32)         | NO         | The username.                                                          |
| HOST           | varchar(128)        | NO         | The host name of the client. (For example, the host name of the obproxy server when you connect to the database through obproxy.)                |
| DB             | varchar(128)        | NO         | The name of the database being accessed.                                              |
| TENANT         | varchar(128)        | NO         | The name of the tenant being accessed.                                                      |
| COMMAND        | varchar(4096)       | NO         | The type of the current command.                                                    |
| TIME           | bigint(20)          | NO         | The execution time of the current command in seconds. If the command is retried, the value is reset to 0.                              |
| TOTAL_TIME     | bigint(20)          | NO         | The total execution time of the current command in seconds. If the command is retried, the value is not reset.                                 |
| STATE          | varchar(128)        | NO         | The current session status.                                                       |
| INFO           | varchar(262143)     | NO         | The current command being executed.                                                  |
| PROXY_SESSID   | bigint(20) unsigned | NO         | The proxy session ID if the client is obproxy.                         |
| MASTER_SESSID  | bigint(20) unsigned | NO         | The ID of the master session, which is used to chain multiple sub-sessions of the same SQL statement.                        |
| USER_CLIENT_IP | varchar(46)         | NO         | The IP address of the user client.                                                     |
| USER_HOST      | varchar(128)        | NO         | The host name of the user client.                                                     |
| RETRY_CNT      | bigint(20)          | NO         | The number of retries for the current command.                                                    |
| RETRY_INFO     | bigint(20)          | NO         | The retry information of the current command, which is generally the error code of the last retry.                                      |
| SQL_ID         | varchar(32)         | NO         | The SQL ID.                                                    |
| TRANS_ID       | bigint(20) unsigned | NO         | The transaction ID.                                                        |
| THREAD_ID      | bigint(20) unsigned | NO         | The thread ID.                                                        |
| SSL_CIPHER     | varchar(4096)       | NO         | The name of the encryption cipher.                                                       |
| TRACE_ID       | varchar(64)         | NO         | The trace ID.                                                     |
| TRANS_STATE    | varchar(32)         | NO         | The transaction status.<ul><li>`IDLE`: the transaction is idle, indicating that the transaction has not started. </li> <li>`ACTIVE`: the transaction is explicitly started. The `START TRANSACTION` or `BEGIN` statement is used to explicitly start the transaction. </li> <li>`IMPLICIT_ACTIVE`: the transaction is implicitly started in the `autocommit = on` mode. After a DML statement that modifies data is executed, the transaction is started. </li> <li>`ROLLBACK_SAVEPOINT`: the transaction is being rolled back to a savepoint. </li> <li>`IN_TERMINATE`: the transaction is being terminated, which can be caused by internal reasons or user-initiated termination (for example, the `COMMIT` or `ROLLBACK` statement). </li> <li>`ABORTED`: the transaction is terminated due to an exception. </li> <li>`ROLLED_BACK`: the transaction is rolled back. </li> <li>`COMMIT_TIMEOUT`: the transaction is committed after the timeout period. </li> <li>`COMMIT_UNKNOWN`: the result of the transaction commit is unknown. </li> <li>`COMMITTED`: the transaction is successfully committed. </li></ul>                                                         |
| ACTION         | varchar(4096)       | NO         | The name of the current operation set by calling the DBMS_APPLICATION_INFO.SET_ACTION procedure. |
| MODULE         | varchar(4096)       | NO         | The name of the current operation set by calling the DBMS_APPLICATION_INFO.SET_MODULE procedure. |
| CLIENT_INFO    | varchar(4096)       | NO         | The information set by calling the DBMS_APPLICATION_INFO.SET_CLIENT_INFO procedure.              |
| LEVEL          | bigint(20)          | NO         | The full-link tracing monitoring level of the session. For example, 1 indicates level 1 diagnostic information.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| SAMPLE_PERCENTAGE | bigint(20)       | NO         | The full-link tracing sampling frequency of the session. For example, 50 indicates that diagnostic information is sampled at a 50% frequency.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| RECORD_POLICY     | varchar(32)      | NO         | The full-link tracing recording strategy of the session. The following three strategies are supported:<ul><li>ALL: all trace points of traces opened by sampling are printed to the log file, and each trace point is printed to the log file when the span ends. </li><li>ONLY_SLOW_QUERY: only request traces of slow queries are printed to the log file, and the rest are discarded. For this printing strategy, the trace log is printed after the request is determined to be a slow query. In the proxy, for the root span, which is the transaction-level span, the root span is printed when a slow query is detected. </li><li>SAMPLE_AND_SLOW_QUERY: all trace points of traces opened by sampling are printed to the log file if they meet either of the following conditions:<ol><li>When the <code>_print_sample_ppm</code> hidden parameter is used for 1% sampling, the trace point is printed to the log file only if the sampling result is selected. </li><li>The condition for printing the trace log in the ONLY_SLOW_QUERY mode is met. </li></ol>Under this mode, the trace log is not printed when the span ends. If the condition 1 is met, the trace log is marked as a forced print log, and the information is passed to the next link component. If the condition 2 is met, the trace log is printed at the same time as in the ONLY_SLOW_QUERY mode. </li></ul><main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VID            | bigint(20)       | NO         | The VPC ID of the load balancer if you directly connect to the database through the load balancer in a public cloud environment. Otherwise, this field is NULL.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VIP            | varchar(46)      | NO         | The IP address of the client when you directly connect to the load balancer in a public cloud environment. Otherwise, this field is NULL.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| LB_VPORT          | bigint(20)       | NO         | The port of the client when you directly connect to the load balancer in a public cloud environment. Otherwise, this field is NULL.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| IN_BYTES          | bigint(20)       | NO         | The incoming traffic of the session in bytes.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| OUT_BYTES         | bigint(20)       | NO         | The outgoing traffic of the session in bytes.<main id="notice" type='explain'><h4>Note</h4><p>This field was introduced in V4.2.1. </p></main> |
| USER_CLIENT_PORT  | bigint(20)          | NO   |   The client address. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.0. </li> <li>In V4.2.x, this field was introduced in V4.2.3. </li></ul></main>  |
| PROXY_USER        | varchar(128)        | NO  |<ul><li>The name of the proxy user if the user is logged in as a proxy user. </li><li>NULL if the user is logged in as a non-proxy user. </li></ul><main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.2. </li><li>In V4.2.x, this field was introduced in V4.2.3. </li></ul></main> |
| SERVICE_NAME     | varchar(64)       | YES         | The name of the service that created the session. If the session is not created by a service name, the value is `NULL`. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.1. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP9. For other V4.2.x versions, this field was introduced in V4.2.4. </li></ul></main> |
| TOTAL_CPU_TIME   | bigint(21)        | NO          | The CPU usage time of the current command in seconds.<main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.1. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP5. </li></ul></main> |
| TOP_INFO         | varchar(262143)   | YES         | The information of the top-level PL statement where the executing SQL statement is located. <main id="notice" type='explain'><h4>Note</h4><ul><li>In V4.3.x, this field was introduced in V4.3.3. </li> <li>In V4.2.1, this field was introduced in V4.2.1 BP9. </li></ul></main> |
| MEMORY_USAGE     | bigint(20)        | NO          | The memory occupied by a single SQL statement, in bytes.   <main id="notice" type='explain'><h4>Note</h4><p>For V4.3.5, this field was introduced in V4.3.5 BP2. </p></main>  |
|TOP_TIME|double|NO|The top_time column in the PL scenario indicates the entire PL execution time.<main id="notice" type='explain'><h4>Note</h4><p>In V4.3.x, this field was introduced in V4.3.5 BP5. </p></main>|
|TOP_TRACE_ID|varchar(64)|YES|The traceid of the top-level statement.<main id="notice" type='explain'><h4>Note</h4><p>In V4.3.x, this field was introduced in V4.3.5 BP5. </p></main>|

## Sample queries

Query the session information of this OBServer node.

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.V$OB_PROCESSLIST LIMIT 1\G
```

The query result is as follows:

```shell
*************************** 1. row ***************************
           SVR_IP: 172.xx.xxx.xxx
         SVR_PORT: 2882
         SQL_PORT: 2881
               ID: 3221575191
             USER: root
             HOST: 100.xx.xxx.xxx:52264
               DB: NULL
           TENANT: mysql001
          COMMAND: Query
             TIME: 0.001143
       TOTAL_TIME: 0.000303
            STATE: ACTIVE
             INFO: SELECT * FROM oceanbase.GV$OB_PROCESSLIST
     PROXY_SESSID: NULL
    MASTER_SESSID: NULL
   USER_CLIENT_IP: 100.xx.xxx.xxx
        USER_HOST: %
        RETRY_CNT: 0
       RETRY_INFO: 0
           SQL_ID: 2E175335D36600B7A8EC72C5094888DD
         TRANS_ID: 0
        THREAD_ID: 2443
       SSL_CIPHER: NULL
         TRACE_ID: YB42AC1E87C3-000632CB9B9BB963-0-0
      TRANS_STATE:
           ACTION:
           MODULE:
      CLIENT_INFO:
            LEVEL: 1
SAMPLE_PERCENTAGE: 10
    RECORD_POLICY: SAMPLE_AND_SLOW_QUERY
           LB_VID: NULL
           LB_VIP: NULL
         LB_VPORT: NULL
         IN_BYTES: 448
        OUT_BYTES: 0
 USER_CLIENT_PORT: 52264
       PROXY_USER:
     SERVICE_NAME: NULL
   TOTAL_CPU_TIME: 0
         TOP_INFO: NULL
     MEMORY_USAGE: NULL
1 row in set
```

## References

* [GV$OB_PROCESSLIST](2500.gv-ob_processlist-of-mysql-mode.md)
* [Methods](../../../../600.manage/900.daily-inspection/900.full-link-detection/300.full-link-diagnosis.md)