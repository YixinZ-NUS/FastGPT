| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   |                 |
|machine-translation||

# MODIFY REPLICA

## Purpose

You can use this statement to convert the type of a replica.

## Limitations and considerations

* Make sure that the log stream still meets the majority principle after the type of replica is converted. Otherwise, the O&M command returns an error.
* This statement converts the type of one replica at a time.
* For the same log stream of a tenant, except for replica migration tasks that can be executed in parallel, other disaster recovery tasks (including adding replicas, deleting replicas, converting replica types, and modifying the quorum size of the log stream) can only be executed one at a time.

    <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>You can query ongoing replica tasks from the <code>CDB_OB_LS_REPLICA_TASKS</code> view in the <code>sys</code> tenant or from the <code>DBA_OB_LS_REPLICA_TASKS</code> view in a user tenant. </p>
    </main>

## Required privileges

To execute this statement, you must have the `ALTER SYSTEM` privilege. For more information about privileges in OceanBase Database, see [Privilege types in MySQL mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/200.permission-of-mysql-mode/100.permission-classification-of-mysql.md) and [Privilege types in Oracle mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md).

## Syntax

```sql
ALTER SYSTEM MODIFY REPLICA
    LS [=] ls_id
    SERVER [=] 'svr_ip:svr_port'
    REPLICA_TYPE [=] 'replica_type'
    [PAXOS_REPLICA_NUM [=] paxos_replica_num]
    [TENANT [=] 'tenant_name'];
```

## Parameters

|     **Parameter**      |             **Description**               |
|-------------------|------------------------------------|
| ls_id             | The ID of the log stream for which you want to convert the type of a replica. |
| svr_ip:svr_port   | The IP address and port number of the OBServer node on which you want to convert the type of the replica, for example, `xxx.xx.xxx.001:2882`. |
| replica_type      | The replica type to convert to. Conversion between the following two types of replicas is supported: <ul><li>Full-featured replica: A full-featured replica is denoted as <code>FULL</code> or <code>F</code>. </li><li>Read-only replica: A read-only replica is denoted as <code>READONLY</code> or <code>R</code>. </li></ul>  <main id="notice" type='explain'><h4>Note</h4><p>A full-featured replica can be elected as the leader, whereas a read-only replica cannot. </p></main>|
| paxos_replica_num | Optional. The number of Paxos members for electing the leader for the log stream. If this parameter is not explicitly specified, the default value is used. A log stream supports a maximum of seven full-featured replicas. <main id="notice" type='notice'><h4>Notice</h4><p>When you specify the `paxos_replica_num` parameter, take note of the following considerations: <ol><li>Converting a full-featured replica to a read-only replica is equivalent to removing a full-featured replica. In this case, you must decrease the value of the <code>paxos_replica_num</code> parameter by 1. </li><li>Converting a read-only replica to a full-featured replica is equivalent to adding a full-featured replica. In this case, you must increase the value of the <code>paxos_replica_num</code> parameter by 1. </li><li>After the value of the <code>paxos_replica_num</code> parameter is modified, the available replicas are the majority. </li><li>The value of the <code>paxos_replica_num</code> parameter must be greater than or equal to the number of members in the <code>MEMBER_LIST</code> of the leader. You can query the `MEMBER_LIST` from the <code>CDB_OB_LS_LOCATIONS</code> view in the `sys` tenant or from the <code>DBA_OB_LS_LOCATIONS</code> view in a user tenant. </li><li>The absolute value of the variation of the <code>paxos_replica_num</code> value cannot be greater than 1. For example, if the value of the <code>paxos_replica_num</code> parameter is `3`, you can change it only to `2` or `4`. </li></ol>If any of the preceding conditions is not met, the system will return an error. </p></main>|
| tenant_name       | Optional. The name of the target tenant. If this parameter is not explicitly specified, the name of the current tenant is used. <main id="notice" type='notice'><h4>Notice</h4><p>You can specify another tenant in the `sys` tenant and specify only the current tenant in a user tenant. You cannot use the <code>ALL</code>, <code>ALL_USER</code>, or <code>ALL_META</code> option in this statement to specify all tenants, all user tenants, or all meta tenants. </p></main>|

## Examples

Execute the following statement in the `sys` tenant to convert a full-featured replica of a log stream in the `mysql001` tenant to a read-only replica:

```sql
ALTER SYSTEM MODIFY REPLICA
    LS = 1001
    SERVER = 'xxx.xxx.xxx.001:2882'
    REPLICA_TYPE = 'R'
    PAXOS_REPLICA_NUM = 2
    TENANT = 'mysql001';
```

For information about how to convert the type of a replica, see [Convert the type of a replica](../../../../../600.manage/300.replica-management/200.replica-distribution/200.locality-common-operations/450.change-the-replica-type.md).

## References

* For information about how to add a replica, see [ADD REPLICA](110.add-replica-in-system-tenants.md).
* For information about how to drop a replica, see [REMOVE REPLICA](3130.remove-replica.md).
* For information about how to migrate a replica, see [MIGRATE REPLICA](1350.migrate-replica.md).
* For information about how to modify the `PAXOS_REPLICA_NUM` parameter for a replica, see [MODIFY PAXOS_REPLICA_NUM](1440.modify-paxos-replica-num.md).
* For information about how to cancel a replica task, see [CANCEL REPLICA TASK](1120.cancel-replica-task.md).
