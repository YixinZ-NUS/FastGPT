| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |
|machine-translation||

# CREATE CONCURRENT_LIMITING_RULE

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>This statement is available starting from OceanBase Database V4.3.5 BP3. </p>
</main>

## Purpose

This statement is used to create a throttling rule that specifies the throttling scope to limit the concurrency of specific SQL statements.

## Limitations and considerations

To execute the `CREATE CONCURRENT_LIMITING_RULE` statement in Oracle mode of OceanBase Database, you must have the `create any concurrent_limiting_rule` privilege.

## Syntax

```sql
CREATE CONCURRENT_LIMITING_RULE ccl_rule_name
ON `database`.`table`
TO '<usename>'@'ip'
FOR { ALL | UPDATE | SELECT | INSERT | DELETE }
filter_options:
    [ FILTER BY KEYWORD('KEYWORD1', 'KEYWORD2',â€¦) ]
 with_options:
    WITH MAX_CONCURRENCY = value1 [per sql]
```

## Parameters

|  Parameter             |       Description        |
|----------------------------|----------|
|`ccl_rule_name`|Required. The name of the throttling rule.|
|`database`.`table`|Required. The name of the database and table. You can use an asterisk (*) to match any database or table. <main id="notice" type='explain'><h4>Note</h4><p>To avoid name conflicts with SQL keywords, we recommend that you enclose the rule name in backticks (`). </p></main>|
|`<usename>@<host>`|Required. The name of the account. The host part can be specified as a wildcard (%).|
|`ALL`\|`UPDATE \| SELECT \| INSERT\| DELETE`|Required. The type of SQL statements. Currently, the `ALL`, `UPDATE`, `SELECT`, `INSERT`, and `DELETE` types are supported.<main id="notice" type='explain'><h4>Note</h4><p>Each throttling rule can only specify one type of SQL statements. </p></main>|
|`[ filter_options ]`|Optional. The throttling keywords. <main id="notice" type='explain'><h4>Note</h4><p><ul><li>The keywords are connected with the wildcard <code>%</code>. For example, if you specify three keywords, <code>"asdasd", "c2 = 123", and "xxyyzz"</code>, they are concatenated into <code>"%asdasd%c2 = 123%xxyyzz%"</code>. Subsequent SQL text matching is performed based on this string. </li><li>If a keyword contains <code>'_'</code>, it will be escaped. For example, <code>"table_t1"</code> will be recorded as <code>"%table\_t1%"</code>. </li><li> The number of throttling keywords is not limited, but the length of the concatenated string must not exceed <code>OB_MAX_VARCHAR_LENGTH=1048576</code>. </li></ul></p></main>|
|`with_options`|Required. Used to control the concurrency of throttling and specify the throttling statistics granularity at the rule level or the statement level. Currently, only the `MAX_CONCURRENCY` parameter is supported, which specifies the maximum concurrency of SQL statements that match the throttling rule. |

## Examples

Execute the following command to throttle based on keywords:

```shell
obclient> CREATE CONCURRENT_LIMITING_RULE   sql1_keywords_ccl_rule
ON *.* TO '%'@'%' FOR SELECT
FILTER BY KEYWORD('table1', 'table2', 'c1') WITH MAX_CONCURRENCY 100;
```