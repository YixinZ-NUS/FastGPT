| description |             |
|-------------|-------------|
| keywords    |             |
| dir-name    |             |
| dir-name-en |             |
| tenant-type | Oracle Mode |
|machine-translation||

# ALTER MATERIALIZED VIEW

## Purpose

This statement is used to modify the attributes of a materialized view.

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>For OceanBase Database V4.3.5, the <code>ALTER MATERIALIZED VIEW</code> statement is supported starting from V4.3.5 BP1.</p>
</main>

## Privileges

To execute the `ALTER MATERIALIZED VIEW` statement, the current user must have the `ALTER` privilege on the target object. For more information about OceanBase Database privileges, see [Privilege types in Oracle mode](../../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md).

## Syntax

```sql
ALTER MATERIALIZED VIEW [schema.]view_name alter_mview_action_list;

alter_mview_action_list:
    alter_mview_action [, alter_mview_action ...]

alter_mview_action:
    parallel_clause
    | REFRESH [nested_refresh_option] [[START WITH expr] [NEXT expr]]

parallel_clause:
    NOPARALLEL
    | PARALLEL integer

nested_refresh_option:
    INDIVIDUAL
    | INCONSISTENT
    | CONSISTENT
```

## Parameters

|        **Parameter**         |       **Description**           |
|-------------------------|--------------------------|
| schema.                 | Optional. The schema where the materialized view to be modified resides. If you omit `schema.`, the default materialized view is in the schema where the current session is located. |
| view_name               | The name of the materialized view to be modified. <main id="notice" type='explain'><h4>Note</h4><p>For OceanBase Database V4.3.5, the <code>RENAME</code> statement can be used to rename materialized views starting from V4.3.5 BP3. </p></main>|
| alter_mview_action_list | The list of actions that can be performed on the materialized view. Multiple actions can be specified at once, separated by commas (`,`). For more information, see [alter_mview_action](#alter_mview_action).|

### alter_mview_action

* `parallel_clause`: specifies the degree of parallelism for refreshing the materialized view. Valid values:

  * `NOPARALLEL`: the default value. The degree of parallelism is 1.
  * `PARALLEL integer`: specifies the degree of parallelism. The value of `integer` must be an integer greater than or equal to 1.

  **Here is an example:**

  ```sql
  ALTER MATERIALIZED VIEW mv1 PARALLEL 5;
  ```

* `REFRESH [nested_refresh_option] [[START WITH expr] [NEXT expr]]`: specifies the time cycle for scheduling background refresh tasks of the materialized view. You can also modify the refresh strategy of the nested materialized view by using this statement. The refresh strategy of the nested materialized view is specified by using the `nested_refresh_option` option. The `nested_refresh_option` option is optional.

  * `nested_refresh_option`: specifies the refresh strategy of the nested materialized view. The following options are available.

    * `INDIVIDUAL`: specifies to independently refresh the nested materialized view. This is the default value.
    * `INCONSISTENT`: specifies to perform cascading inconsistent refreshes.
    * `CONSISTENT`: specifies to perform cascading consistent refreshes.

    <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>For OceanBase Database V4.3.5, the nested materialized view refresh strategy can be modified starting from V4.3.5 BP3. </p>
    </main>

    **Here are some examples:**

    ```sql
    ALTER MATERIALIZED VIEW mv1 REFRESH INDIVIDUAL;
    ```

    ```sql
    ALTER MATERIALIZED VIEW mv1 REFRESH INCONSISTENT;
    ```

    ```sql
    ALTER MATERIALIZED VIEW mv1 REFRESH CONSISTENT;
    ```

  * `[START WITH expr]`: optional. The time expression when the refresh plan starts.
  * `[NEXT expr]`: optional. The time expression when the next refresh is scheduled.

    <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p><ul><li>If the <code>NEXT</code> clause is used, the time expression for the refresh schedule must be set to a future time point; otherwise, an error will occur.</li><li>To enable periodic automatic scheduling of refresh tasks for the materialized view, define the <code>NEXT</code> clause to set the scheduling interval.</li></ul></p>
    </main>

  We recommend that you use `current_date` to specify the current timezone time. An example of the time expression is as follows:

  * Refresh the materialized view every 10 seconds starting from the current time (`current_date`).

    ```sql
    START WITH current_date NEXT current_date + INTERVAL '10' SECOND
    ```

  * Refresh the materialized view every 10 hours starting from the current time (`current_date`).

    ```sql
    START WITH current_date NEXT current_date + INTERVAL '10' HOUR
    ```

  * Refresh the materialized view every day starting from the current time (`current_date`).

    ```sql
    START WITH current_date NEXT current_date + 1
    ```

  **Here are some examples:**

  ```sql
  ALTER MATERIALIZED VIEW mv1
      REFRESH START WITH current_date;
  ```

  ```sql
  ALTER MATERIALIZED VIEW mv1
      REFRESH NEXT current_date + 1;
  ```

  ```sql
  ALTER MATERIALIZED VIEW mv1
      REFRESH START WITH current_date NEXT current_date + 1;
  ```

## Examples

1. Create a table named `test_tbl1`.

    ```sql
    CREATE TABLE test_tbl1 (col1 NUMBER PRIMARY KEY, col2 VARCHAR2(20), col3 NUMBER, col4 BLOB);
    ```

2. Create a materialized view named `mv_test_tbl1`.

    ```sql
    CREATE MATERIALIZED VIEW mv_test_tbl1
        AS SELECT col1, col2, col3
           FROM test_tbl1;
    ```

3. Set the degree of parallelism of the `mv_test_tbl1` materialized view to 5.

    ```sql
    ALTER MATERIALIZED VIEW mv_test_tbl1 PARALLEL 5;
    ```

4. Modify the refresh schedule of the materialized view `mv_test_tbl1` to set the initial refresh time to the current date, and then refresh the materialized view every day thereafter.

    ```sql
    ALTER MATERIALIZED VIEW mv_test_tbl1
        REFRESH START WITH current_date NEXT current_date + 1;
    ```

## References

* [Overview of materialized views](../../../../../300.database-object-management/200.manage-object-of-oracle-mode/500.manage-views-of-oracle-mode/200.manage-materialized-views-of-oracle-mode/100.materialized-views-overview-of-oracle-mode.md)
* [Create a materialized view](../../../../../300.database-object-management/200.manage-object-of-oracle-mode/500.manage-views-of-oracle-mode/200.manage-materialized-views-of-oracle-mode/300.create-materialized-views-of-oracle-mode.md)
* [Refresh a materialized view](../../../../../300.database-object-management/200.manage-object-of-oracle-mode/500.manage-views-of-oracle-mode/200.manage-materialized-views-of-oracle-mode/400.refresh-materialized-views-of-oracle-mode.md)
* [Query a materialized view](../../../../../300.database-object-management/200.manage-object-of-oracle-mode/500.manage-views-of-oracle-mode/200.manage-materialized-views-of-oracle-mode/600.view-materialized-views-of-oracle-mode.md)
