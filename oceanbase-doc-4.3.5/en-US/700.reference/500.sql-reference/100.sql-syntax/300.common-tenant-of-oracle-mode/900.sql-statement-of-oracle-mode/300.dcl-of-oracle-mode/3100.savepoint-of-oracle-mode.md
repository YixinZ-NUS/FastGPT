| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |
|machine-translation||

# SAVEPOINT

## Purpose

You can use this statement to create a savepoint before committing a transaction so that you can roll back the transaction partially.

  <main id="notice" type='explain'>
    <h4>Note</h4>
    <ul>
    <li>Each savepoint name is unique in a transaction. A new savepoint will overwrite an existing savepoint with the same name. </li>
    <li>After you create a savepoint, you can continue to handle and commit jobs, roll back the entire transaction, or roll back the transaction to a specified savepoint. For more information about transaction rollback, see <a href="../300.dcl-of-oracle-mode/3000.rollback-of-oracle-mode.md">ROLLBACK</a>. </li>
    </ul>
  </main>

## Syntax

```sql
SAVEPOINT savepoint_name;
```

## Parameters

| Parameter | Description |
|----------------|-----------|
| savepoint_name | The name of the savepoint.  |

## Examples

Create a table named `employee`.

```sql
obclient> CREATE TABLE employee (id INT, name VARCHAR(10), salary INT);

obclient> INSERT INTO employee VALUES (1, 'Alice', 1000), (2, 'Bob', 2000), (3, 'Alice', 3000);
```

```sql
obclient> SELECT * FROM employee;
```

```sql
+------+-------+--------+
| ID   | NAME  | SALARY |
+------+-------+--------+
|    1 | Alice |   1000 |
|    2 | Bob   |   2000 |
|    3 | Alice |   3000 |
+------+-------+--------+
3 rows in set
```

1. Update the `employee` table by changing the value of `name` to 'Carol' for the row where `id = 3`, and create a savepoint named `point_after_update`.

   ```sql
   obclient> UPDATE employee SET name = 'Carol' WHERE id = 3;
   obclient> SAVEPOINT point_after_update;
   ```

2. Insert one row into the `employee` table and query the table.

   ```sql
   obclient> INSERT INTO employee VALUES (4, 'David', 4000);
   obclient> SELECT * FROM employee;
   ```

   ```sql
   Query OK, 1 row affected

   +------+-------+--------+
   | ID   | NAME  | SALARY |
   +------+-------+--------+
   |    1 | Alice |   1000 |
   |    2 | Bob   |   2000 |
   |    3 | Carol |   3000 |
   |    4 | David |   4000 |
   +------+-------+--------+
   4 rows in set
   ```

3. Roll back to `point_after_update` and query the table.

   ```sql
   obclient> ROLLBACK TO SAVEPOINT point_after_update;
   obclient> SELECT * FROM employee;
   ```

   ```sql
   Query OK, 0 rows affected

   +------+-------+--------+
   | ID   | NAME  | SALARY |
   +------+-------+--------+
   |    1 | Alice |   1000 |
   |    2 | Bob   |   2000 |
   |    3 | Carol |   3000 |
   +------+-------+--------+
   3 rows in set
   ```

   ```sql
   obclient> COMMIT;
   ```
