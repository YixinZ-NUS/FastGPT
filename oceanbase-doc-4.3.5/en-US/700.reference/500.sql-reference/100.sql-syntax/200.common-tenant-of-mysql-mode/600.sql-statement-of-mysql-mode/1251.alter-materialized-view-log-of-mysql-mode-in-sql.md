| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |
|machine-translation||

# ALTER MATERIALIZED VIEW LOG

## Purpose

This statement is used to modify the attributes of a materialized view log (mlog).

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>For OceanBase Database V4.3.5, the <code>ALTER MATERIALIZED VIEW LOG</code> statement is supported starting from V4.3.5 BP1.</p>
</main>

## Privileges

To execute the `ALTER MATERIALIZED VIEW LOG` statement, the current user must have the `ALTER` privilege on the base table (ordinary table or materialized view). For more information about OceanBase Database privileges, see [Privilege types in MySQL mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/200.permission-of-mysql-mode/100.permission-classification-of-mysql.md).

## Syntax

```sql
ALTER MATERIALIZED VIEW LOG ON [database.]table_name alter_mlog_action_list;

alter_mview_action_list:
    alter_mlog_action [, alter_mlog_action ...]

alter_mlog_action:
    parallel_clause
    | PURGE [[START WITH expr] [NEXT expr]]
    | LOB_INROW_THRESHOLD [=] integer

parallel_clause:
    NOPARALLEL
    | PARALLEL integer
```

## Parameters

|        **Parameter**        |       **Description**           |
|------------------------|--------------------------|
| database.              | Optional. The name of the database where the materialized view is located. If you omit `database.`, the default table in the current session's database is used. |
| table_name             | The name of the base table corresponding to the materialized view log. |
| alter_mlog_action_list | The list of operations that can be performed on the materialized view log. Multiple actions can be specified at once, separated by commas (`,`). For more information, see [alter_mlog_action](#alter_mlog_action).|

### alter_mlog_action

* `parallel_clause`: the degree of parallelism for the materialized view log table. Valid values:

  * `NOPARALLEL`: the degree of parallelism is 1. This is the default value.
  * `PARALLEL integer`: the degree of parallelism, where `integer` is an integer greater than or equal to 1.

  **Here is an example:**

  ```sql
  ALTER MATERIALIZED VIEW LOG ON tbl1 PARALLEL 5;
  ```

* `PURGE [[START WITH expr] [NEXT expr]]`: the time cycle for scheduling background cleanup tasks for the materialized view log.

  * `[START WITH expr]`: optional. The time when the first cleanup task is scheduled.
  * `[NEXT expr]`: optional. The time when the next cleanup task is scheduled. It is used to specify the time when the next cleanup task is scheduled.

  <main id="notice" type='notice'>
    <h4>Notice</h4>
    <p>Make that both the <code>START WITH expr</code> and <code>NEXT expr</code> time expressions are set to future time points. Otherwise, an error will occur.</p>
  </main>

  We recommend that you use `sysdate()` to specify the current time in the local time zone. Here is an example of a time expression:

  ```sql
  START WITH sysdate() NEXT sysdate() + INTERVAL 1 DAY
  ```

  The above clause indicates that expired materialized view log records will be cleaned up every day starting from the current time (`sysdate()`).

  **Here is an example:**

  ```sql
  ALTER MATERIALIZED VIEW LOG ON tbl1 PURGE START WITH sysdate();
  ```

  ```sql
  ALTER MATERIALIZED VIEW LOG ON tbl1 PURGE NEXT sysdate() + INTERVAL 1 DAY;
  ```

  ```sql
  ALTER MATERIALIZED VIEW LOG ON tbl1 PURGE START WITH sysdate() NEXT sysdate() + INTERVAL 1 DAY;
  ```

* `LOB_INROW_THRESHOLD [=] integer`: the length threshold for inline storage of LOBs in the materialized view log. The value can be increased but not decreased.

  <main id="notice" type='explain'>
    <h4>Note</h4>
    <p>The default value of <code>LOB_INROW_THRESHOLD</code> is 8 KB. The default value of <code>LOB_INROW_THRESHOLD</code> for materialized view logs is not controlled by the system variable <a href="../../../../800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/6300.ob_default_lob_inrow_threshold-global.md">ob_default_lob_inrow_threshold</a>. </p>
  </main>

  **Here is an example:**

  ```sql
  ALTER MATERIALIZED VIEW LOG ON tbl1 LOB_INROW_THRESHOLD 10000;
  ```

## References

[Materialized view logs](../../../../300.database-object-management/100.manage-object-of-mysql-mode/600.manage-views-of-mysql-mode/200.manage-materialized-views-of-mysql-mode/200.materialized-views-log-of-mysql-mode.md)