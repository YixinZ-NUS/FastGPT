|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# Drop a materialized view

## Considerations

* When you drop a materialized view, it is not moved to the recycle bin.
* If materialized view logs are created on the base table of the materialized view, you must drop the materialized view logs on the base table before you drop the base table. Otherwise, an error is returned.

## Privilege requirements

To drop a materialized view, you must have the `DROP TABLE` privilege. For more information about privileges in OceanBase Database, see [Privilege types in MySQL-compatible mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/200.permission-of-mysql-mode/100.permission-classification-of-mysql.md).

## Syntax

```sql
DROP MATERIALIZED VIEW [IF EXISTS] materialized_view_list [opt_drop_behavior];

materialized_view_list:
    [ database. ]materialized_view [,[ database. ]materialized_view]...

opt_drop_behavior:
    RESTRICT | CASCADE
```

## Parameters

|       **Parameter**    |       **Description**           |
|-------------------|--------------------------|
| IF EXISTS         | Optional. If you specify `IF EXISTS`, an error will not be returned if the materialized view to be dropped does not exist; otherwise, an error will be returned if the materialized view to be dropped does not exist. |
| database.         | Optional. Specifies the database where the materialized view is located. If you omit `database.`, the current database is used by default.|
| materialized_view | Specifies the name of the materialized view.|
| RESTRICT \| CASCADE | Optional. Specifies the behavior of the drop operation.<ul><li>CASCADE is the default value. It specifies to drop the materialized view and all objects that depend on it. </li><li>RESTRICT specifies to drop the materialized view only if no objects depend on it. </li></ul>|

## Examples

The following examples show how to create a materialized view, query materialized views, and drop a materialized view.

1. Create a table named `test_tbl1` as the base table of the materialized view.

    ```sql
    CREATE TABLE test_tbl1 (col1 INT PRIMARY KEY, col2 VARCHAR(20), col3 INT);
    ```

2. Create a materialized view named `mv_test_tbl1` based on the `test_tbl1` table.

    ```sql
    CREATE MATERIALIZED VIEW mv_test_tbl1(PRIMARY KEY (col1))
        AS SELECT col1, col2
           FROM test_tbl1;
    ```

3. Create a materialized view log on the `mv_test_tbl1` materialized view.

    ```sql
    CREATE MATERIALIZED VIEW LOG ON mv_test_tbl1
        WITH PRIMARY KEY (col2) INCLUDING NEW VALUES;
    ```

4. Create a nested materialized view named `mv_mv_test_tbl1` based on the `mv_test_tbl1` materialized view.

    ```sql
    CREATE MATERIALIZED VIEW mv_mv_test_tbl1
        AS SELECT col1
           FROM mv_test_tbl1;
    ```

5. View information about all materialized views.

    ```sql
    SELECT owner, mview_name, container_name, query, refresh_mode
    FROM oceanbase.DBA_MVIEWS;
    ```

    The return result is as follows:

    ```shell
    +---------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+--------------+
    | owner   | mview_name      | container_name  | query                                                                                                           | refresh_mode |
    +---------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+--------------+
    | db_test | mv_mv_test_tbl1 | mv_mv_test_tbl1 | select `mv_test_tbl1`.`col1` AS `col1` from `db_test`.`mv_test_tbl1` `mv_test_tbl1`                             | DEMAND       |
    | db_test | mv_test_tbl1    | mv_test_tbl1    | select `db_test`.`test_tbl1`.`col1` AS `col1`,`db_test`.`test_tbl1`.`col2` AS `col2` from `db_test`.`test_tbl1` | DEMAND       |
    +---------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+--------------+
    2 rows in set
    ```

6. Drop the `mv_mv_test_tbl1` materialized view.

    ```sql
    DROP MATERIALIZED VIEW mv_mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

7. Drop the `mv_test_tbl1` materialized view.

    <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p>If materialized view logs are created on the base table of the materialized view, you must drop the materialized view logs on the base table before you drop the base table. Otherwise, an error is returned. </p>
    </main>

    ```sql
    DROP MATERIALIZED VIEW mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    ERROR 1235 (0A000): drop table required by materialized view refresh is not supported
    ```

8. Drop the materialized view logs on the `mv_test_tbl1` materialized view.

    ```sql
    DROP MATERIALIZED VIEW LOG ON mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

9. Drop the `mv_test_tbl1` materialized view again.

    ```sql
    DROP MATERIALIZED VIEW mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

## References

* [Overview of materialized views](100.materialized-views-overview-of-mysql-mode.md)
* [Materialized view logs](200.materialized-views-log-of-mysql-mode.md)
* [Create a materialized view](300.create-materialized-views-of-mysql-mode.md)
* [Refresh a materialized view](400.refresh-materialized-views-of-mysql-mode.md)
* [Query rewrite by using materialized views](500.materialized-views-rewrite-of-mysql-mode.md)
* [Query materialized views](600.view-materialized-views-of-mysql-mode.md)
