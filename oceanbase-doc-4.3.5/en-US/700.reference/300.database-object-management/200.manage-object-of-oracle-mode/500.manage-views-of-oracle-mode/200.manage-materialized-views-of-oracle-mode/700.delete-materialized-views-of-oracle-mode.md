|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|

# Drop a materialized view

## Privilege requirements

To drop a materialized view, you must have the `DROP TABLE` privilege. For more information about privileges in OceanBase Database, see [Privilege types in Oracle-compatible mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md).

## Considerations

* When you drop a materialized view, it is not moved to the recycle bin.
* If materialized view logs are created on the base table of the materialized view, you must drop the materialized view logs on the base table before you drop the base table. Otherwise, an error is returned.

## Syntax

The syntax for dropping a materialized view is as follows:

```sql
DROP MATERIALIZED VIEW [ schema. ] materialized_view;
```

## Parameters

|       **Parameter**    |       **Description**           |
|-------------------|--------------------------|
| schema.         | Optional. Specifies the schema where the materialized view is located. If you omit `schema.`, the current schema is used by default.|
| materialized_view | Specifies the name of the materialized view.|

## Examples

The following examples show how to create a materialized view, query materialized views, and drop a materialized view.

1. Create a table named `test_tbl1` as the base table of the materialized view.

    ```sql
    CREATE TABLE test_tbl1 (col1 INT PRIMARY KEY, col2 VARCHAR2(20), col3 INT);
    ```

2. Create a materialized view named `mv_test_tbl1` based on the `test_tbl1` table.

    ```sql
    CREATE MATERIALIZED VIEW mv_test_tbl1(PRIMARY KEY (col1))
        AS SELECT col1, col2
           FROM test_tbl1;
    ```

3. Create a materialized view log on the `mv_test_tbl1` materialized view.

    ```sql
    CREATE MATERIALIZED VIEW LOG ON mv_test_tbl1
        WITH PRIMARY KEY (col2) INCLUDING NEW VALUES;
    ```

4. Create a nested materialized view named `mv_mv_test_tbl1` based on the `mv_test_tbl1` materialized view.

    ```sql
    CREATE MATERIALIZED VIEW mv_mv_test_tbl1
        AS SELECT col1
           FROM mv_test_tbl1;
    ```

5. View information about all materialized views.

    ```sql
    SELECT owner, mview_name, container_name, query, refresh_mode
    FROM sys.DBA_MVIEWS
    WHERE OWNER = 'TEST_USER001';
    ```

    <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p>In Oracle mode, the <code>OWNER</code> column of the view <code>sys.DBA_MVIEWS</code> matches the schema name in uppercase letters. </p>
    </main>

    The return result is as follows:

    ```shell
    +--------------+-----------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------+--------------+
    | OWNER        | MVIEW_NAME      | CONTAINER_NAME  | QUERY                                                                                                                          | REFRESH_MODE |
    +--------------+-----------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------+--------------+
    | TEST_USER001 | MV_TEST_TBL1    | MV_TEST_TBL1    | select "TEST_USER001"."TEST_TBL1"."COL1" AS "COL1","TEST_USER001"."TEST_TBL1"."COL2" AS "COL2" from "TEST_USER001"."TEST_TBL1" | DEMAND       |
    | TEST_USER001 | MV_MV_TEST_TBL1 | MV_MV_TEST_TBL1 | select "MV_TEST_TBL1"."COL1" AS "COL1" from "TEST_USER001"."MV_TEST_TBL1" "MV_TEST_TBL1"                                       | DEMAND       |
    +--------------+-----------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------+--------------+
    2 rows in set
    ```

6. Drop the `mv_mv_test_tbl1` materialized view.

    ```sql
    DROP MATERIALIZED VIEW mv_mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

7. Drop the `mv_test_tbl1` materialized view.

    <main id="notice" type='notice'>
      <h4>Notice</h4>
      <p>If materialized view logs are created on the base table of the materialized view, you must drop the materialized view logs on the base table before you drop the base table. Otherwise, an error is returned. </p>
    </main>

    ```sql
    DROP MATERIALIZED VIEW mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    OBE-00600: internal error code, arguments: -4007, drop table required by materialized view refresh is not supported
    ```

8. Drop the materialized view logs on the `mv_test_tbl1` materialized view.

    ```sql
    DROP MATERIALIZED VIEW LOG ON mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

9. Drop the `mv_test_tbl1` materialized view again.

    ```sql
    DROP MATERIALIZED VIEW mv_test_tbl1;
    ```

    The return result is as follows:

    ```shell
    Query OK, 0 rows affected
    ```

## References

* [Overview of materialized views](100.materialized-views-overview-of-oracle-mode.md)
* [Materialized view logs](200.materialized-views-log-of-oracle-mode.md)
* [Create a materialized view](300.create-materialized-views-of-oracle-mode.md)
* [Refresh a materialized view](400.refresh-materialized-views-of-oracle-mode.md)
* [Query rewrite by using materialized views](500.materialized-views-rewrite-of-oracle-mode.md)
* [Query materialized views](600.view-materialized-views-of-oracle-mode.md)
