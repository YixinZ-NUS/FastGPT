|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|

# Modify a dynamic partitioned table

In OceanBase Database, you can modify the dynamic partition management attributes of a table by updating `DYNAMIC_PARTITION_POLICY`.

This topic describes how to modify a dynamic partitioned table by using SQL statements.

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>For OceanBase Database V4.3.5, the <code>DYNAMIC_PARTITION_POLICY</code> parameter is supported for creating dynamic partitioned tables starting from V4.3.5 BP2. </p>
</main>

## Limitations and considerations

After modifying the dynamic partition management parameters, the actions of pre-creating partitions and deleting expired partitions will not take effect immediately. You need to wait for the next automatic scheduling of the dynamic partition management task, or manually trigger the dynamic partition management task. For more information about how to schedule a dynamic partition management task, see [Dynamic partition management task](500.dynamic-partition-management-task-of-oracle-mode.md).

## Privilege requirements

To modify a dynamic partitioned table, you need the `ALTER` privilege. For more information about privileges in OceanBase Database, see [Privilege types in Oracle-compatible mode](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md).

## Syntax

The SQL statement format for creating a dynamic partitioned table is as follows:

```sql
ALTER TABLE table_name [SET] DYNAMIC_PARTITION_POLICY [=] (dynamic_partition_policy_list);

dynamic_partition_policy_list:
    dynamic_partition_policy_option [, dynamic_partition_policy_option ...]

dynamic_partition_policy_option:
    ENABLE = {true | false}
    | PRECREATE_TIME = {'-1' | '0' | 'n {hour | day | week | month | year}'}
    | EXPIRE_TIME = {'-1' | '0' | 'n {hour | day | week | month | year}'}
```

## Dynamic partition management attributes

|   **Attribute**   | **Description** | **Required?** | **Modifiable?** |
|------------------|----------|--------------|----------------|
| ENABLE           | Specifies whether to enable dynamic partition management. Valid values:<ul><li>`true`: specifies to enable dynamic partition management. This is the default value.</li><li>`false`: specifies to disable dynamic partition management.</li></ul>| No | Yes |
| PRECREATE_TIME   | Specifies the precreation time. Partitions are precreated in an scheduling task of dynamic partition management so that **max_partition_upper_bound > now() + precreate_time**. Valid values:<ul><li>`-1`: specifies not to precreate partitions. This is the default value.</li><li>`0`: specifies to precreate only the current partition.</li><li>`n {hour \| day \| week \| month \| year}`: specifies to precreate partitions within the specified time span. For example, `3 hour` specifies to precreate partitions within 3 hours.</li></ul>  <main id="notice" type='explain'><h4>Note</h4><p><ul><li>When you want to precreate multiple partitions, the intervals between partition boundaries must be <code>TIME_UNIT</code>. </li><li>The boundary of the first precreated partition is the upper boundary of the largest existing partition, rounded up to the nearest value of <code>TIME_UNIT</code>. </li></ul></p></main>| No | Yes |
| EXPIRE_TIME      | Specifies the partition expiration time. Partitions are deleted in an scheduling task of dynamic partition management so that **partition_upper_bound < now() - expire_time**. Valid values:<ul><li>`-1`: specifies that partitions never expire. This is the default value.</li><li>`0`: specifies that all partitions except the current one expire.</li><li>`n {hour \| day \| week \| month \| year}`: specifies the partition expiration time. For example, `1 day` specifies that the partition expiration time is 1 day.</li></ul>| No | Yes |

For more information about how to modify the syntax of a table, see [ALTER TABLE](../../../../500.sql-reference/100.sql-syntax/300.common-tenant-of-oracle-mode/900.sql-statement-of-oracle-mode/100.ddl-of-oracle-mode/1000.alter-table-of-oracle-mode.md).

## Examples

1. Query the dynamic partitioning information about the `test_tbl1` table.

    ```sql
    SELECT * FROM sys.DBA_OB_DYNAMIC_PARTITION_TABLES
    WHERE TABLE_NAME = 'TEST_TBL1';
    ```

    The query result is as follows:

    ```shell
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    | DATABASE_NAME | TABLE_NAME | TABLE_ID | MAX_HIGH_BOUND_VAL                     | ENABLE | TIME_UNIT | PRECREATE_TIME | EXPIRE_TIME | TIME_ZONE | BIGINT_PRECISION |
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    | SYS           | TEST_TBL1  |   507940 | Timestamp '2024-11-11 13:30:00.000000' | TRUE   | HOUR      | 3HOUR          | 1DAY        | +8:00     | NONE             |
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    1 row in set
    ```

2. Modify the dynamic partitioning settings for the `test_tbl1` table as follows:

   * Precreate partitions for one day starting from the current time.
   * Partitions never expire.

   ```sql
   ALTER TABLE test_tbl1 DYNAMIC_PARTITION_POLICY(
       ENABLE = true,
       PRECREATE_TIME = '1 day',
       EXPIRE_TIME = '-1'
   );
   ```

3. Query the dynamic partitioning information about the `test_tbl1` table again.

    ```sql
    SELECT * FROM sys.DBA_OB_DYNAMIC_PARTITION_TABLES
    WHERE TABLE_NAME = 'TEST_TBL1';
    ```

    The query result is as follows:

    ```shell
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    | DATABASE_NAME | TABLE_NAME | TABLE_ID | MAX_HIGH_BOUND_VAL                     | ENABLE | TIME_UNIT | PRECREATE_TIME | EXPIRE_TIME | TIME_ZONE | BIGINT_PRECISION |
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    | SYS           | TEST_TBL1  |   507940 | Timestamp '2024-11-11 13:30:00.000000' | TRUE   | HOUR      | 1DAY           | -1          | +8:00     | NONE             |
    +---------------+------------+----------+----------------------------------------+--------+-----------+----------------+-------------+-----------+------------------+
    1 row in set
    ```

    <main id="notice" type='explain'>
      <h4>Note</h4>
      <p>After modifying the dynamic partition management parameters, the actions of pre-creating partitions and deleting expired partitions will not take effect immediately. You need to wait for the next automatic scheduling of the dynamic partition management task, or manually trigger the dynamic partition management task. For more information, see <a href="500.dynamic-partition-management-task-of-oracle-mode.md">Dynamic partition management task</a>.</p>
    </main>

## References

* [Overview of dynamic partitioning](100.dynamic-partition-overview-of-oracle-mode.md)
* [Create a dynamic partitioned table](200.create-a-dynamic-partition-table-of-oracle-mode.md)
* [Query a dynamic partitioned table](300.view-dynamic-partition-table-of-oracle-mode.md)
* [Manage dynamic partitions](500.dynamic-partition-management-task-of-oracle-mode.md)