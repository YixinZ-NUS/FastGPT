|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# Recycle bin

The recycle bin is a data dictionary table in principle. It stores information about database and table objects that are deleted by users. Information in the recycle bin still occupies physical space unless being manually cleared by using the `PURGE` command or periodically deleted by the system.

## Objects in the recycle bin

In the current version, the recycle bin supports the following objects: indexes, tables, databases, and tenants. Since only the `sys` tenant can delete a tenant, MySQL user tenants and Oracle user tenants are deleted and moved to the recycle bin of the `sys` tenant.

* The `sys` tenant can manage the following objects in the recycle bin: databases, tables, indexes, and tenants.

* A MySQL user tenant can manage the following objects in the recycle bin: databases, tables, and indexes.

* An Oracle user tenant can manage the following objects in the recycle bin: tables and indexes.

<main id="notice" type='notice'>
<h4>Notice</h4>
<ul>
<li>If you drop an index directly, the index will not be moved to the recycle bin. When you drop a table, the indexes on the table will also be moved to the recycle bin with the table. </li>
<li>You cannot query or perform DML operations on objects in the recycle bin. You can perform only DDL operations on objects in the recycle bin, including the Purge and Flashback operations. </li>
<li>Recycle bin management is primarily handled by the <code>sys</code> tenant. </li>
</ul>
</main>

## View the objects in the recycle bin

The tenant administrator can run the following command to view the objects in the recycle bin:

```sql
obclient> SHOW RECYCLEBIN;
```

## Enable or disable the recycle bin

After a tenant is created, the recycle bin is disabled by default. If the recycle bin is enabled, after a `DROP` operation is performed on a database object, the database object is moved to the recycle bin. OceanBase Database provides global and session-level commands for enabling or disabling the recycle bin.

* The global command for enabling or disabling the recycle bin is as follows:

   ```sql
   obclient> SET GLOBAL recyclebin = ON/OFF;
   ```

* The session-level command for enabling or disabling the recycle bin is as follows:

   ```sql
   obclient> SET @@recyclebin = ON/OFF;
   ```

## Restore objects from the recycle bin

The tenant administrator can run the `FLASHBACK` command to restore database and table objects from the recycle bin. The object name can be modified upon restore but must be different from an existing object name.

The following list shows the commands for restoring tenants, databases, and tables from the recycle bin:

* Restore a tenant

   ```sql
   obclient> FLASHBACK TENANT tenant_name TO BEFORE DROP [RENAME to new_tenant_name];
   ```

* Restore a database

   ```sql
   obclient> FLASHBACK DATABASE object_name TO BEFORE DROP [RENAME TO database_name];
   ```

* Restore a table

   ```sql
   obclient> FLASHBACK TABLE object_name TO BEFORE DROP [RENAME to table_name];
   ```

The following list describes the limitations on these commands:

* When database objects are restored by using the `FLASHBACK` command, the objects are restored in the sequence of database \> table.

* When a table is restored, the indexes in this table are also restored.

* Indexes can be separately purged by using the `PURGE` command, but cannot be separately restored by using the `FLASHBACK` command.

* If a table in a table group is deleted and moved to the recycle bin and then the table group is deleted, the table does not belong to any table group after it is restored. If the table group is not deleted, the table still belongs to the table group after it is restored.

## Purge objects in the recycle bin

Frequent deletion and rebuilding of database objects generate a large amount of data in the recycle bin. You can execute the `PURGE` statement to clear the data. The `PURGE` command deletes an object along with its dependent objects. For example, when a database is purged, the tables and indexes in the database are also deleted.

The `PURGE` command permanently deletes the information about an object from the recycle bin of OceanBase Database, and the actual data is also recycled. When an upper-layer object of a current object is purged, the objects dependent on the current object in the recycle bin are also purged.

The following examples show how to use the `PURGE` command to clear specific data in the recycle bin:

* Use the `sys` tenant to physically purge a specified tenant from the recycle bin.

   ```sql
   obclient> PURGE TENANT tenant_name;
   ```

* Physically purge a specified database from the recycle bin.

   ```sql
   obclient> PURGE DATABASE object_name;
   ```

* Physically purge a specified table from the recycle bin.

   ```sql
   obclient> PURGE TABLE object_name;
   ```

* Physically purge a specified index table from the recycle bin.

   ```sql
   obclient> PURGE INDEX object_name;
   ```

* Clear the entire recycle bin.

   ```sql
   obclient> PURGE RECYCLEBIN;
   ```
