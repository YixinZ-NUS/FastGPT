|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# ob_vector_memory_limit_percentage

<main id="notice" type='explain'>
  <h4>Note</h4>
  <p>This parameter was introduced in OceanBase Database V4.3.3. </p>
</main>

## Description

The `ob_vector_memory_limit_percentage` parameter specifies the memory usage threshold (in percentage) for the vector index module.

## Privilege requirements

* Query the parameter

  The `sys` tenant and MySQL tenants can execute the `SHOW PARAMETERS` statement or query the `GV$OB_PARAMETERS` view to view the parameter.

* Modify the parameter

  The `sys` tenant and MySQL user tenants can modify the parameter.

## Attributes

|      **Attribute**      |   **Description**   |
|--------------------|--------------|
| Type             | Int         |
| Default value               | 0  <main id="notice" type='notice'><h4>Notice</h4><p>For versions earlier than V4.3.5 BP3, the default value indicates that no memory is allocated for vector indexes, which disables the vector search feature. <br>Starting from V4.3.5 BP3, the default value indicates the adaptive mode, where the system automatically adjusts the memory usage ratio for vector index data in the tenant: <ul><li>If the tenant's actual memory is 8 GB or less, the value adapts to 40. </li><li>If the tenant's actual memory is more than 8 GB, the value adapts to 50. </li></ul></p></main> |
| Valid values             | [0, 100). The actual maximum value is `85 - MemStore` (that is, `memstore_limit_percentage`). When the `memstore_limit_percentage` parameter is set to `0` (the default value), the system automatically calculates the memory usage ratio of MemStore. The automatic calculation rules are as follows:<ul><li>If the tenant memory is greater than 8 GB: MemStore occupies 50% of the tenant memory. </li><li>If the tenant memory is less than or equal to 8 GB: MemStore occupies 40% of the tenant memory. </li></ul> |
| Modifiable           | Yes. You can execute the `ALTER SYSTEM SET` statement to modify the parameter.|
| Effective after restart of OBServer node | No. The parameter takes effect immediately after it is set.     |

## Considerations

### Memory calculation

The value of this parameter needs to be planned based on the formula and business requirements. For more information, click [Download the memory calculation table](https://obbusiness-private.oss-cn-shanghai.aliyuncs.com/doc/img/observer/V4.3.3/%E5%86%85%E5%AD%98%E8%AE%A1%E7%AE%97.xlsx) to calculate the parameter value.

Description of the table:

* If multiple vector indexes need to be created under a single tenant, the required memory is the total of all indexes.

* You need to fill in the first column (data volume) and the second column (vector dimension) of the sheet according to your business scenario.

* The third column, M, in the table represents the maximum number of edges for the HNSW graph index. The default value is 16, and it typically does not need to be modified.

* The fifth column, minimum memory configuration, is only applicable for scenarios where the index is created after the fact and no new data is added.

### Increase the memory usage for vector indexes

If you need to increase the memory usage threshold for vector indexes, it is recommended to first reduce the MemStore memory ratio for the tenant. This can be achieved by modifying the `_memstore_limit_percentage` parameter in the user tenant.

<main id="notice" type='notice'>
  <h4>Notice</h4>
  <p>Reducing the MemStore ratio may impact DML performance. Therefore, in environments with high DML pressure, make sure to evaluate the impact before making any changes.</p>
</main>

## Example

Set the threshold for memory usage by vector indexes to 30%.

```shell
obclient> ALTER SYSTEM SET ob_vector_memory_limit_percentage = 30;
```

Increase the the memory usage threshold for vector indexes to 59%.

```shell
obclient> ALTER SYSTEM SET _memstore_limit_percentage = 25;
          ALTER SYSTEM SET ob_vector_memory_limit_percentage = 59;
```

Check the current memory configuration for vector indexes.

```shell
obclient> SHOW PARAMETERS LIKE 'ob_vector_memory_limit_percentage';
```

## References

* [memstore_limit_percentage/_memstore_limit_percentage](../300.cluster-level-configuration-items/13800.memstore_limit_percentage.md)