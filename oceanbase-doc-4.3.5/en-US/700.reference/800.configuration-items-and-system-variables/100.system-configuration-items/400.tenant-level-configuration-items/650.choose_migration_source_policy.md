|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# choose_migration_source_policy

<main id="notice" type='explain'>
  <h4>Note</h4>
  <ul><li>For OceanBase Database V4.3.x, this parameter was introduced in OceanBase Database V4.3.2. </li><li>For OceanBase Database V4.2.x, this parameter was introduced in OceanBase Database V4.2.1 BP7 and V4.2.3. </li></ul>
</main>

## Description

`choose_migration_source_policy` specifies the prioritizing strategy for selecting the source replica for migration.

## Limitations

* Query the parameter

  In the `sys` tenant or a user tenant, you can execute the `SHOW PARAMETERS` statement to query the parameter or query the `GV$OB_PARAMETERS` view for the parameter.

* Modify the parameter

  You can use the `ALTER SYSTEM SET` statement to modify the parameter in the `sys` tenant or a user tenant.

## Attributes

| **Attribute** | **Description** |
| -------- | -------- |
| Type | String |
| Default value | idc |
| Value range | <ul><li>`idc`: A follower in the same IDC is preferentially selected as the migration source. If only the leader is available, the leader is selected. </li><li>`region`: A follower in the same region is preferentially selected as the migration source. If only the leader is available, the leader is selected. </li></ul> |
| Modifiable | Yes. You can use the `ALTER SYSTEM SET` statement to modify the parameter. |
| Effective upon OBServer node restart | No. The setting takes effect immediately.   |

## Considerations

* The network relationships between the migration source and destination with respect to location are defined as follows: same IDC, same region but different IDCs, and different regions.

  * `choose_migration_source_policy` is set to `idc`:

    A follower in the same IDC is preferentially selected as the migration source. If multiple followers meet the requirement, any one of them is selected. If no follower meets the requirement, the leader meeting the requirement is selected. If no replica in the same IDC meets the requirement, a replica is selected from other IDCs within the same region.

  * `choose_migration_source_policy` is set to `region`:

    * Same region but different IDCs

      A follower in the same region is preferentially selected as the migration source. If multiple followers meet the requirement, any one of them is selected. If no follower meets the requirement, the leader meeting the requirement is selected. If no replica in the same region meets the requirement, a replica is selected from other regions.

    * Different regions

      A follower in other regions is preferentially selected as the migration source. If multiple followers meet the requirement, any one of them is selected. If no replica in other regions meets the requirement, error `4600` is returned.

* In the same region, if bandwidth across different IDCs is significantly smaller than that within the same IDC, we recommend that you set this parameter to `idc`. If the bandwidth difference is not significant, we recommend that you set this parameter to `region`.

* You must correctly specify the location information of OBServer nodes. Otherwise, the migration source feature cannot run properly.

## Examples

Configure to preferentially select a replica in the same IDC as the migration source.

```shell
obclient> ALTER SYSTEM SET choose_migration_source_policy='idc';
```