|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 配置最佳实践

为了确保用户在各种业务场景下，能够基于 OceanBase 数据库获得比较好的性能，OceanBase 基于过往大量真实场景的调优经验总结了各类业务场景下一些核心配置项和变量的推荐配置。OceanBase 云平台（OceanBase Cloud Platform，简称：OCP）支持用户在创建租户时在参数设置中选择参数模板，基于用户选择的参数模板，通过读取对应版本内核的 RPM 包内容获得对应参数取值。使用 OCP 创建租户的信息，参见 [新建主租户](https://www.oceanbase.com/docs/common-ocp-1000000000826469)。

本文主要介绍在黑屏部署 OceanBase 数据库后，针对不同业务应用场景，核心配置项与系统变量的推荐配置。

## 参数配置模板

安装 OceanBase 数据库 RPM 包后，可以在 `/home/admin/oceanbase/etc` 目录下查看不同业务场景下的推荐参数配置的参数配置模板。

* `default_parameter.json`：保存了配置项的推荐配置。
* `default_system_variable.json`：保存了变量的推荐配置。

<main id="notice" type='notice'>
  <h4>注意</h4>
  <p>本文中的参数介绍信息基于 OceanBase 数据库 V4.3.5 BP4 版本中的配置模板更新。若需查询其他版本的推荐配置，请通过对应版本安装包中的配置文件获取最新参数组合。</p>
</main>

**参数配置文件中的模版分类：**

* `express_oltp`：本模版适用于交易、支付核心系统、互联网高吞吐量应用等工作负载类型，无外键约束、无存储过程、无长事务、无大事务、无复杂连接及复杂子查询等限制。在本场景下，相关推荐配置的详细介绍信息，可参见下文 [express_oltp](#express_oltp)。

* `complex_oltp`：本模版适用于银行、保险系统等工作负载，通常涉及复杂连接、复杂相关子查询、使用 PL 编写的批处理作业，同时存在长事务和大事务。对于短期运行的查询，有时会采用并行执行。在本场景下，相关推荐配置的详细介绍信息，可参见下文 [complex_oltp](#complex_oltp)。

* `olap`：本模版主要用于实时数据仓库分析应用。在本场景下，相关推荐配置的详细介绍信息，可参见下文 [olap](#olap)。

* `htap`：本模版适用于 OLAP 和 OLTP 混合负载场景，包括不限于运营数据实时分析、欺诈行为检测、个性化推荐等。在本场景下，相关推荐配置的详细介绍信息，可参见下文 [htap](#htap)。

* `kv`：本模版适用于 HBase 兼容和 Key-Value 表模型访问模式，单分区访问，无 SQL 层。此场景通常伴随着极高的数据吞吐量需求，并且对延迟非常敏感。在本场景下，相关推荐配置的详细介绍信息，可参见下文 [kv](#kv)。

## express_oltp

在本场景下，当前暂无变量配置推荐。

**express_oltp 场景配置项推荐值的详细介绍如下：**

|        **配置项**        |  **推荐值** | **推荐值说明** | **级别** |
|--------------------------|-------------|----------------|----------|
| [enable_record_trace_log](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/7900.enable_record_trace_log.md) | False | 禁止记录 SQL 和事务跟踪事件。| cluster |
| [enable_syslog_recycle](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/9000.enable_syslog_recycle.md) | True | 启用 syslog 自动回收可以防止日志文件填满磁盘空间。| cluster |
| [max_syslog_file_count](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/13300.max_syslog_file_count.md) | 300 | 启用 `enable_syslog_recycle` 时，应将该值设置为适当的值。300 是一个经验值。| cluster |
| [log_transport_compress_all](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/4900.log_transport_compress_all.md) | True | 在带宽有限的场景中，可以通过 RPC 压缩以少量 CPU 开销节省网络带宽。| tenant |
| [default_load_mode](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2050.default_load_mode.md) | DISABLED | 对于简单的 OLTP 工作负载，默认不使用旁路导入。| tenant |
| [direct_load_allow_fallback](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2240.direct_load_allow_fallback.md) | True | 对于简单的 OLTP 工作负载，当旁路导入失败时允许回退成普通导入方式。| tenant |
| _enable_filter_reordering | False | 针对简单的 OLTP 工作负载，禁用过滤器重排序。| tenant |
| [default_table_merge_engine](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2130.default_table_merge_engine.md) | PARTIAL_UPDATE | 使用 `partial_update` 合并引擎处理简单的 OLTP 工作负载。| tenant |

### express_oltp 场景示例

1. 在 sys 租户中执行以下语句，配置集群级配置项。

    ```sql
    ALTER SYSTEM SET enable_record_trace_log = False;
    ALTER SYSTEM SET enable_syslog_recycle = True;
    ALTER SYSTEM SET max_syslog_file_count = 300;
    ```

2. 在用户中执行以下语句，配置租户级配置项。

   * **MySQL 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET _enable_filter_reordering = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET "_enable_filter_reordering" = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ```

## complex_oltp

在本场景下，当前暂无变量配置推荐。

**complex_oltp 场景配置项推荐值的详细介绍如下：**

|        **配置项**        |  **推荐值** | **推荐值说明** | **级别** |
|--------------------------|-------------|----------------|----------|
| [enable_record_trace_log](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/7900.enable_record_trace_log.md) | False  | 禁止记录 SQL 和事务跟踪事件。| cluster |
| [large_query_threshold](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/11100.large_query_threshold.md) | 600s | 对于复杂的 OLTP 场景，一些查询将运行很长时间。| cluster |
| [enable_syslog_recycle](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/9000.enable_syslog_recycle.md) | True | 启用 syslog 自动回收可以防止日志文件填满磁盘空间。| cluster |
| [max_syslog_file_count](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/13300.max_syslog_file_count.md) | 300 | 启用 `enable_syslog_recycle` 时，应将该值设置为适当的值。300 是一个经验值。| cluster |
| [log_transport_compress_all](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/4900.log_transport_compress_all.md) | True | 在带宽有限的场景中，可以通过 RPC 压缩以少量 CPU 开销节省网络带宽。| tenant |
| [default_load_mode](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2050.default_load_mode.md) | DISABLED | 对于复杂的 OLTP 工作负载，默认不使用旁路导入。| tenant |
| [direct_load_allow_fallback](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2240.direct_load_allow_fallback.md) | True | 对于复杂的 OLTP 工作负载，当旁路导入失败时允许回退成普通导入方式。| tenant |
| _enable_filter_reordering | False | 禁用复杂 OLTP 工作负载的筛选器重新排序。| tenant |
| [default_table_merge_engine](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2130.default_table_merge_engine.md) | PARTIAL_UPDATE | 使用 `partial_update` 合并引擎处理复杂的 OLTP 工作负载。| tenant |

### complex_oltp 场景示例

1. 在 sys 租户中执行以下语句，配置集群级配置项。

    ```sql
    ALTER SYSTEM SET enable_record_trace_log = False;
    ALTER SYSTEM SET large_query_threshold = '600s';
    ALTER SYSTEM SET enable_syslog_recycle = True;
    ALTER SYSTEM SET max_syslog_file_count = 300;
    ```

2. 在用户中执行以下语句，配置租户级配置项。

   * **MySQL 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET _enable_filter_reordering = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET "_enable_filter_reordering" = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ```

## olap

**olap 场景配置项推荐值的详细介绍如下：**

|        **配置项**        |  **推荐值** | **推荐值说明** | **级别** |
|--------------------------|-------------|----------------|----------|
| [enable_record_trace_log](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/7900.enable_record_trace_log.md) | False | 关闭追踪日志可以带来更好的 AP 性能。| cluster |
| [trace_log_slow_query_watermark](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/23900.trace_log_slow_query_watermark.md) | 7d | AP 场景下无需定义慢查询。| cluster |
| [large_query_threshold](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/11100.large_query_threshold.md) | 0ms | 表示关闭大查询的检测。| cluster |
| [enable_syslog_recycle](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/9000.enable_syslog_recycle.md) | True | 启用 syslog 自动回收可以防止日志文件填满磁盘空间。| cluster |
| [max_syslog_file_count](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/13300.max_syslog_file_count.md) | 300 | 启用 `enable_syslog_recycle` 时，应将该值设置为适当的值。300 是一个经验值。| cluster |
| [default_table_store_format](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2200.default_table_store_format.md) | column | AP 默认格式指定为纯列存表。| tenant |
| _io_read_batch_size                 | 128K | 单次读取 IO 请求的最大批次大小。| tenant |
| _io_read_redundant_limit_percentage | 50 | 单次读取 IO 请求中冗余数据的最大百分比（冗余数据指批次中间必须读取但已命中缓存或被跳跃索引过滤的数据块）。| tenant |
| _io_callback_thread_count | 64 | IO 回调线程的数量。| tenant |
| [default_load_mode](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2050.default_load_mode.md) | DISABLED | 当前默认不会启用旁路导入能力，有需要使用旁路导入的场景，可以通过 Hint 指定。| tenant |
| [direct_load_allow_fallback](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2240.direct_load_allow_fallback.md) | False | 对于经典的 OLAP 工作负载，当旁路导入失败时直接报错，不允许回退成普通导入方式。| tenant |
| _nested_loop_join_enabled  | False | 对于经典的 OLAP 工作负载，禁用嵌套循环连接。| tenant |
| default_table_organization | HEAP | 表中数据行的存储顺序。对于 AP 场景，表中的数据行没有特定的顺序存储。<main id="notice" type='explain'><h4>说明</h4><p>该配置项从 V4.3.5 BP1 版本开始引入。</p></main>| tenant |
| [default_table_merge_engine](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2130.default_table_merge_engine.md) | DELETE_INSERT | 使用 `delete_insert` 合并引擎处理 OLAP 工作负载。| tenant |
| _force_subquery_unnest     | True          | 该配置项用于控制优化器尝试将子查询改写为连接形态时是否基于先验假设放弃一些改写机会。在 OLAP 模式下，将其值设置为 `True`，此时优化器将不再考虑任何先验的裁剪规则，在保证正确性的前提下，能改写的子查询都将被改写成连接形态。| tenant |
| [max_partition_num](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/5350.max_partition_num.md) | 65536 | 将 AP/HTAP 工作负载的每个表的最大分区数增加到 65536，支持按时间范围和哈希子分区进行大规模分区，这在数据仓库和实时分析场景中很常见。| tenant |

**olap 场景变量推荐值的详细介绍如下：**

| **变量** | **推荐值** | **推荐值说明** | **级别** |
|----------|------------|---------------|----------|
| [ob_query_timeout](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/8600.ob_query_timeout-global.md) | 604800000000 | 设置为 7 天。| tenant |
| [ob_trx_timeout](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/9700.ob_trx_timeout-global.md) | 604800000000 | 设置为 7 天。| tenant |
| [parallel_degree_policy](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/10300.parallel_degree_policy-global.md) | AUTO | 表示启用 Auto DOP 策略。</br>关于 Auto DOP 的详细介绍，参见 [Auto DOP](../700.reference/1000.performance-tuning-guide/500.sql-optimization/300.distributed-execution-plan/600.auto-dop.md)。| tenant |
| [parallel_min_scan_time_threshold](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/10500.parallel_min_scan_time_threshold-global.md) | 10 | 对于执行时间在 100ms+ 的查询，可以带来最佳的并行执行性能。| tenant |
| [ob_sql_work_area_percentage](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/9100.ob_sql_work_area_percentage-global.md) | 30 | 设置比较大的工作区内存可以节省内存泄漏带来的成本。| tenant |
| [collation_server](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/1600.collation_server-global.md) | utf8mb4_bin | 相较其他 collation，使用二进制 collation 可以实现 20% 的性能提升。| tenant |
| [collation_connection](../700.reference/800.configuration-items-and-system-variables/200.system-variable/300.global-system-variable/1400.collation_connection-global.md) | utf8mb4_bin | 相较其他 collation，使用二进制 collation 可以实现 20% 的性能提升。| tenant |

### olap 场景示例

1. 在 sys 租户中执行以下语句，配置集群级配置项。

    ```sql
    ALTER SYSTEM SET enable_record_trace_log = False;
    ALTER SYSTEM SET trace_log_slow_query_watermark = '7d';
    ALTER SYSTEM SET large_query_threshold = '0ms';
    ALTER SYSTEM SET enable_syslog_recycle = True;
    ALTER SYSTEM SET max_syslog_file_count = 300;
    ```

2. 在用户中执行以下语句，配置租户级配置项。

   * **MySQL 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET default_table_store_format = 'column';
     ALTER SYSTEM SET _io_read_batch_size = '128K';
     ALTER SYSTEM SET _io_read_redundant_limit_percentage = 50;
     ALTER SYSTEM SET _io_callback_thread_count = 64;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = False;
     ALTER SYSTEM SET _nested_loop_join_enabled = False;
     ALTER SYSTEM SET default_table_organization = 'HEAP';
     ALTER SYSTEM SET default_table_merge_engine = 'DELETE_INSERT';
     ALTER SYSTEM SET _force_subquery_unnest = True;
     ALTER SYSTEM SET max_partition_num = 65536;
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET default_table_store_format = 'column';
     ALTER SYSTEM SET "_io_read_batch_size" = '128K';
     ALTER SYSTEM SET "_io_read_redundant_limit_percentage" = 50;
     ALTER SYSTEM SET "_io_callback_thread_count" = 64;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = False;
     ALTER SYSTEM SET "_nested_loop_join_enabled" = False;
     ALTER SYSTEM SET default_table_organization = 'HEAP';
     ALTER SYSTEM SET default_table_merge_engine = 'DELETE_INSERT';
     ALTER SYSTEM SET "_force_subquery_unnest" = True;
     ALTER SYSTEM SET max_partition_num = 65536;
     ```

3. 在用户中执行以下语句，配置租户级变量。

   * **MySQL 模式租户的配置示例：**

     ```sql
     SET GLOBAL ob_query_timeout = 604800000000;
     SET GLOBAL ob_trx_timeout = 604800000000;
     SET GLOBAL parallel_degree_policy = AUTO;
     SET GLOBAL parallel_min_scan_time_threshold = 10;
     SET GLOBAL ob_sql_work_area_percentage = 30;
     SET GLOBAL collation_server = utf8mb4_bin;
     SET GLOBAL collation_connection = utf8mb4_bin;
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     SET GLOBAL ob_query_timeout = 604800000000;
     SET GLOBAL ob_trx_timeout = 604800000000;
     SET GLOBAL parallel_degree_policy = AUTO;
     SET GLOBAL parallel_min_scan_time_threshold = 10;
     SET GLOBAL ob_sql_work_area_percentage = 30;
     ```

## htap

在本场景下，当前暂无变量配置推荐。

**htap 场景配置项推荐值的详细介绍如下：**

|        **配置项**        |  **推荐值** | **推荐值说明** | **级别** |
|--------------------------|-------------|----------------|----------|
| [large_query_threshold](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/11100.large_query_threshold.md) | 600s | HTAP 工作负载中存在 AP 查询，我们也需要它快速运行。| cluster |
| [enable_record_trace_log](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/7900.enable_record_trace_log.md) | False | 关闭追踪日志可以带来更好的 AP 性能。| cluster |
| [enable_syslog_recycle](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/9000.enable_syslog_recycle.md) | True | 启用 syslog 自动回收可以防止日志文件填满磁盘空间。| cluster |
| [max_syslog_file_count](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/13300.max_syslog_file_count.md) | 300 | 启用 `enable_syslog_recycle` 时，应将该值设置为适当的值。300 是一个经验值。| cluster |
| [log_transport_compress_all](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/4900.log_transport_compress_all.md) | True | 在带宽有限的场景中，可以通过 RPC 压缩以少量 CPU 开销节省网络带宽。| tenant |
| [default_load_mode](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2050.default_load_mode.md) | DISABLED | 对于经典的 HTAP 工作负载，默认不使用旁路导入。| tenant |
| [direct_load_allow_fallback](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2240.direct_load_allow_fallback.md) | True | 对于经典的 HTAP 工作负载，当旁路导入失败时允许回退成普通导入方式。| tenant |
| [default_table_merge_engine](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2130.default_table_merge_engine.md) | PARTIAL_UPDATE | 使用 `partial_update` 合并引擎处理 HTAP 工作负载。| tenant |
| [max_partition_num](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/5350.max_partition_num.md) | 65536 | 将 AP/HTAP 工作负载的每个表的最大分区数增加到 65536，支持按时间范围和哈希子分区进行大规模分区，这在数据仓库和实时分析场景中很常见。| tenant |

### htap 场景示例

1. 在 sys 租户中执行以下语句，配置集群级配置项。

    ```sql
    ALTER SYSTEM SET large_query_threshold = '600s';
    ALTER SYSTEM SET enable_record_trace_log = False;
    ALTER SYSTEM SET enable_syslog_recycle = True;
    ALTER SYSTEM SET max_syslog_file_count = 300;
    ```

2. 在用户中执行以下语句，配置租户级配置项。

   * **MySQL 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ALTER SYSTEM SET max_partition_num = 65536;
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET default_load_mode = 'DISABLED';
     ALTER SYSTEM SET direct_load_allow_fallback = True;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ALTER SYSTEM SET max_partition_num = 65536;
     ```

## kv

在本场景下，当前暂无变量配置推荐。

**kv 场景配置项推荐值的详细介绍如下：**

|        **配置项**        |  **推荐值** | **推荐值说明** | **级别** |
|--------------------------|-------------|----------------|----------|
| [enable_record_trace_log](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/7900.enable_record_trace_log.md) | False | 关闭追踪日志可以带来更好的 AP 性能。| cluster |
| [large_query_threshold](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/11100.large_query_threshold.md) | 0ms | 禁用 KV 模式的大型查询检测。| cluster |
| [enable_syslog_recycle](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/9000.enable_syslog_recycle.md)| True | 启用 syslog 自动回收可以防止日志文件填满磁盘空间。| cluster |
| [max_syslog_file_count](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/13300.max_syslog_file_count.md) | 300 | 启用 `enable_syslog_recycle` 时，应将该值设置为适当的值。300 是一个经验值。| cluster |
| [log_transport_compress_all](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/4900.log_transport_compress_all.md) | True | 在带宽有限的场景中，可以通过 RPC 压缩以少量 CPU 开销节省网络带宽。| tenant |
| _enable_filter_reordering | False | KV 模式禁用过滤器重排序。| tenant |
| [default_table_merge_engine](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2130.default_table_merge_engine.md) | PARTIAL_UPDATE | KV 模式下使用 `partial_update` 合并引擎。| tenant |
| [enable_auto_split](../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/400.tenant-level-configuration-items/2350.enable_auto_split.md) | True | KV 模式下开启自动分区功能。| tenant |

### kv 场景示例

1. 在 sys 租户中执行以下语句，配置集群级配置项。

    ```sql
    ALTER SYSTEM SET enable_record_trace_log = False;
    ALTER SYSTEM SET large_query_threshold = '0ms';
    ALTER SYSTEM SET enable_syslog_recycle = True;
    ALTER SYSTEM SET max_syslog_file_count = 300;
    ```

2. 在用户中执行以下语句，配置租户级配置项。

   * **MySQL 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET _enable_filter_reordering = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ALTER SYSTEM SET enable_auto_split = True;
     ```

   * **Oracle 模式租户的配置示例：**

     ```sql
     ALTER SYSTEM SET log_transport_compress_all = True;
     ALTER SYSTEM SET "_enable_filter_reordering" = False;
     ALTER SYSTEM SET default_table_merge_engine = 'PARTIAL_UPDATE';
     ALTER SYSTEM SET enable_auto_split = True;
     ```

## 查看配置项和变量

* 可以使用 `SHOW PARAMETERS LIKE 'parameter_name';` 语句查询配置项信息。

  示例如下：

  ```sql
  SHOW PARAMETERS LIKE 'enable_syslog_recycle';
  ```

* 可以使用下面语句查询变量信息。

  * MySQL 模式：可以使用 `SHOW [GLOBAL] VARIABLES LIKE 'variables_name';` 语句查询。
  
    示例如下：

    ```sql
    SHOW VARIABLES LIKE 'ob_query_timeout';
    ```

    ```sql
    SHOW GLOBAL VARIABLES LIKE 'ob_query_timeout';
    ```

  * Oracle 模式：可以使用视图 `SYS.TENANT_VIRTUAL_SESSION_VARIABLE`/`SYS.TENANT_VIRTUAL_GLOBAL_VARIABLE` 查询变量信息。
  
    示例如下：

    ```sql
    SELECT * FROM SYS.TENANT_VIRTUAL_SESSION_VARIABLE WHERE VARIABLE_NAME = 'ob_query_timeout';
    ```

    ```sql
    SELECT * FROM SYS.TENANT_VIRTUAL_GLOBAL_VARIABLE WHERE VARIABLE_NAME = 'ob_query_timeout';
    ```

## 相关文档

* 有关配置项和变量的详细介绍，参见 [配置项和系统变量概述](../700.reference/800.configuration-items-and-system-variables/000.configuration-items-and-system-variables-overview.md)。
* 有关配置项的设置方法，参见 [设置参数](../700.reference/200.system-management/200.configuration-management/200.set-parameters.md)。
* 有关变量的设置方法，参见 [设置变量](../700.reference/200.system-management/200.configuration-management/300.set-variables.md)。
