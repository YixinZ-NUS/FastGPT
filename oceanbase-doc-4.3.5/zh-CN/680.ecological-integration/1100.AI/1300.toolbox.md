|description|  |
|---|---|
|keywords| |
|dir-name|Toolbox|
|dir-name-en|Toolbox|

# 通过 Google GenAI Toolbox 构建自己的 OceanBase MCP Server

[MCP（Model Context Protocol）](https://modelcontextprotocol.io/introduction) 是 Anthropic 公司于 2024 年 11 月推出并开源，旨在实现大语言模型与外部工具或数据源交互的协议。通过 MCP，用户不需要将大模型的输出手动复制执行，大模型可以直接指挥工具执行相应的动作（Action）。

[Google GenAI Toolbox for Databases](https://github.com/googleapis/genai-toolbox) 是一个开源的工具箱。它通过处理连接池、身份验证等复杂问题，让您能够更轻松、更快速、更安全地开发工具。

本文将展示如何使用 Google GenAI Toolbox 无需编程构建 OceanBase MCP 服务器。

## 前提条件

* 您已完成部署 OceanBase 数据库并且创建了 MySQL 模式用户租户。创建用户租户的详细信息，参见 [创建租户](../../600.manage/200.tenant-management/600.common-tenant-operations/200.manage-create-tenant.md)。

* 根据所用的操作系统，安装 [Git](https://git-scm.com//downloads)。

* 确保您的系统支持运行二进制文件（Linux、macOS 或 Windows）。

## 步骤一：获取数据库连接信息

你可以使用以下命令快速部署一个独立的 OceanBase 数据库进行测试：

```bash
# 部署一个迷你独立实例
docker run -p 2881:2881 --name oceanbase-ce -e MODE=mini -d oceanbase/oceanbase-ce

# 连接到 OceanBase 数据库实例
docker exec -it oceanbase-ce obclient -h127.0.0.1 -P2881 -uroot # 连接到 sys 租户的 root 用户
```

## 步骤二：下载 Google GenAI Toolbox 并开始使用

### 下载 Toolbox 二进制文件

下载最新版本的 Toolbox 二进制文件：

```bash
export OS="linux/amd64" # 选择 linux/amd64, darwin/arm64, darwin/amd64, 或 windows/amd64 之一
export VERSION="0.11.0"
curl -O https://storage.googleapis.com/genai-toolbox/v$VERSION/$OS/toolbox
```

使二进制文件可执行：

```bash
chmod +x toolbox
```

### 创建配置文件

创建一个 `tools.yaml` 文件并写入以下内容。请将连接信息替换为您的 OceanBase 地址。此示例配置展示了如何使用 Toolbox 通过 MCP 工具获取 ASH 报告和集群信息。你可以自定义自己的工具。

```yaml
sources:
  oceanbase:
    kind: oceanbase
    host: 127.0.0.1
    port: 2881
    database: oceanbase
    user: root
    password: *****
    queryTimeout: 60s
tools:
  get-ash-report:
    kind: oceanbase-sql
    source: oceanbase
    description: 获取 ASH 报告
    parameters:
      - name: start_time
        type: string
        description: ASH 报告的开始时间
      - name: end_time
        type: string
        description: ASH 报告的结束时间
      - name: tenant_id
        type: string
        description: ASH 报告的租户 ID
    statement: CALL DBMS_WORKLOAD_REPOSITORY.ASH_REPORT(?,?, NULL, NULL, NULL, 'TEXT', NULL, NULL, ?);
  get-all-server-nodes:
    kind: oceanbase-sql
    source: oceanbase
    description: 获取所有服务器节点
    statement: select * from DBA_OB_SERVERS;
toolsets:
  my_first_toolset:
    - get-ash-report
```

### 启动 Toolbox

启动 Toolbox。你应该看到以下输出：

```bash
./toolbox --tools-file tools.yaml
2025-08-28T10:37:49.776637+08:00 INFO "Initialized 1 sources."
2025-08-28T10:37:49.777513+08:00 INFO "Initialized 0 authServices."
2025-08-28T10:37:49.777586+08:00 INFO "Initialized 1 tools."
2025-08-28T10:37:49.777627+08:00 INFO "Initialized 2 toolsets."
2025-08-28T10:37:49.778334+08:00 INFO "Server ready to serve!"
```

## 步骤三：使用 MCP Inspector 进行测试（可选）

Inspector 是一个用于测试和调试 MCP 服务器的交互式开发工具。

Inspector 可以直接通过 npx 运行，无需安装：

```bash
npx @modelcontextprotocol/inspector node build/index.js
```

### 配置连接

1. 打开上面显示的链接并填写连接信息。
2. 对于传输类型选择 SSE。
3. 对于 URL 输入 `http://127.0.0.1:5000/mcp/sse`。
4. 点击连接按钮。
5. 在工具选项卡中点击列出工具，尝试 `get-all-server-nodes` 工具，你应该看到如下输出：

```json
{
  "BLOCK_MIGRATE_IN_TIME": null,
  "BUILD_VERSION": "4.3.5.3_103000102025071821-4b8c513fcc2194bad9eb2f93c789040f6dd01f11(Jul 18 2025 21:11:10)",
  "CREATE_TIME": "2025-07-23T17:49:40.554851Z",
  "ID": 1,
  "LAST_OFFLINE_TIME": null,
  "MODIFY_TIME": "2025-07-23T17:52:49.259607Z",
  "SQL_PORT": 2881,
  "START_SERVICE_TIME": "2025-07-23T17:52:47.354459Z",
  "STATUS": "ACTIVE",
  "STOP_TIME": null,
  "SVR_IP": "x.x.x.x",
  "SVR_PORT": 2881,
  "WITH_ROOTSERVER": "YES",
  "ZONE": "zone1"
}
```

## 步骤四：与您的 MCP 客户端集成

测试成功后，你现在拥有了自己的 MCP 服务器，无需编写任何代码。你可以集成任何 MCP 客户端与大语言模型一起工作，让你工作更高效。

### 支持的 MCP 客户端

* [Continue](https://continue.dev) - IDE 插件，支持 Visual Studio Code 和 IntelliJ IDEA
* [Claude Desktop](https://claude.ai/download) - Anthropic 的桌面应用
* [Cline](https://cline.sh) - 命令行 AI 助手
* 其他支持 MCP 协议的客户端

### 后续步骤

* 自定义工具配置，添加更多 OceanBase 相关的 SQL 查询
* 集成到工作流程中，提高数据库管理和分析效率。
* 探索更多 MCP 工具和功能。