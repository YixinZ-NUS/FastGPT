|description||
|---|---|
|keywords||
|dir-name|WebLogic|
|dir-name-en|WebLogic|
|tenant-type|Oracle Mode, MySQL Mode|

# 通过 WebLogic 连接 OceanBase 数据库

WebLogic 是 Oracle 公司提供的 Java EE（Jakarta EE）应用服务器，用于部署和运行企业级 Java 应用。它广泛应用于银行、证券、保险等金融机构，支持高并发、分布式架构和集群管理，常用于大型业务系统，如核心银行系统、证券交易系统等。

## 前提条件

* 请确保已安装 Oracle JDK（WebLogic 不支持 OpenJDK）
* 请确保已获取并安装 WebLogic Server 14.1.1 或更高版本
* 请确保待连接的 OBServer 节点 IP 与 WebLogic 所在机器保持网络连通
* 您已创建 OceanBase 数据库 V4.3.5 及以上版本并创建了租户

## 操作步骤

### 步骤一：下载并准备安装文件

1. 访问 [Oracle WebLogic Server 下载页面](https://www.oracle.com/technetwork/middleware/weblogic/downloads/index.html)，下载 Generic Installer（`fmw_14.1.1.0.0_wls.jar`）

2. 创建用于安装和运行 WebLogic 的系统用户（需要使用 root 权限执行）：

   ```bash
   # 切换到 root 用户后执行以下命令
   groupadd weblogic
   useradd -g weblogic weblogic
   passwd weblogic
   # 输入两次用户密码完成设置
   ```

3. 将下载的 `fmw_14.1.1.0.0_wls.jar` 上传至服务器 `/home/weblogic/` 目录，并设置权限：

   ```bash
   chown weblogic:weblogic /home/weblogic/fmw_14.1.1.0.0_wls.jar
   ```

4. 使用 root 用户创建目录 `/opt/weblogic` 并授权：

   ```bash
   mkdir -p /opt/weblogic/oraInventory
   mkdir -p /opt/weblogic/Oracle
   mkdir -p /opt/weblogic/Oracle/Middleware
   chmod 777 /opt/weblogic
   chown -R weblogic:weblogic /opt/weblogic
   ```

5. 创建 oraInst.loc 文件：

   ```bash
   cd /opt/weblogic
   echo "inventory_loc=/opt/weblogic/oraInventory
   inst_group=weblogic" > oraInst.loc
   ```

6. 创建 wls.rsp 响应文件：

   ```bash
   echo "[ENGINE]
   Response File Version=1.0.0.0.0
   [GENERIC]
   ORACLE_HOME=/opt/weblogic/Oracle/Middleware
   INSTALL_TYPE=WebLogic Server" > wls.rsp
   ```

### 步骤二：安装 WebLogic

1. 切换到 weblogic 用户执行安装：

   ```bash
   su - weblogic
   cd /home/weblogic
   java -jar fmw_14.1.1.0.0_wls.jar -silent -responseFile /opt/weblogic/wls.rsp -invPtrLoc /opt/weblogic/oraInst.loc
   ```

2. 安装完成后，创建 WebLogic 域：

   ```bash
   source /opt/weblogic/Oracle/Middleware/wlserver/server/bin/setWLSEnv.sh
   mkdir -p /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain
   cd /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain
   $JAVA_HOME/bin/java $JAVA_OPTIONS -Xmx1024m -XX:MaxPermSize=2048m weblogic.Server
   ```

3. 上传 OceanBase 客户端到域目录：

   ```bash
   # 将 oceanbase-client 上传到
   /opt/weblogic/Oracle/Middleware/user_projects/domains/hnDoMain/lib/
   ```

### 步骤三：配置 OceanBase 数据源

1. 登录 WebLogic 管理控制台（默认地址：`http://<hostname>:7001/console`）

2. 在左侧导航栏中，选择 **服务** > **数据源**

3. 点击 **新建** > **一般数据源**

4. 填写数据源信息：

   * 名称：`obmysql`
   * JNDI 名称：`JNDI/obmysql`
   * 数据库类型：`其他`

5. 配置数据库连接：

   * 驱动程序类名称：`com.oceanbase.jdbc.Driver`
   * URL：`jdbc:oceanbase://<host>:<port>/<database>`
   * 用户名：`<username>`
   * 密码：`<password>`

6. 点击 **测试配置** 验证连接

7. 点击 **完成** 保存配置

## 更多信息

如果在通过 WebLogic 连接 OceanBase 数据库的过程中遇到问题，建议您查阅 [Oracle WebLogic 官方文档](https://www.oracle.com/java/weblogic/) 或联系 OceanBase 技术支持。
