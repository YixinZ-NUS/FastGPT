| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |
|machine-translation||

# UPDATE_PLAN_DIRECTIVE

`UPDATE_PLAN_DIRECTIVE` 过程用于更新资源计划指令。

  <main id="notice" >
    <h4>功能适用性</h4>
    <p>该内容仅适用于 OceanBase 数据库企业版。OceanBase 数据库社区版仅提供 MySQL 模式。</p>
  </main>

## 语法

```sql
DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE (
    PLAN                             IN VARCHAR2, 
    GROUP_OR_SUBPLAN                 IN VARCHAR2, 
    NEW_COMMENT                      IN VARCHAR2 DEFAULT NULL, 
    NEW_MGMT_P1                      IN INT   DEFAULT NULL,
    NEW_UTILIZATION_LIMIT            IN INT   DEFAULT NULL,
    NEW_MIN_IOPS                     IN INT   DEFAULT NULL, 
    NEW_MAX_IOPS                     IN INT   DEFAULT NULL,
    NEW_WEIGHT_IOPS                  IN INT   DEFAULT NULL,
    NEW_MAX_NET_BANDWIDTH            IN INT   DEFAULT NULL,
    NEW_NET_BANDWIDTH_WEIGHT         IN INT   DEFAULT NULL);
```

## 参数说明

|        参数        |           说明         |
|-------------------|-------------------------|
| PLAN              | 资源计划的名称。  |
| GROUP_OR_SUBPLAN  | 资源使用组或子计划的名称。  |
| NEW_COMMENT       | 对计划指令的注释。  |
| NEW_MGMT_P1       | 指定系统满负载情况下，相对可用的最大 CPU 占比。 |
| NEW_UTILIZATION_LIMIT | CPU 资源使用比例上限。 该参数的取值范围为 \[0, 100\]。`100` 表示最大可使用租户全部 CPU 资源。如果取值为 `20`，则表示最大可使用租户 20% 的 CPU 资源。 |
| NEW_MIN_IOPS      | 指定出现 IO 争用时，资源组预留的 IOPS 资源，总和不超过 100。|
| NEW_MAX_IOPS      | 指定资源组最大可使用的 IOPS 资源，总和可以超过 100。|
| NEW_WEIGHT_IOPS   | 指定 IOPS 的权重值，总和可以超过 100。|
| NEW_MAX_NET_BANDWIDTH| 指定资源组最大可使用的网络带宽，总和可以超过 100。|
| NEW_NET_BANDWIDTH_WEIGHT| 指定网络带宽的权重值，总和可以超过 100。 |

## 使用说明

如果未指定 `UPDATE_PLAN_DIRECTIVE` 的参数，则参数值在数据字典中保持不变。

要清除（变成零或无效）资源计划指令中的任何数值参数，请使用 `UPDATE_PLAN_DIRECTIVE` 过程将其设置为 -1。

## 示例


* 更新资源计划 `DAY` 所绑定的资源组 `group1` 的计划指令的注释。

  ```shell
  obclient [SYS]> delimiter //
  ```

  ```shell
  obclient [SYS]> BEGIN DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE('DAY','group1','中间级别组');
  END ;//
  ```

  ```shell
  obclient [SYS]> delimiter ;
  ```

* 更新资源计划 `plan_a` 所绑定的资源组 `big_group` 中 CPU、IOPS 以及网络带宽等资源的资源计划内容。

  ```shell
  obclient [SYS]> delimiter //
  ```

  ```shell
  obclient [SYS]> BEGIN DBMS_RESOURCE_MANAGER.UPDATE_PLAN_DIRECTIVE(
    PLAN => 'plan_a',
    GROUP_OR_SUBPLAN => 'big_group',
    NEW_COMMENT => 'new',
    NEW_MGMT_P1 => 40,
    NEW_UTILIZATION_LIMIT => 60,
    NEW_MIN_IOPS => 20,
    NEW_MAX_IOPS  => 100,
    NEW_WEIGHT_IOPS  => 10,
    NEW_MAX_NET_BANDWIDTH => 60,
    NEW_NET_BANDWIDTH_WEIGHT => 60);
    END ;//
  ```

  ```shell
  obclient [SYS]> delimiter ;
  ```

## 相关文档

更新资源计划指令的详细操作，参见 [更新资源管理计划内容](../../../../../600.manage/200.tenant-management/600.common-tenant-operations/300.resource-isolation/200.resource-isolation-of-oracle-mode/400.update-a-plan-directive-of-oracle-mode.md)。
