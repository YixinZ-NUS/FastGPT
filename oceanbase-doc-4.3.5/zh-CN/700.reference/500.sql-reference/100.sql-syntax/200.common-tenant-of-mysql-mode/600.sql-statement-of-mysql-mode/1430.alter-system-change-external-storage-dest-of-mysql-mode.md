| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | MySQL Mode      |
|machine-translation||

# ALTER/CHANGE/MODIFY EXTERNAL_STORAGE_DEST

## 描述

该语句用于变更本租户备份或归档路径的 `access_id` 和 `access_key` 等密钥信息。

## 使用限制及注意事项

* 对于 V4.3.5 版本，从 V4.3.5 BP2 版本开始支持该语句。

* 仅用户租户可以执行该语句，系统租户（sys 租户）不能执行该语句。

## 权限要求

执行该语句的用户需要拥有 `ALTER SYSTEM` 权限。有关 OceanBase 数据库权限的详细介绍，参见 [MySQL 模式下的权限分类](../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/200.permission-of-mysql-mode/100.permission-classification-of-mysql.md)。

## 语法

```sql
ALTER SYSTEM {ALTER|CHANGE|MODIFY} EXTERNAL_STORAGE_DEST PATH [=] 'path' SET ACCESS_INFO = 'access_id=new_access_id&access_key=new_access_key';
```

## 参数说明

|          参数                                     |         描述                                      |
|---------------------------------------------------|--------------------------------------------------|
| path                                              | 指定待变更密钥信息的备份路径或归档路径。要求路径必须为当前租户已经设置的备份路径或归档路径，且必须为对象存储路径，同时路径中需要包含 `host` 信息。以 OSS 为例，该路径的格式如下：`oss://oceanbase-test-bucket/backup/databackup?host=***`。 |
| access_id=new_access_id&access_key=new_access_key | 指定变更后的新的 `access_id` 和 `access_key` 信息。`access_id` 与 `access_key` 需要同时填写。|

## 示例

* 变更归档路径的 `access_id` 和 `access_key` 信息

  * OSS

    ```shell
    obclient> ALTER SYSTEM MODIFY EXTERNAL_STORAGE_DEST PATH='oss://oceanbase-test-bucket/backup/archive?host=****.aliyun-inc.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

  * S3

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/archive?host=s3.<region>.amazonaws.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

  * 兼容 S3 协议的对象存储（OBS/GCS/COS）

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/archive?host=obs.****.myhuaweicloud.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/archive?host=https://storage.googleapis.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/archive?host=cos.ap-xxxx.myqcloud.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

* 变更备份路径的 `access_id` 和 `access_key` 信息

  * OSS

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='oss://oceanbase-test-bucket/backup/data?host=****.aliyun-inc.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

  * S3

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/data?host=s3.<region>.amazonaws.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

  * 兼容 S3 协议的对象存储（OBS/GCS/COS）

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/data?host=obs.****.myhuaweicloud.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test-bucket/backup/data?host=https://storage.googleapis.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

    ```shell
    obclient> ALTER SYSTEM CHANGE EXTERNAL_STORAGE_DEST PATH='s3://oceanbase-test/backup/data?host=cos.ap-xxxx.myqcloud.com' SET ACCESS_INFO = 'access_id=******&access_key=******';
    ```

## 相关文档

[更新对象存储的密钥信息](../../../../../600.manage/600.backup-and-recovery/450.change-sk-and-ak-for-the-backup-path-or-logarchive-path.md)