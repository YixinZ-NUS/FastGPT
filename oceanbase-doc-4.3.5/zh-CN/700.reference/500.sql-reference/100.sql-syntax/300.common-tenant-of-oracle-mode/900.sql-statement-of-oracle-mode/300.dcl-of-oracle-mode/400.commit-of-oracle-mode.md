| Description   |                 |
|---------------|-----------------|
| keywords      |                 |
| dir-name      |                 |
| dir-name-en   |                 |
| tenant-type   | Oracle Mode     |
|machine-translation||

# COMMIT

## 描述

使用该语句结束当前事务并使事务中执行的所有更改永久生效。此语句还会清除事务中的所有保存点并释放事务锁。

## 使用限制及注意事项

在您提交事务之前，您可以通过查询已修改的表查看在该事务中所做的任何更改，但其他用户无法看到这些更改。提交事务后，变更将对在提交后执行的其他用户的语句可见。

您可以使用 [`ROLLBACK`](3000.rollback-of-oracle-mode.md) 语句回滚（撤销）事务中所作的任何更改。

OceanBase 数据库在以下情况下会自动执行隐式 COMMIT：

- 在任何符合语法的 数据定义语言（DDL）语句之前执行，即使该语句导致错误；
- 在任何无误完成的 数据定义语言（DDL）语句之后。

您还可以使用此语句：

- 手动提交处于不确定状态的分布式事务；
- 终止由 SET TRANSACTION 语句开始的只读事务。

OceanBase  建议在应用程序中显式地使用 `COMMIT` 或 `ROLLBACK` 语句结束每个事务，包括最后一个事务，然后再断开与 OceanBase  数据库的连接。如果您没有显式提交事务，而程序又异常终止，则最后未提交的事务将自动被回滚。

大多数 OceanBase 工具和实用程序的正常退出操作将导致当前事务被提交。而 OceanBase 预编译器程序的正常退出操作不会提交事务，而是依赖 OceanBase 数据库回滚当前事务。

## 权限要求

执行 `COMMIT` 语句，无需授权。有关 OceanBase 数据库权限的详细介绍，请参见 [Oracle 模式下的权限分类](../../../../../../600.manage/500.security-and-permissions/300.access-control/200.user-and-permission/300.permission-of-oracle-mode/000.permission-classification-of-oracle-mode.md)。

## 语法

```sql
COMMIT [ WORK ] [ COMMENT 'string' ];
```

## 参数解释

|   参数    |                                                                                                    描述                                                                                                     |
|---------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| WORK    | 为了 SQL 标准兼容性而提供的参数，为可选项。语句 `COMMIT;` 和 `COMMIT WORK;` 是等价的。                                                                                                                                               |
| COMMENT | 提交当前事务并为其关联注释。 此注释可以帮助您诊断分布式事务的故障。 <br>**说明**  如果网络或机器故障阻止此分布式事务正确提交，则 OceanBase 数据库会将注释与事务 ID 一起存储在数据字典中。 注释指示发生故障的应用程序，并提供联系提交事务的数据库管理员的信息。 |

## 示例

* 首先创建表 `tbl1`：

  ```shell
  obclient> CREATE TABLE tbl1 (
      id INT PRIMARY KEY,
      name VARCHAR(50),
      value INT
  );
  Query OK, 0 rows affected
  ```

* 向表 `tbl1` 中插入一行数据并提交此更改：

  ```shell
  obclient> INSERT INTO tbl1 VALUES (1, 'a', 10);
  Query OK, 1 row affected
  obclient> COMMIT;
  Query OK, 0 rows affected
  ```

* 提交当前事务并为其关联注释：

  ```shell
  obclient> COMMIT COMMENT 'Transaction code 001 in question, Please contact Zhang XX';
  Query OK, 0 rows affected
  ```