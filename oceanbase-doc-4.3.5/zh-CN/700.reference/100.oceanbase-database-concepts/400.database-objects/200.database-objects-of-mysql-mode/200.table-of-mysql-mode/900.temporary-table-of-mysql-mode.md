|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# 临时表

OceanBase 数据库 MySQL 模式临时表是一种会话级别的特殊表，主要用于临时存储中间数据。不同 Session 可以创建同名临时表，临时表可以和现有的普通表重名，但是不能基于临时表创建视图。当同时存在同名的临时表和普通表时，`SHOW CREATET TABLE`、`DESC`、DML 等操作都执行于临时表，此时普通表被隐藏。

<main id="notice" type='notice'>
  <h4>注意</h4>
  <p><ul><li>自 OceanBase 数据库 V4.1.0 BP4 版本起，MySQL 模式下已禁用临时表功能。</li><li>自 OceanBase 数据库 V4.3.5 BP4 版本起，MySQL 模式下支持临时表功能。</li></ul></p>
</main>

## 使用限制

* 临时表路由：由于临时表需要和普通表一样支持负载均衡，默认情况下不能将临时表绑定在某一台机器上。可以考虑将负载均衡关掉使用。
* OceanBase 数据库在可串行化隔离级别（Serializable）下，不支持对同一事务内创建的临时表执行写入操作。
* 当本 Session 存在与普通表同名的临时表时，不建议在本 Session 使用 Database 级别统计信息收集功能，结果可能会不符合预期。
* 临时表通过后台逻辑进行清理，为了避免其 DDL 对业务造成明显影响，其清理速度受到限制。因此大量使用临时表的场景推荐及时手动删除。
* DBLink 访问不到临时表。
* 通过 ODP 连接 OBServer 时，需要手动调整 [server_protocal](https://www.oceanbase.com/docs/common-odp-doc-cn-1000000003575488)、[client_session_id_version](https://www.oceanbase.com/docs/common-odp-doc-cn-1000000003575403)、以及 [proxy_id](https://www.oceanbase.com/docs/common-odp-doc-cn-1000000003575542) 参数。

  具体操作如下：

  * 执行如下命令修改 OBProxy 的通信协议配置。

    ```sql
    ALTER proxyconfig SET server_protocol = 'OceanBase 2.0';
    ```

  * 执行如下命令将生成客户端会话 ID（Client Session ID）的算法设置到版本 2。

    ```sql
    ALTER proxyconfig SET client_session_id_version = 2;
    ```

  * 执行如下命令将 ODP 的 ID 修改为 1，不同 ODP 需要设置不一样的数字以保障生成的 Client Session ID 不会发生冲突。

    ```sql
    ALTER proxyconfig SET proxy_id = 1;
    ```

## 相关文档

* [创建表](../../../../300.database-object-management/100.manage-object-of-mysql-mode/200.manage-tables-of-mysql-mode/200.create-a-table-for-mysql-tenant-of-mysql-mode.md)
* [CREATE TABLE](../../../../500.sql-reference/100.sql-syntax/200.common-tenant-of-mysql-mode/600.sql-statement-of-mysql-mode/2600.create-table-of-mysql-mode.md)