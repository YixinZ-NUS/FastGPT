|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|

# 修改分区级热点缓存策略

本文将向您介绍如何使用 SQL 语句修改分区级热点缓存策略（`STORAGE_CACHE_POLICY`）。

## 注意事项

在共享存储模式下，才可以修改分区级的热点缓存策略。

## 修改分区级别的热点缓存策略

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>对于 OceanBase 数据库 V4.3.5 版本，从 V4.3.5 BP2 版本开始在共享存储模式下，支持修改分区级热点缓存策略。</p>
</main>

分区表创建成功后，可以使用 `ALTER TABLE` 语句在增加分区时指定 `STORAGE_CACHE_POLICY` 和修改分区 `STORAGE_CACHE_POLICY`，语法格式如下：

* 增加分区时指定 `STORAGE_CACHE_POLICY`：

    ```sql
    ALTER TABLE table_name
        ADD PARTITION (partition_list [STORAGE_CACHE_POLICY = {"hot" | "auto" | "none"}]);
    ```

* 修改分区 `STORAGE_CACHE_POLICY`：

    ```sql
    ALTER TABLE table_name
        ALTER PARTITION (partition_list [STORAGE_CACHE_POLICY = {"hot" | "auto" | "none"}]);
    ```

### 相关参数说明

分区级的 `STORAGE_CACHE_POLICY` 为可选项，取值如下：

* `hot`：表示指定分区的所有数据都为热数据，在缓存盘空间足够的情况下，分区下所有数据将会缓存到本地缓存盘。
* `auto`：表示指定分区的热数据为系统自动识别。
* `none`：默认值，表示该分区的热点缓存策略跟随上一级的 `STORAGE_CACHE_POLICY` 取值。

更多有关修改分区表的详细介绍，参见 [添加分区](../300.manage-partitions-of-mysql-mode/400.add-a-partition-of-mysql-mode.md) 和 [修改分区规则](../300.manage-partitions-of-mysql-mode/300.modify-partition-rules-of-mysql-mode.md)。

## 示例

* 向表 `tbl1` 中新增分区 `p2`，分区 `p2` 中需要缓存到本地盘的热数据由系统自动识别。

    ```sql
    ALTER TABLE tbl1 ADD PARTITION (PARTITION p2 VALUES LESS THAN(300) STORAGE_CACHE_POLICY = "auto");
    ```

* 修改表 `tbl1` 中已有的一级分区 `p1` 中的数据为热数据。

    ```sql
    ALTER TABLE tbl1 ALTER PARTITION p1 STORAGE_CACHE_POLICY = "hot";
    ```

* 修改表 `tbl2` 中二级分区 `sp3` 中需要缓存到本地盘的数据由系统自动识别。

    ```sql
    ALTER TABLE tbl2 ALTER SUBPARTITION sp3 STORAGE_CACHE_POLICY = "auto";
    ```

## 相关文档

* [自定义热点缓存策略概述](100.customize-hotspot-cache-overview-of-mysql-mode.md)
* [创建表级热点缓存策略](200.create-table-level-storage-cache-policy-of-mysql-mode.md)
* [修改表级热点缓存策略](400.modify-table-level-storage-cache-policy-of-mysql-mode.md)
* [ALTER TABLE](../../../500.sql-reference/100.sql-syntax/200.common-tenant-of-mysql-mode/600.sql-statement-of-mysql-mode/1600.alter-table-of-mysql-mode.md)
* [自定义热点缓存策略运维指南](600.customize-hotspot-cache-operations-of-mysql-mode.md)