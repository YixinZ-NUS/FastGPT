|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# oceanbase.CDB_OB_SERVER_SPACE_USAGE

<main id="notice" type='explain'>
 <h4>说明</h4>
 <p>该视图从 V4.3.4 版本开始引入。</p>
</main>

## 功能描述

视图 `CDB_OB_SERVER_SPACE_USAGE` 用于监控各租户在各个节点存储空间使用的详细信息。

## 字段说明

| **字段名称** | **类型**  | **是否可以为 NULL** | **描述**                               |
|------------|-------------|---------------------|----------------------------------------|
| TENANT_ID   | varchar(128)  | NO   | 租户 ID    |
| TENANT_NAME | varchar(128)  | NO   | 租户名     |
| SERVER_IP   | varchar(46)   | NO   | 包含租户 Uint 的节点 IP      |
| SERVER_PORT | bigint(20)    | NO   | 包含租户 Uint 的节点 PORT     |
| SPACE_TYPE  | varchar(9)    | NO   | 类型可分为：<ul><li>Table Data：所有主表所有分区的数据，包含 Lob 分区</li><li>Index Data：所有索引表所有分区的数据</li><li>Meta Data：所有元数据 </li><li>Tmp Data：临时文件 </li><li>clog Data：节点上的 clog 总大小 </li><li>slog Data：节点上的 slog 总大小，共享存储（SS）模式下没有该项 </li></ul><main id="notice" type='explain'><h4>说明</h4><ul><li>无共享（Shared-Nothing，SN）模式下统计节点所有数据。 </li><li>共享存储（Shared-Storage，SS）模式下仅统计节点私有数据。 </li></ul></main>     |
| DATA_BYTES  | decimal(42,0) | NO   | 数据内容大小，单位为字节     |
| USAGE_BYTES | decimal(42,0) | NO   | 实际占用磁盘空间大小，单位为字节     |

## 查询示例

SN 模式下，sys 租户查询各个节点存储空间使用的详细信息。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.CDB_OB_SERVER_SPACE_USAGE LIMIT 10;
```

查询结果如下：

```shell
+-----------+-------------+----------------+-------------+------------+------------+-------------+
| TENANT_ID | TENANT_NAME | SERVER_IP      | SERVER_PORT | SPACE_TYPE | DATA_BYTES | USAGE_BYTES |
+-----------+-------------+----------------+-------------+------------+------------+-------------+
| 1         | sys         |  xx.xx.xx.xx   |        2882 | clog Data  | 7668902375 |  7668902375 |
| 1         | sys         |  xx.xx.xx.xx   |        2882 | Index Data |       2793 |       24576 |
| 1         | sys         |  xx.xx.xx.xx   |        2882 | Meta Data  |   17092608 |    17092608 |
| 1         | sys         |  xx.xx.xx.xx   |        2882 | slog Data  |   11952128 |    11952128 |
| 1         | sys         |  xx.xx.xx.xx   |        2882 | Table Data |       4168 |       32768 |
| 1         | sys         |  xx.xx.xx.xx   |        2882 | Tmp Data   |          0 |           0 |
| 1002      | mysql001    |  xx.xx.xx.xx   |        2882 | clog Data  | 5898749661 |  5898749661 |
| 1002      | mysql001    |  xx.xx.xx.xx   |        2882 | Meta Data  |   28184576 |    28184576 |
| 1002      | mysql001    |  xx.xx.xx.xx   |        2882 | slog Data  |   26112000 |    26112000 |
| 1002      | mysql001    |  xx.xx.xx.xx   |        2882 | Table Data |      25268 |     6438912 |
+-----------+-------------+----------------+-------------+------------+------------+-------------+
10 rows in set
```

## 相关文档

* [oceanbase.CDB_OB_TABLE_SPACE_USAGE](11330.o-cdb_ob_table_space_usage-of-sys-tenant.md)
* [oceanbase.CDB_OB_SPACE_USAGE](10470.o-cdb_ob_space_usage-of-sys-tenant.md)