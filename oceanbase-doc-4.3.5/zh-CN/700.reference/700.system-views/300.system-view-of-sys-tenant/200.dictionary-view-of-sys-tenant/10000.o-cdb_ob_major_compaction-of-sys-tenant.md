|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# oceanbase.CDB_OB_MAJOR_COMPACTION

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.0.0 版本开始引入。</p>
</main>

## 功能描述

系统租户下展示所有租户的合并全局信息。

## 字段说明

|           字段名称           |     类型      | 是否可以为 NULL |        描述         |
|--------------------------|-------------|------------|---------------------------------------------|
| TENANT_ID                | bigint(20)  | NO         | 租户 ID             |
| FROZEN_SCN           | bigint(20) unsigned  | NO         | 最近一次合并的版本号           |
| FROZEN_TIME              | timestamp(6)  | NO         | 最近一次合并发起的时间（将 FROZEN_SCN 以可读的形式展示）           |
| GLOBAL_BROADCAST_SCN | bigint(20) unsigned  | NO         | 全局广播的合并版本         |
| LAST_SCN             | bigint(20) unsigned  | NO         | 上一个已经完成合并的版本      |
| LAST_FINISH_TIME         | timestamp(6)  | NO         | 上一次合并结束时间         |
| START_TIME               | timestamp(6)  | NO         | 合并开始时间            |
| STATUS                   | varchar(10) | NO         | <li> `IDLE`：没有在合并中   <li> `COMPACTION`：正在合并中   <li> `CHECKSUM`：校验checksum    |
| IS_ERROR                 | varchar(3)  | NO         | <li> `YES`：合并过程存在错误   <li> `NO`：合并过程没有报错                                                                   |
| IS_SUSPENDED             | varchar(3)  | NO         | <li> `YES`：暂停合并状态   <li> `NO`：没有暂停合并                                                                       |
| INFO                     | varchar(14) | NO         | 展示合并信息。例如：合并失败原因  |

## 查询示例

系统租户查看所有租户的合并全局信息。

```shell
obclient> SELECT * FROM oceanbase.CDB_OB_MAJOR_COMPACTION;
```

查询结果如下：

```shell
+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
| TENANT_ID | FROZEN_SCN          | FROZEN_TIME                | GLOBAL_BROADCAST_SCN | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS | IS_ERROR | IS_SUSPENDED | INFO |
+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
|         1 | 1748455203800778000 | 2025-05-29 02:00:03.800778 |  1748455203800778000 | 1748455203800778000 | 2025-05-29 02:08:07.209651 | 2025-05-29 02:00:03.823428 | IDLE   | NO       | NO           |      |
|      1001 | 1748455201648062000 | 2025-05-29 02:00:01.648062 |  1748455201648062000 | 1748455201648062000 | 2025-05-29 02:07:54.983179 | 2025-05-29 02:00:01.671665 | IDLE   | NO       | NO           |      |
|      1002 | 1748455203748142000 | 2025-05-29 02:00:03.748142 |  1748455203748142000 | 1748455203748142000 | 2025-05-29 02:05:55.876675 | 2025-05-29 02:00:03.770352 | IDLE   | NO       | NO           |      |
|      1003 | 1748455203288928000 | 2025-05-29 02:00:03.288928 |  1748455203288928000 | 1748455203288928000 | 2025-05-29 02:07:56.498676 | 2025-05-29 02:00:03.314133 | IDLE   | NO       | NO           |      |
|      1004 | 1748455200327759000 | 2025-05-29 02:00:00.327759 |  1748455200327759000 | 1748455200327759000 | 2025-05-29 02:06:12.483698 | 2025-05-29 02:00:00.351135 | IDLE   | NO       | NO           |      |
+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
5 rows in set
```

## 相关视图或文档

* 查看所有租户各个 Zone 的合并信息：[CDB_OB_ZONE_MAJOR_COMPACTION](12000.o-cdb_ob_zone_major_compaction-of-sys-tenant.md)

* 查看 Tablet 级的合并基础统计信息：

  * [GV$OB_MERGE_INFO](../300.performance-view-of-sys-tenant/1800.gv-ob_merge_info-of-sys-tenant.md)

  * [V$OB_MERGE_INFO](../300.performance-view-of-sys-tenant/32200.v-ob_merge_info-of-sys-tenant.md)

* 查看 Tablet 级的合并的详细历史信息：

  * [GV$OB_TABLET_COMPACTION_HISTORY](../300.performance-view-of-sys-tenant/4300.gv-ob_tablet_compaction_history-of-sys-tenant.md)
  * [V$OB_TABLET_COMPACTION_HISTORY](../300.performance-view-of-sys-tenant/34700.v-ob_tablet_compaction_history-of-sys-tenant.md)

* 合并相关的操作，参见以下文档：

  * [自动触发合并](../../../200.system-management/500.manage-data-storage/200.merge-management/200.automatic-merge-triggering.md)

  * [定时触发合并](../../../200.system-management/500.manage-data-storage/200.merge-management/300.scheduled-trigger-merge.md)

  * [自适应合并](../../../200.system-management/500.manage-data-storage/200.merge-management/320.adaptive-compaction.md)

  * [手动触发合并](../../../200.system-management/500.manage-data-storage/200.merge-management/400.manually-trigger-a-merge.md)

  * [手动控制合并](../../../200.system-management/500.manage-data-storage/200.merge-management/500.manually-control-a-merge.md)

  * [查看合并信息](../../../200.system-management/500.manage-data-storage/200.merge-management/500.view-merge-process.md)