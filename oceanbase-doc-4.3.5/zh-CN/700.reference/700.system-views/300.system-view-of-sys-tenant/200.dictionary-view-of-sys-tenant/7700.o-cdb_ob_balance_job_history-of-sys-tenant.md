|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# oceanbase.CDB_OB_BALANCE_JOB_HISTORY

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.2.0 版本开始引入。</p>
</main>

## 功能描述

展示所有租户已执行的负载均衡工作历史。

## 字段说明

| **字段** | **类型** | **是否为 NULL** | **描述** |
| --- | --- | --- | --- |
| TENANT_ID | bigint(20) | NO | 租户 ID <ul><li>1：系统租户 ID  </li><li>其他值：用户租户或者 Meta 租户 ID </li></ul>|
| JOB_ID | bigint(20) | NO | 负载均衡工作 ID |
| CREATE_TIME | timestamp(6) | NO | Job 创建时间 |
| FINISH_TIME | timestamp(6) | NO | Job 完成时间，包括成功、取消时间 |
| BALANCE_STRATEGY | varchar(64) | NO | 均衡策略名称  <ul><li>`LS balance by migrate`：迁移均衡  </li><li>`LS balance by alter`：修改日志流属性均衡 </li><li>`LS balance by expand`：扩容均衡 </li><li>`LS balance by shrink`：缩容均衡 </li><li>`partition balance`：分区均衡 </li></ul>|
| JOB_TYPE | varchar(64) | NO | 任务类型  <ul><li>`LS_BALANCE`：日志流均衡  </li><li>`PARTITION_BALACNE`：分区均衡 </li></ul>|
| TARGET_UNIT_NUM | bigint(20) | NO | 目标变更的每个 Zone 的 Unit 数量 |
| TARGET_PRIMARY_ZONE_NUM | bigint(20) | NO | 目标变更的 Primary  Zone 数量 |
| STATUS | varchar(64) | NO | 任务状态 <ul><li>`DOING`：正在执行 Job  </li><li>`COMPLETED`：任务执行成功 </li><li>`CANCELING`：任务取消中 </li><li>`CANCELED`：任务取消 </li></ul>|
| COMMENT | longtext | YES | 注释信息 |
| MAX_END_TIME | timestamp(6) | YES | 负载均衡任务的最大结束时间 <main id="notice" type='explain'><h4>说明</h4><p>对于 V4.3.x 版本，该视图从 V4.3.4 版本开始引入；对于 V4.2.x 版本，该字段从 V4.2.4 版本开始引入。</p></main>  |

## 查询示例

查看所有租户已执行的负载均衡工作历史。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.CDB_OB_BALANCE_JOB_HISTORY;
```

查询结果如下：

```shell
+-----------+--------+----------------------------+----------------------------+----------------------+------------+-----------------+-------------------------+-----------+---------+--------------+
| TENANT_ID | JOB_ID | CREATE_TIME                | FINISH_TIME                | BALANCE_STRATEGY     | JOB_TYPE   | TARGET_UNIT_NUM | TARGET_PRIMARY_ZONE_NUM | STATUS    | COMMENT | MAX_END_TIME |
+-----------+--------+----------------------------+----------------------------+----------------------+------------+-----------------+-------------------------+-----------+---------+--------------+
|      1002 | 318278 | 2025-05-09 14:29:05.503090 | 2025-05-09 14:29:15.514791 | LS balance by expand | LS_BALANCE |               1 |                       2 | COMPLETED | NULL    | NULL         |
|      1002 | 318453 | 2025-05-09 14:29:45.565764 | 2025-05-09 14:29:55.573005 | LS balance by shrink | LS_BALANCE |               1 |                       1 | COMPLETED | NULL    | NULL         |
|      1002 | 318537 | 2025-05-09 14:30:05.606117 | 2025-05-09 14:30:15.614455 | LS balance by expand | LS_BALANCE |               1 |                       2 | COMPLETED | NULL    | NULL         |
|      1002 | 330209 | 2025-05-09 15:32:39.278774 | 2025-05-09 15:32:49.285956 | LS balance by shrink | LS_BALANCE |               1 |                       1 | COMPLETED | NULL    | NULL         |
|      1002 | 330256 | 2025-05-09 15:32:49.316510 | 2025-05-09 15:33:09.328181 | LS balance by expand | LS_BALANCE |               1 |                       2 | COMPLETED | NULL    | NULL         |
|      1004 | 321371 | 2025-05-09 14:45:15.599930 | 2025-05-09 14:45:25.614648 | LS balance by expand | LS_BALANCE |               1 |                       2 | COMPLETED | NULL    | NULL         |
+-----------+--------+----------------------------+----------------------------+----------------------+------------+-----------------+-------------------------+-----------+---------+--------------+
6 rows in set
```

## 相关视图或文档

* 查看所有租户当前正在执行的日志流级别的负载均衡工作（Job）：[CDB_OB_BALANCE_JOBS](7800.o-cdb_ob_balance_jobs-of-sys-tenant.md)

* 查看所有租户日志流级别的负载均衡任务（Task）：

  * [CDB_OB_BALANCE_TASKS](8000.o-cdb_ob_balance_tasks-of-sys-tenant.md)
  * [CDB_OB_BALANCE_TASK_HISTORY](7900.o-cdb_ob_balance_task_history-of-sys-tenant.md)

* 查看所有租户 Tablet 级别的负载均衡任务（Task）：

  * [CDB_OB_TRANSFER_TASKS](11800.o-cdb_ob_transfer_tasks-of-sys-tenant.md)
  * [CDB_OB_TRANSFER_TASK_HISTORY](11700.o-cdb_ob_transfer_task_history-of-sys-tenant.md)

* 查看所有租户的 Transfer Partition 任务（Task）：

  * [CDB_OB_TRANSFER_PARTITION_TASKS](11500.o-cdb_ob_transfer_partition_tasks-of-sys-tenant.md)
  * [CDB_OB_TRANSFER_PARTITION_TASK_HISTORY](11600.o-cdb_ob_transfer_partition_tasks_history-of-sys-tenant.md)

* 有关数据负载均衡的相关操作，参见 [数据负载均衡](../../../../600.manage/300.replica-management/500.load-balancing-manage/100.load-balancing-overview.md) 章节。