|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# oceanbase.CDB_OB_CS_REPLICA_STATS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>对于 V4.3.5 版本，该视图从 V4.3.5 BP1 版本开始引入。</p>
</main>

## 功能描述

展示所有租户各个 OBServer 上 C 副本日志流中 Tablet 转换为列存的进度。

## 字段说明

| 字段名称                   | 类型          | 是否可以为 NULL      | 描述                                |
|---------------------------|---------------|---------------------|-------------------------------------|
| TENANT_ID                 | bigint(20)    | NO   | 租户 ID |
| SVR_IP                    | varchar(46)   | NO   | C 副本所在的服务器 IP |
| SVR_PORT                  | bigint(20)    | NO   | C 副本所在的服务器的端口号  |
| LS_ID                     | bigint(20)    | NO   | 日志流 ID  |
| TOTAL_TABLET_CNT          | bigint(20)    | NO   | 需要转为列存的分区数量  |
| AVAILABLE_TABLET_CNT      | decimal(42,0) | NO   | 可用的分区数量    |
| TOTAL_MACRO_BLOCK_CNT     | decimal(42,0) | NO   | 总的基线宏块数（不考虑多版本）  |
| AVAILABLE_MACRO_BLOCK_CNT | decimal(42,0) | NO   | 可用的基线宏块数（不考虑多版本）   |
| AVAILABLE                 | varchar(5)    | NO   | 日志流是否已经完全可用：<ul><li>`TRUE`：可用。当该日志流上的所有 Tablet 均可用时，该日志流才完全可用。</li> <li>`FALSE`：不可用</li></ul>  |

## 查询示例

系统租户查询租户 ID 为 1004 的租户在各个 OBServer 上 C 副本日志流中 Tablet 转换为列存的进度。

```shell
obclient[oceanbase]> SELECT * FROM oceanbase.CDB_OB_CS_REPLICA_STATS WHERE TENANT_ID=1004;
```

查询结果如下：

```shell
+-----------+----------------+----------+-------+------------------+----------------------+-----------------------+---------------------------+-----------+
| TENANT_ID | SVR_IP         | SVR_PORT | LS_ID | TOTAL_TABLET_CNT | AVAILABLE_TABLET_CNT | TOTAL_MACRO_BLOCK_CNT | AVAILABLE_MACRO_BLOCK_CNT | AVAILABLE |
+-----------+----------------+----------+-------+------------------+----------------------+-----------------------+---------------------------+-----------+
|      1004 | xx.xxx.xxx.212 |    63000 |  1001 |             1019 |                 1019 |                 10706 |                     10706 | TRUE      |
+-----------+----------------+----------+-------+------------------+----------------------+-----------------------+---------------------------+-----------+
1 row in set
```

根据查询结果，计算 `AVAILABLE_TABLET_CNT / TOTAL_TABLET_CNT` 或者 `AVAILABLE_MACRO_BLOCK_CNT / TOTAL_MACRO_BLOCK_CNT` 的值即可大致估算行存转列存的进度。

## 相关文档

[使用列存副本](../../../../600.manage/300.replica-management/150.the-use-of-columnstore-replica.md)