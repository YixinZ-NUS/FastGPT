|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# oceanbase.CDB_OB_SPACE_USAGE

<main id="notice" type='explain'>
 <h4>说明</h4>
 <p>该视图从 V4.3.4 版本开始引入。</p>
</main>

## 功能描述

* 共享存储（Shared-Storage，SS）模式下，视图 `CDB_OB_SPACE_USAGE` 用于记录各个租户在不同的 Endpoint 和 Path 中，不同种类的数据所占用的空间大小。

* 无共享（Shared-Nothing，SN）模式下，视图 `CDB_OB_SPACE_USAGE` 用于记录各个租户在所有节点合计占用存储空间的详细情况。

## 字段说明

| **字段名称** | **类型**  | **是否可以为 NULL** | **描述**                               |
|------------|-------------|---------------------|----------------------------------------|
| TENANT_ID   | varchar(128)  | NO   | 租户 ID。     |
| TENANT_NAME | varchar(128)  | NO   | 租户名。     |
| ENDPOINT    | varchar(1024) | NO   | 共享存储的 Endpoint，仅适用于 SS 模式；SN 模式下，该字段值为 `NULL`，表示未定义。      |
| PATH        | varchar(1024) | NO   | 共享存储的 Path，仅适用于 SS 模式；SN 模式下，该字段值为 `NULL`，表示未定义。      |
| SPACE_TYPE  | varchar(11)   | NO   | <ul><li>Local Data：本地部署模式下的所有宏块。SS 模式下，包括租户所有副本节点的私有数据、所有元数据、所有临时文件；SN 模式下，包括租户所有副本节点的所有数据、所有元数据、所有临时文件。 </li><li>clog Data：本地部署模式下的 clog。SS 模式下，包括租户所有副本节点的私有 clog；SN 模式下，包括租户所有副本节点的所有 clog。 </li><li>PRIVATE：多副本多版本总和、临时文件 </li><li>Shared Data：租户共享的多版本基线，仅适用于 SS 模式；SN 模式下，该字段值恒为 `0`，表示未共享数据。 </li></ul>    |
| USAGE_BYTES | decimal(42,0) | NO   | 数据实际占用磁盘的大小 required_size，单位为字节。   |

## 查询示例

SN 模式下，sys 租户查看各个租户在所有节点合计占用磁盘空间的详细情况。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.CDB_OB_SPACE_USAGE LIMIT 10;
```

查询结果如下：

```shell
+-----------+-------------+----------+------+-------------+-------------+
| TENANT_ID | TENANT_NAME | ENDPOINT | PATH | SPACE_TYPE  | USAGE_BYTES |
+-----------+-------------+----------+------+-------------+-------------+
| 1         | sys         | NULL     | NULL | clog Data   |  7680321279 |
| 1         | sys         | NULL     | NULL | Shared Data |           0 |
| 1         | sys         | NULL     | NULL | Local Data  |   122265600 |
| 1002      | mysql001    | NULL     | NULL | clog Data   |  5925397177 |
| 1002      | mysql001    | NULL     | NULL | Shared Data |           0 |
| 1002      | mysql001    | NULL     | NULL | Local Data  |   106221568 |
| 1004      | oracle001   | NULL     | NULL | clog Data   |  5970846734 |
| 1004      | oracle001   | NULL     | NULL | Local Data  |    90218496 |
| 1004      | oracle001   | NULL     | NULL | Shared Data |           0 |
+-----------+-------------+----------+------+-------------+-------------+
9 rows in set
```

## 相关文档

* [oceanbase.CDB_OB_TABLE_SPACE_USAGE](11330.o-cdb_ob_table_space_usage-of-sys-tenant.md)
* [oceanbase.CDB_OB_SERVER_SPACE_USAGE](10450.o-cdb_ob_server_space_usage-of-sys-tenant.md)