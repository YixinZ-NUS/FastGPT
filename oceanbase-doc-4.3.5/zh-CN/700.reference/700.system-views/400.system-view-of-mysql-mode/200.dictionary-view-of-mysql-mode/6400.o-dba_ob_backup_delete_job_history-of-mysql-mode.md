|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# oceanbase.DBA_OB_BACKUP_DELETE_JOB_HISTORY

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.0.0 版本开始引入。</p>
</main>

## 功能描述

展示租户下已执行的备份清理任务历史信息。

## 字段说明

| 字段名称 | 类型 | 是否可以为 NULL | 描述 |
| --- | --- | --- | --- |
| TENANT_ID | bigint(20) | NO | 租户 ID |
| JOB_ID | bigint(20) | NO | 任务 ID，单调递增 |
| INCARNATION | bigint(20) | NO | 分身 ID |
| INITIATOR_TENANT_ID | bigint(20) | NO | 发起此次 JOB 的租户 ID |
| INITIATOR_JOB_ID | bigint(20) | NO | 发起此次 JOB 的租户所属的 JOB_ID |
| EXECUTOR_TENANT_ID | varchar(65536) | NO | 执行清理任务的租户列表 |
| TYPE | varchar(64) | NO | 清理类型：<ul><li>DELETE OBSOLETE BACKUP : 过期清理</li></ul>  |
| PARAMETER | timestamp(6) | NO | 清理参数，记录过期时间 |
| JOB_LEVEL | varchar(64) | NO | 任务发起级别：<ul><li> `USER_TENANT` ：用户租户发起的任务</li><li> `SYS_TENANT` ：系统租户发起的任务</li></ul>|
| START_TIMESTAMP | timestamp(6) | NO | 任务开始时租户当前时间 |
| END_TIMESTAMP | timestamp(6) | NO | 任务结束时租户当前时间 |
| STATUS | varchar(64) | NO | 任务状态： <ul><li> `INIT` ：任务初始化阶段 </li><li> `DOING` ：任务执行阶段 </li><li> `CANCELING` ：任务被取消阶段 </li><li> `COMPLETED` : 任务执行成功 </li><li> `FAILED` ：任务执行失败 </li><li> `CANCELED` ：任务成功被取消 </li></ul> |
| TASK_COUNT | bigint(20) | YES | backup_set/piece 任务数 |
| SUCCESS_TASK_COUNT | bigint(20) | YES | backup_set/piece 执行成功的任务数 |
| RESULT | bigint(20) | NO | 错误码 |
| COMMENT | varchar(4096) | YES | 任务执行说明 |

## 查询示例

用户租户查询本租户已执行的备份清理任务历史信息，展示前 5 条记录。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_BACKUP_DELETE_JOB_HISTORY LIMIT 5\G
```

查询结果如下：

```shell
*************************** 1. row ***************************
             JOB_ID: 7
        INCARNATION: 1
INITIATOR_TENANT_ID: 1002
   INITIATOR_JOB_ID: 7
 EXECUTOR_TENANT_ID: 1002
               TYPE: DELETE OBSOLETE BACKUP
          PARAMETER: 2025-01-06 17:33:46.374127
          JOB_LEVEL: USER_TENANT
    START_TIMESTAMP: 2025-01-07 17:33:46.377760
      END_TIMESTAMP: 2025-01-07 17:33:46.426616
             STATUS: COMPLETED
         TASK_COUNT: 0
 SUCCESS_TASK_COUNT: 0
             RESULT: 0
            COMMENT:
*************************** 2. row ***************************
             JOB_ID: 8
        INCARNATION: 1
INITIATOR_TENANT_ID: 1002
   INITIATOR_JOB_ID: 8
 EXECUTOR_TENANT_ID: 1002
               TYPE: DELETE OBSOLETE BACKUP
          PARAMETER: 2025-01-06 18:33:46.641517
          JOB_LEVEL: USER_TENANT
    START_TIMESTAMP: 2025-01-07 18:33:46.645269
      END_TIMESTAMP: 2025-01-07 18:33:46.692936
             STATUS: COMPLETED
         TASK_COUNT: 0
 SUCCESS_TASK_COUNT: 0
             RESULT: 0
            COMMENT:
*************************** 3. row ***************************
             JOB_ID: 9
        INCARNATION: 1
INITIATOR_TENANT_ID: 1002
   INITIATOR_JOB_ID: 9
 EXECUTOR_TENANT_ID: 1002
               TYPE: DELETE OBSOLETE BACKUP
          PARAMETER: 2025-01-06 19:33:46.913048
          JOB_LEVEL: USER_TENANT
    START_TIMESTAMP: 2025-01-07 19:33:46.916564
      END_TIMESTAMP: 2025-01-07 19:33:46.964739
             STATUS: COMPLETED
         TASK_COUNT: 0
 SUCCESS_TASK_COUNT: 0
             RESULT: 0
            COMMENT:
*************************** 4. row ***************************
             JOB_ID: 10
        INCARNATION: 1
INITIATOR_TENANT_ID: 1002
   INITIATOR_JOB_ID: 10
 EXECUTOR_TENANT_ID: 1002
               TYPE: DELETE OBSOLETE BACKUP
          PARAMETER: 2025-01-06 20:33:47.194699
          JOB_LEVEL: USER_TENANT
    START_TIMESTAMP: 2025-01-07 20:33:47.199112
      END_TIMESTAMP: 2025-01-07 20:33:47.252810
             STATUS: COMPLETED
         TASK_COUNT: 0
 SUCCESS_TASK_COUNT: 0
             RESULT: 0
            COMMENT:
*************************** 5. row ***************************
             JOB_ID: 11
        INCARNATION: 1
INITIATOR_TENANT_ID: 1002
   INITIATOR_JOB_ID: 11
 EXECUTOR_TENANT_ID: 1002
               TYPE: DELETE OBSOLETE BACKUP
          PARAMETER: 2025-01-06 21:33:47.474197
          JOB_LEVEL: USER_TENANT
    START_TIMESTAMP: 2025-01-07 21:33:47.477776
      END_TIMESTAMP: 2025-01-07 21:33:47.527881
             STATUS: COMPLETED
         TASK_COUNT: 0
 SUCCESS_TASK_COUNT: 0
             RESULT: 0
            COMMENT:
5 rows in set
```

## 相关视图或文档

* 查看正在执行的备份清理的 Job 任务的执行进度：[DBA_OB_BACKUP_DELETE_JOBS](6500.o-dba_ob_backup_delete_jobs-of-mysql-mode.md)

* 查看正在执行的备份清理的 Task 任务的执行进度：[DBA_OB_BACKUP_DELETE_TASKS](6800.o-dba_ob_backup_delete_tasks-of-mysql-mode.md)

* 查看备份清理的 Task 任务的历史信息：[DBA_OB_BACKUP_DELETE_TASK_HISTORY](6700.o-dba_ob_backup_delete_task_history-of-mysql-mode.md)

* 设置自动清理过期备份的详细操作，参见 [自动清理过期备份](../../../../600.manage/600.backup-and-recovery/500.clear-backup-data/100.cleaning-up-backed-up-data-automatically.md)。