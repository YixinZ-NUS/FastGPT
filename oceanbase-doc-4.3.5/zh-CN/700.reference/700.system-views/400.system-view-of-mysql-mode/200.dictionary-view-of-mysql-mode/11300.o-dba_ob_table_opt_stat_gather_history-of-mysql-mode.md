|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# oceanbase.DBA_OB_TABLE_OPT_STAT_GATHER_HISTORY

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.2.0 版本开始引入。</p>
</main>

## 功能描述

展示当前租户中表的历史统计信息收集的执行情况。

## 字段说明

| **字段** | **类型** | **是否为 NULL** | **描述** |
| --- | --- | --- | --- |
| OWNER | varchar(128) | NO | 表用户名 |
| TABLE_NAME | varchar(256) | NO | 表名 |
| TASK_ID | varchar(36) | NO | 表收集所属的任务 ID |
| STATUS | varchar(8) | NO | 收集任务状态<ul><li>SUCCESS   </li><li>FAILED  </li></ul>|
| START_TIME | datetime(6) | YES | 表收集开始的时间 |
| END_TIME | datetime(6) | YES | 表收集的时间 |
| MEMORY_USED | bigint(20) | YES | 表收集使用的内存 |
| STAT_REFRESH_FAILED_LIST | text | YES | 表收集刷新统计信息缓存失败的列表 |
| PROPERTIES | text | YES | 表收集属性设置 |

## 查询示例

查看本租户中表 `tbl1` 的历史统计信息收集的执行情况。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_TABLE_OPT_STAT_GATHER_HISTORY WHERE TABLE_NAME='tbl1'\G
```

查询结果如下：

```shell
*************************** 1. row ***************************
                   OWNER: infotest
              TABLE_NAME: tbl1
                 TASK_ID: 0fa598be-ff27-11ef-8530-4e5e0075b0a3
                  STATUS: SUCCESS
              START_TIME: 2025-03-12 17:47:50.307858
                END_TIME: 2025-03-12 17:47:50.368191
             MEMORY_USED: 5370
STAT_REFRESH_FAILED_LIST: NULL
              PROPERTIES: GRANULARITY:GLOBAL;METHOD_OPT:FOR ALL COLUMNS SIZE AUTO;DEGREE:1;ESTIMATE_PERCENT:100.000000;BLOCK_SAMPLE:0;STALE_PERCENT:-1.000000;HIST_EST_PERCENT:100.000000
*************************** 2. row ***************************
                   OWNER: infotest
              TABLE_NAME: tbl1
                 TASK_ID: ace0550b-007d-11f0-8530-4e5e0075b0a3
                  STATUS: SUCCESS
              START_TIME: 2025-03-14 10:40:22.031993
                END_TIME: 2025-03-14 10:40:22.069288
             MEMORY_USED: 5152
STAT_REFRESH_FAILED_LIST: NULL
              PROPERTIES: GRANULARITY:AUTO;METHOD_OPT:FOR ALL COLUMNS SIZE AUTO;DEGREE:1;ESTIMATE_PERCENT:100.000000;BLOCK_SAMPLE:0;STALE_PERCENT:-1.000000;HIST_EST_PERCENT:100.000000
2 rows in set
```

## 相关视图或文档

* 查看租户级历史统计信息的收集状态：[DBA_OB_TASK_OPT_STAT_GATHER_HISTORY](../200.dictionary-view-of-mysql-mode/12100.o-dba_ob_task_opt_stat_gather_history-of-mysql-mode.md)

* 有关如何收集统计信息，参见以下文档：

  * [手动收集统计信息](../../../1000.performance-tuning-guide/500.sql-optimization/400.sql-optimization/400.optimizer-statistics/200.statistics-collection-methods/300.collect-statistics-manually.md)

  * [自动收集统计信息](../../../1000.performance-tuning-guide/500.sql-optimization/400.sql-optimization/400.optimizer-statistics/200.statistics-collection-methods/400.collect-statistics-automatically.md)

* 有关统计信息收集监控诊断的详细介绍，参见 [统计信息收集监控诊断](../../../1000.performance-tuning-guide/500.sql-optimization/400.sql-optimization/400.optimizer-statistics/400.statistics-monitoring-diagnosis.md)。