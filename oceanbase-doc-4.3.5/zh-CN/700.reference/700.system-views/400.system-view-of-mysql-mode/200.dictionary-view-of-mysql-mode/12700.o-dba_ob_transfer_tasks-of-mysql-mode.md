|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# oceanbase.DBA_OB_TRANSFER_TASKS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.2.0 版本开始引入。</p>
</main>

## 功能描述

展示本租户下当前正在执行的 Transfer 任务。

## 字段说明

| **字段** | **类型** | **是否为 NULL** | **描述** |
| --- | --- | --- | --- |
| TASK_ID | bigint(20) | NO | Transfer 任务 ID |
| CREATE_TIME | timestamp(6) | YES | 创建时间 |
| MODIFY_TIME | timestamp(6) | YES | 信息更新时间 |
| SRC_LS | bigint(20) | NO | 源端日志流（从数据源产生的日志数据流） |
| DEST_LS | bigint(20) | NO | 目的端日志流 |
| PART_LIST | longtext | YES | 分区列表，包括：用户表分区和全局索引分区 |
| PART_COUNT | bigint(20) | YES | 分区列表中分区数量 |
| NOT_EXIST_PART_LIST | longtext | YES | 本次任务计划执行但加锁时不存在的分区列表 |
| LOCK_CONFLICT_PART_LIST | longtext | YES | 本次任务计划执行但加锁时发生锁冲突的分区列表 |
| TABLE_LOCK_TABLET_LIST | longtext | YES | 在进入 START 状态时成功加锁的 Partition 级表锁的 Tablet 列表，用于表锁搬迁。该列表仅包含 PART_LIST 中分区表对应的 Tablet。 |
| TABLET_LIST | longtext | YES | 本次 Transfer 操作涉及的完整 Tablet 列表，不仅包括 PART_LIST 中列出的 Tablet，还包括与局部索引表和 LOB 辅助表等相关联的 Tablet。 |
| TABLET_COUNT | bigint(20) | YES | Tablet 列表中 Tablet 数量 |
| START_SCN | bigint(20) unsigned | YES | 记录发起 Transfer 的 SCN |
| FINISH_SCN | bigint(20) unsigned | YES | 记录结束 Transfer 的 SCN |
| STATUS | varchar(64) | NO | 任务状态<ul><li>`INIT`：任务创建  </li><li>`START`：开始执行 Transfer </li><li>`DOING`：正在执行 Transfer </li><li>`ABORTED`：Transfer 任务执行失败，终止 </li><li>`COMPLETED`：任务执行成功 </li><li>`FAILED`：任务执行失败 </li><li>`CANCELED`：任务取消 </li></ul>|
| TRACE_ID | varchar(64) | NO | 任务全流程 Trace ID |
| RESULT | bigint(20) | YES | 任务结果 |
| BALANCE_TASK_ID | bigint(20) | NO | 关联的负载均衡任务 ID，该 Transfer 任务是由对应的负载均衡任务生成的子任务。 |
| TABLE_LOCK_OWNER_ID | bigint(20) | YES | 在加表锁时，系统会为每个表锁生成一个 owner_id，用于标识该表锁的所有者。在解表锁时，需要提供相应的 owner_id，以便系统能够正确地识别和释放表锁。 |
| COMMENT | longtext | YES | 注释信息。记录当前卡住的原因和诊断信息以及任务失败情况 |

## 查询示例

查看本租户下当前正在执行的 Transfer 任务。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_TRANSFER_TASKS\G
```

查询结果如下：

```shell
*************************** 1. row ***************************
                 TASK_ID: 3
             CREATE_TIME: 2024-06-14 14:39:42.356430
             MODIFY_TIME: 2024-06-14 14:38:44.315350
                  SRC_LS: 1002
                 DEST_LS: 1001
               PART_LIST: 500224:500224,500229:500229,500234:500234,500239:500239,500244:500244,500249:500249,500254:500254
              PART_COUNT: 7
     NOT_EXIST_PART_LIST: NULL
 LOCK_CONFLICT_PART_LIST: NULL
  TABLE_LOCK_TABLET_LIST: NULL
             TABLET_LIST: 200089:0,200090:0,200091:0,200092:0,200093:0,200094:0,200095:0,1152921504606847076:0,1152921504606847077:0,1152921504606847078:0,1152921504606847079:0,1152921504606847080:0,1152921504606847081:0,1152921504606847082:0,1152921504606847083:0,1152921504606847084:0,1152921504606847085:0,1152921504606847086:0,1152921504606847087:0,1152921504606847088:0,1152921504606847089:0,1152921504606847090:0,1152921504606847091:0,1152921504606847092:0,1152921504606847093:0,1152921504606847094:0,1152921504606847095:0,1152921504606847096:0,1152921504606847097:0,1152921504606847098:0,1152921504606847099:0,1152921504606847100:0,1152921504606847101:0,1152921504606847102:0,1152921504606847103:0
            TABLET_COUNT: 35
               START_SCN: 1718347182784953001
              FINISH_SCN: 0
                  STATUS: DOING
                TRACE_ID: YB4*******************************************-0-0
                  RESULT: 0
         BALANCE_TASK_ID: 374414
     TABLE_LOCK_OWNER_ID: 374434
                 COMMENT:
1 row in set
```

## 相关视图或文档

* 查看本租户下 Tablet 级别的负载均衡任务（Task）历史：[DBA_OB_TRANSFER_TASK_HISTORY](12600.o-dba_ob_transfer_task_history-of-mysql-mode.md)

* 查看本租户下日志流级别的负载均衡工作（Job）：

  * [DBA_OB_BALANCE_JOBS](7800.o-dba_ob_balance_jobs-of-mysql-mode.md)
  * [DBA_OB_BALANCE_JOB_HISTORY](7700.o-dba_ob_balance_job_history-of-mysql-mode.md)

* 查看本租户下日志流级别的负载均衡任务（Task）：

  * [DBA_OB_BALANCE_TASKS](8000.o-dba_ob_balance_tasks-of-mysql-mode.md)
  * [DBA_OB_BALANCE_TASK_HISTORY](7900.o-dba_ob_balance_task_history-of-mysql-mode.md)

* 查看本租户下的 Transfer Partition 任务（Task）：

  * [DBA_OB_TRANSFER_PARTITION_TASKS](12400.o-dba_ob_transfer_partition_tasks-of-mysql-mode.md)
  * [DBA_OB_TRANSFER_PARTITION_TASK_HISTORY](12500.o-dba_ob_transfer_partition_tasks_history-of-mysql-mode.md)

* 有关数据负载均衡的相关操作，参见 [数据负载均衡](../../../../600.manage/300.replica-management/500.load-balancing-manage/100.load-balancing-overview.md) 章节。