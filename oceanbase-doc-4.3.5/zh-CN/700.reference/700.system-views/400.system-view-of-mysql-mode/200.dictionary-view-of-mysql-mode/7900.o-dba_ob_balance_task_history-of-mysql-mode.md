|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# oceanbase.DBA_OB_BALANCE_TASK_HISTORY

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>该视图从 V4.2.0 版本开始引入。</p>
</main>

## 功能描述

展示租户下所有执行负载均衡任务的历史。

## 字段说明

| **字段** | **类型** | **是否为 NULL** | **描述** |
| --- | --- | --- | --- |
| TASK_ID | bigint(20) | NO | 负载均衡任务 ID |
| CREATE_TIME | timestamp(6) | NO | Task 开始时间 |
| FINISH_TIME | timestamp(6) | NO | Task 完成时间，包括成功、取消时间 |
| TASK_TYPE | varchar(64) | NO | 任务类型 <ul><li>`LS_SPLIT`：日志流分裂  </li><li>`LS_ALTER`：修改日志流属性 </li><li>`LS_MERGE`：日志流合并 </li><li>`LS_TRANSFER`：日志流 Transfer </li></ul>|
| SRC_LS | bigint(20) | NO | 源端日志流（从数据源产生的日志数据流） |
| DEST_LS | bigint(20) | NO | 目的端日志流 |
| PART_LIST | longtext | YES | 分区列表，包括：用户表分区和全局索引分区 |
| FINISHED_PART_LIST | longtext | YES | 当前已完成均衡处理的分区列表 |
| PART_COUNT | bigint(20) | YES | 分区列表中分区的数量 |
| FINISHED_PART_COUNT | bigint(20) | YES | 当前已完成均衡处理的分区数量 |
| LS_GROUP_ID | bigint(20) | NO | 日志流组 ID |
| STATUS | varchar(64) | NO | 任务状态 <ul><li>`INIT`：任务创建  </li><li>`CREATE_LS`：创建日志流 </li><li>`ALTER_LS`：修改日志流属性 </li><li>`SET_LS_MERGING`：日志流合并 </li><li>`DROP_LS`：删除日志流 </li><li>`COMPLETED`：任务执行成功 </li><li>`CANCELED`：任务取消 </li></ul>|
| PARENT_LIST | varchar(1024) | YES | 父任务列表 |
| CHILD_LIST | varchar(1024) | YES | 子任务列表 |
| CURRENT_TRANSFER_TASK_ID | bigint(20) | NO | 当前负载均衡任务触发的 Transfer 任务 ID |
| JOB_ID | bigint(20) | NO | 当前任务所属的 Job ID |
| COMMENT | longtext | YES | 注释信息 |
| BALANCE_STRATEGY         | varchar(64)   | YES | Balance Task 对应的均衡策略：<ul><li>`LS balance by migrate`：迁移均衡  </li><li>`LS balance by alter`：修改日志流属性均衡 </li><li>`LS balance by expand`：扩容均衡 </li><li>`LS balance by shrink`：缩容均衡 </li><li>`partition balance`：分区均衡 </li></ul> <main id="notice" type='explain'><h4>说明</h4><p>对于 V4.3.x 版本，该字段从 V4.3.2 版本开始引入；对于 V4.2.x 版本，该字段从 V4.2.4 版本开始引入。</p></main>   |

## 查询示例

查看租户下所有执行负载均衡任务的历史。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_BALANCE_TASK_HISTORY\G
```

查询结果如下：

```shell
*************************** 1. row ***************************
                 TASK_ID: 318280
             CREATE_TIME: 2025-05-09 14:29:05.504906
             FINISH_TIME: 2025-05-09 14:29:13.589729
               TASK_TYPE: LS_SPLIT
                  SRC_LS: 1001
                 DEST_LS: 1002
               PART_LIST: NULL
      FINISHED_PART_LIST: 500002:500008,500002:500011,500002:500014
              PART_COUNT: 0
     FINISHED_PART_COUNT: 3
             LS_GROUP_ID: 1001
                  STATUS: COMPLETED
             PARENT_LIST: NULL
              CHILD_LIST: NULL
CURRENT_TRANSFER_TASK_ID: -1
                  JOB_ID: 318278
                 COMMENT: NULL
        BALANCE_STRATEGY: LS balance by expand
*************************** 2. row ***************************
                 TASK_ID: 318454
             CREATE_TIME: 2025-05-09 14:29:45.565764
             FINISH_TIME: 2025-05-09 14:29:53.633471
               TASK_TYPE: LS_MERGE
                  SRC_LS: 1002
                 DEST_LS: 1001
               PART_LIST: NULL
      FINISHED_PART_LIST: 500002:500008,500002:500011,500002:500014
              PART_COUNT: 0
     FINISHED_PART_COUNT: 3
             LS_GROUP_ID: 1001
                  STATUS: COMPLETED
             PARENT_LIST: NULL
              CHILD_LIST: NULL
CURRENT_TRANSFER_TASK_ID: -1
                  JOB_ID: 318453
                 COMMENT: NULL
        BALANCE_STRATEGY: LS balance by shrink
*************************** 3. row ***************************
                 TASK_ID: 318539
             CREATE_TIME: 2025-05-09 14:30:05.606117
             FINISH_TIME: 2025-05-09 14:30:14.069126
               TASK_TYPE: LS_SPLIT
                  SRC_LS: 1001
                 DEST_LS: 1003
               PART_LIST: NULL
      FINISHED_PART_LIST: 500002:500008,500002:500011,500002:500014
              PART_COUNT: 0
     FINISHED_PART_COUNT: 3
             LS_GROUP_ID: 1001
                  STATUS: COMPLETED
             PARENT_LIST: NULL
              CHILD_LIST: NULL
CURRENT_TRANSFER_TASK_ID: -1
                  JOB_ID: 318537
                 COMMENT: NULL
        BALANCE_STRATEGY: LS balance by expand
3 rows in set
```

## 相关视图或文档

* 查看本租户下日志流级别的负载均衡任务（Task）：[DBA_OB_BALANCE_TASKS](8000.o-dba_ob_balance_tasks-of-mysql-mode.md)

* 查看本租户下日志流级别的负载均衡工作（Job）：

  * [DBA_OB_BALANCE_JOBS](7800.o-dba_ob_balance_jobs-of-mysql-mode.md)
  * [DBA_OB_BALANCE_JOB_HISTORY](7700.o-dba_ob_balance_job_history-of-mysql-mode.md)

* 查看本租户下 Tablet 级别的负载均衡任务（Task）：

  * [DBA_OB_TRANSFER_TASKS](12700.o-dba_ob_transfer_tasks-of-mysql-mode.md)
  * [DBA_OB_TRANSFER_TASK_HISTORY](12600.o-dba_ob_transfer_task_history-of-mysql-mode.md)

* 查看本租户下的 Transfer Partition 任务（Task）：

  * [DBA_OB_TRANSFER_PARTITION_TASKS](12400.o-dba_ob_transfer_partition_tasks-of-mysql-mode.md)
  * [DBA_OB_TRANSFER_PARTITION_TASK_HISTORY](12500.o-dba_ob_transfer_partition_tasks_history-of-mysql-mode.md)

* 有关数据负载均衡的相关操作，参见 [数据负载均衡](../../../../600.manage/300.replica-management/500.load-balancing-manage/100.load-balancing-overview.md) 章节。