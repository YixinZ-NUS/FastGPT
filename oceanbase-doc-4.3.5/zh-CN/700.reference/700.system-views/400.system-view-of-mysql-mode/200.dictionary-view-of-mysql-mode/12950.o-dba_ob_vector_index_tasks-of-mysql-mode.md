|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# oceanbase.DBA_OB_VECTOR_INDEX_TASKS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.3.5 BP3 版本开始引入。</p>
</main>

## 功能描述

视图 `DBA_OB_VECTOR_INDEX_TASKS` 展示了当前租户下所有向量索引分区重建任务的信息。

## 字段说明

| 字段名称                   | 字段类型      | 是否可以为 NULL | 描述 |
|---------------------------|---------------|------|----|
| TABLE_ID	                | bigint(20)	| YES   | 表 ID |
| TABLET_ID	                | bigint(20)	| YES   | 分区 ID |
| TASK_ID	                | bigint(20)	| YES   | 任务 ID |
| START_TIME	                | timestamp(6)	| YES   | 任务开始时间 |
| MODIFY_TIME	                | timestamp(6)	| YES   | 任务结束时间 |
| TRIGGER_TYPE	                | varchar(16)	| NO   | 任务触发类型：<ul><li><code>0</code>：自动触发</li><li><code>1</code>：手动触发</li></ul> |
| STATUS	                | varchar(16)	| NO   | 任务状态：<ul><li><code>0</code>：任务准备中</li><li><code>1</code>：任务执行中</li><li><code>2</code>：任务暂停</li><li><code>3</code>：任务结束</li></ul> |
| TASK_TYPE	                | bigint(20)	| NO   | 任务类型：<ul><li><code>0</code>：异步构建</li><li><code>1</code>：索引分区重建</li></ul>      | |
| TASK_SCN	                | bigint(20)	| NO   | 任务版本号 |
| RET_CODE	                | bigint(20)	| NO   | 任务结束时候的状态：<ul><li><code>0</code>：成功</li><li><code>非 0</code>：失败</li></ul> |
| TRACE_ID	                | varchar(512)	| NO   | 任务执行追踪 ID |
| PROGRESS_INFO	                | varchar(512)	| NO   | 任务执行进度信息，以 JSON 格式展示。通常包括当前操作、预估行数、已完成行数、完成百分比、预估剩余时间等。该信息每 10 秒更新一次。Json 字符串，包含 status、estimated_row、finished_row、progress、time_remaining(s) 字段：<ul><li><code>status</code>：任务状态，有 <code>preparing</code>、<code>inserting vectors</code>、<code>serializing snap index</code>、<code>replacing old index</code> 四种状态</li> <li><code>estimated_row</code>：预估要插入的行数</li> <li><code>finished_row</code>：已插入的行数</li> <li><code>progress</code>：完成进度的百分比</li> <li><code>time_remaining(s)</code>：预估剩余时间</li></ul> |

## 查询示例

系统租户下，查看所有租户的向量索引性能优化任务信息。

```sql
SELECT * FROM oceanbase.DBA_OB_VECTOR_INDEX_TASKS;
```

查询结果如下：

```shell
+-----------+----------+---------------------+---------+----------------------------+----------------------------+--------------+---------+-----------+------------------+----------+------------------------------------+
| TENANT_ID | TABLE_ID | TABLET_ID           | TASK_ID | START_TIME                 | MODIFY_TIME                | TRIGGER_TYPE | STATUS  | TASK_TYPE | TASK_SCN         | RET_CODE | TRACE_ID                           |
+-----------+----------+---------------------+---------+----------------------------+----------------------------+--------------+---------+-----------+------------------+----------+------------------------------------+
|      1004 |   500017 | 1152921504606846987 |   22023 | 1970-08-23 17:08:27.175705 | 1970-08-23 17:08:27.175715 | USER         | RUNNING |         1 | 1746611825281271 |       -1 | Y61460BA2DAD8-000634872BECF00C-0-1 |
+-----------+----------+---------------------+---------+----------------------------+----------------------------+--------------+---------+-----------+------------------+----------+------------------------------------+
1 row in set
```

## 相关视图或文档

* [DBA_OB_VECTOR_INDEX_TASKS](../../300.system-view-of-sys-tenant/200.dictionary-view-of-sys-tenant/24150.o-dba_ob_vector_index_tasks-of-sys-tenant.md)