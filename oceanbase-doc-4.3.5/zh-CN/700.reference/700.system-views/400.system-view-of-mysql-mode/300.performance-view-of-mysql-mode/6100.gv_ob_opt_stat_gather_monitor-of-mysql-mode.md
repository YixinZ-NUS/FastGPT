|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# GV$OB_OPT_STAT_GATHER_MONITOR

<main id="notice" type='explain'>
  <h4>说明</h4>
  <p>该视图从 V4.2.0 版本开始引入。</p>
</main>

## 功能描述

展示当前租户在所有 OBServer 节点上的统计信息收集任务的实时状态。

## 字段说明

| **字段** | **类型** | **是否为 NULL** | **描述** |
| --- | --- | --- | --- |
| TENANT_ID | bigint(20) | NO | 收集任务所在租户 ID |
| SVR_IP | varchar(46) | NO | 收集任务所在的节点地址 |
| SVR_PORT | bigint(20) | NO | 收集任务所在的节点端口 |
| SESSION_ID | bigint(20) | NO | 收集任务所在的会话 ID<br>对于 V4.3.x 版本：<ul><li> V4.3.5 BP2 之前版本：<br>在所有连接方式（直连模式/ODP 模式）下，该字段均表示 Server Session ID。</li><li> V4.3.5 BP2 及之后版本：<ul><li>在直连模式下：<br>该字段表示 Server Session ID。</li> <li>在 ODP 模式下：</li><ul><li>当 ODP 中的配置项 <code>client_session_id_version = 2</code> 时，该字段表示 Client Session ID。 </li> <li>当 <code>client_session_id_version = 1</code> 时，该字段表示 Server Session ID。</li></ul></ul></li></ul> |
| TRACE_ID | varchar(64) | NO | 收集任务所在的 TRACE ID |
| TASK_ID | varchar(36) | NO | 收集任务 ID（UUID 生成，全局唯一） |
| TYPE | varchar(16) | NO | 收集任务类型 |
| TASK_START_TIME | datetime(6) | NO | 收集任务开始时间 |
| TASK_DURATION_TIME | bigint(20) | NO | 收集任务持续时间，单位为微秒 |
| TASK_TABLE_COUNT | bigint(20) | NO | 收集任务需要收集的表个数 |
| COMPLETED_TABLE_COUNT | bigint(20) | NO | 收集任务已经完成的表数量 |
| RUNNING_TABLE_OWNER | varchar(128) | NO | 收集任务正在收集表的用户名 |
| RUNNING_TABLE_NAME | varchar(256) | NO | 收集任务正在收集表的名字 |
| RUNNING_TABLE_DURATION_TIME | bigint(20) | NO | 收集任务正在收集表的持续时间 |
| RUNNING_TABLE_PROGRESS      | varchar(256) | NO   | 收集任务的收集进度 |

## 查询示例

用户租户下，查看本租户在所有节点上的统计信息收集任务的实时状态。

```shell
obclient> SELECT * FROM oceanbase.GV$OB_OPT_STAT_GATHER_MONITOR;
```

查询结果如下：

```shell
+-----------+----------------+----------+------------+-----------------------------------+--------------------------------------+---------------+----------------------------+--------------------+------------------+-----------------------+---------------------+--------------------+-----------------------------+
| TENANT_ID | SVR_IP         | SVR_PORT | SESSION_ID | TRACE_ID                          | TASK_ID                              | TYPE          | TASK_START_TIME            | TASK_DURATION_TIME | TASK_TABLE_COUNT | COMPLETED_TABLE_COUNT | RUNNING_TABLE_OWNER | RUNNING_TABLE_NAME | RUNNING_TABLE_DURATION_TIME |
+-----------+----------------+----------+------------+-----------------------------------+--------------------------------------+---------------+----------------------------+--------------------+------------------+-----------------------+---------------------+--------------------+-----------------------------+
|      1002 | xxx.xxx.xxx.xx |     2882 | 3221575784 | YB42AC1E87C6-0005FF6AD9F825FB-0-0 | c921f339-1bc8-11ee-a7ea-52583362494c | MANUAL GATHER | 2023-07-06 14:46:07.691856 |             609652 |                1 |                     0 | test                | t1                 |                      609653 |
+-----------+----------------+----------+------------+-----------------------------------+--------------------------------------+---------------+----------------------------+--------------------+------------------+-----------------------+---------------------+--------------------+-----------------------------+
1 row in set
```

## 相关视图或文档

* 查看租户级历史统计信息的收集状态：[DBA_OB_TASK_OPT_STAT_GATHER_HISTORY](../200.dictionary-view-of-mysql-mode/12100.o-dba_ob_task_opt_stat_gather_history-of-mysql-mode.md)

* 查看表级历史统计信息的收集状态：[DBA_OB_TABLE_OPT_STAT_GATHER_HISTORY](../200.dictionary-view-of-mysql-mode/11300.o-dba_ob_table_opt_stat_gather_history-of-mysql-mode.md)

* 有关统计信息收集监控诊断的详细介绍，参见 [统计信息收集监控诊断](../../../1000.performance-tuning-guide/500.sql-optimization/400.sql-optimization/400.optimizer-statistics/400.statistics-monitoring-diagnosis.md)。