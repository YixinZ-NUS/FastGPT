|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|MySQL Mode|
|machine-translation||

# V$OB_COMPACTION_PROGRESS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V4.0.0 版本开始引入。</p>
</main>

## 功能描述

展示当前租户在当前节点上的合并进度信息。

## 字段说明

|          字段名称           |      类型      | 是否可以为 NULL |                                            描述                                            |
|-------------------------|--------------|------------|--------|
|SVR_IP    |varchar(46)    |NO   |服务器IP    |
|SVR_PORT    |bigint(20)    |NO   |服务器端口号    |
|TENANT_ID    |bigint(20)    |NO   |租户ID    |
|TYPE    |varchar(64)    |NO   |compaction的类型 <ul><li> MINI：转储/L0 compaction，MemTable通过转储变成SSTable </li><li>MAJOR：合并 </li><li>MINOR：L1 compaction，多个Mini SSTable合成一个</li></ul>    |
|ZONE    |varchar(128)    |NO   |Zone信息    |
|COMPACTION_SCN    |bigint(20) unsigned    |NO   |合并版本信息    |
|STATUS    |varchar(10)    |NO   |状态信息    |
|TOTAL_TABLET_CNT    |bigint(20)    |NO   |tablet总数    |
|UNFINISHED_TABLET_CNT    |bigint(20)    |NO   |未完成的tablet数量    |
|DATA_SIZE    |bigint(20)    |NO   |需要扫描的总数据量，单位为字节    |
|UNFINISHED_DATA_SIZE    |bigint(20)    |NO   |还未需要扫描的数据量，单位为字节    |
|COMPRESSION_RATIO    |bigint(20)    |NO   |新数据的压缩率（仅记录上一个major version点之后新写入数据的压缩率）    |
|START_TIME    |timestamp(6)    |NO   |开始时间    |
|ESTIMATED_FINISH_TIME    |timestamp(6)    |NO   |预计完成时间（若    |
|    |    |NO   |compaction_progress为100，则展示结束时间）    |
| COMMENTS         | varchar(1024) | NO  | 注释信息。合并进行中的时候是记录当前最新的 Compaction 事件。如果合并结束了，记录总体的耗时情况  |

## 查询示例

用户租户查看本租户在当前 OBServer 节点的合并进度信息。

```shell
obclient [oceanbase]> SELECT * FROM oceanbase.V$OB_COMPACTION_PROGRESS;
```

查询结果如下：

```shell
+----------------+----------+-----------+-------------+-------+---------------------+--------+--------------------+-------------------------+-----------+----------------------+-------------------+----------------------------+----------------------------+----------------+
| SVR_IP         | SVR_PORT | TENANT_ID | TYPE        | ZONE  | COMPACTION_SCN      | STATUS | TOTAL_TABLET_COUNT | UNFINISHED_TABLET_COUNT | DATA_SIZE | UNFINISHED_DATA_SIZE | COMPRESSION_RATIO | START_TIME                 | ESTIMATED_FINISH_TIME      | COMMENTS       |
+----------------+----------+-----------+-------------+-------+---------------------+--------+--------------------+-------------------------+-----------+----------------------+-------------------+----------------------------+----------------------------+----------------+
| 172.xx.xxx.xxx |     2882 |      1002 | MAJOR_MERGE | zone1 | 1735668000499972000 | FINISH |                  3 |                       0 |         0 |                    0 |                 1 | 2025-01-01 02:00:02.047807 | 2025-01-01 02:03:28.380519 | total=14.70ms; |
| 172.xx.xxx.xxx |     2882 |      1002 | MAJOR_MERGE | zone1 | 1735754402003130000 | FINISH |                  3 |                       0 |         0 |                    0 |                 1 | 2025-01-02 02:00:04.119302 | 2025-01-02 02:03:31.626016 | total=9.92ms;  |
+----------------+----------+-----------+-------------+-------+---------------------+--------+--------------------+-------------------------+-----------+----------------------+-------------------+----------------------------+----------------------------+----------------+
2 rows in set
```