|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type|Oracle Mode|
|machine-translation||

# USER_TRIGGERS

<main id="notice" type='explain'>
<h4>说明</h4>
<p>该视图从 V2.2.30 版本开始引入。</p>
</main>

## 功能描述

展示当前用户拥有的所有触发器。

  <main id="notice" >
    <h4>功能适用性</h4>
    <p>该视图仅适用于 OceanBase 数据库 Oracle 模式。</p>
  </main>

## 字段说明

|     **字段名称**      |     **类型**      | **是否可以为 NULL** |                                                                  **描述**                                                                  |
|-------------------|-----------------|----------------|------------------------------------------------------------------------------------------------------------------------------------------|
| TRIGGER_NAME      | VARCHAR2(128)   | NO             | 触发器名字                                                 |
| TRIGGER_TYPE      | VARCHAR2(16)    | NO             | 触发器类型： <ul><li>BEFORE EACH ROW</li> <li>AFTER EACH ROW</li> <li>`INSTEAD OF`：INSTEAD OF 触发器</li> <li>`COMPOUND`：组合触发器 </li></ul><li>   |
| TRIGGERING_EVENT  | VARCHAR2(246)   | NO             | 触发事件，当前 OceanBase 数据库仅支持 INSERT、UPDATE、DELETE等。       |
| TABLE_OWNER       | VARCHAR2(128)   | NO             | 表 OWNER，触发对象类型为表时有效。                                  |
| BASE_OBJECT_TYPE  | VARCHAR2(18)    | NO             | 触发对象类型，当前 OceanBase 数据库仅支持 TABLE。                     |
| TABLE_NAME        | VARCHAR2(256)   | NO             | 表名，触发对象类型为表时有效。                                       |
| COLUMN_NAME       | VARCHAR2(4000)  | NO             | 列名，仅在触发对象为嵌套表时有效，其它情况为 NULL。                          |
| REFERENCING_NAMES | VARCHAR2(422)   | NO             | REF 名，OLD 和 NEW 的别名。                                  |
| WHEN_CLAUSE       | VARCHAR2(4000)  | YES            | 触发条件                                                  |
| STATUS            | VARCHAR2(8)     | NO             | 状态： <li> ENABLE   <li> DISABLE              |
| DESCRIPTION       | VARCHAR2(65536) | NO             | 触发器描述，包括名字、类型、事件信息。|
| ACTION_TYPE       | VARCHAR2(11)    | NO             | ACTION 类型，当前 OceanBase 数据库仅支持 PL/SQL。                 |
| TRIGGER_BODY      | VARCHAR2(65536) | NO             | 触发器语句。               |
| CROSSEDITION      | VARCHAR2(7)     | NO             | 跨版本信息。目前暂不支持该字段                                       |
| BEFORE_STATEMENT  | VARCHAR2(3)     | NO             | 语句前，YES/NO。表示组合触发器是否包含指定类型的 Section。                  |
| BEFORE_ROW        | VARCHAR2(3)     | NO             | 行前，YES/NO。表示组合触发器是否包含指定类型的 Section。                   |
| AFTER_ROW         | VARCHAR2(3)     | NO             | 行后，YES/NO。表示组合触发器是否包含指定类型的 Section。                   |
| AFTER_STATEMENT   | VARCHAR2(3)     | NO             | 语句后，YES/NO。表示组合触发器是否包含指定类型的 Section。                  |
| INSTEAD_OF_ROW    | VARCHAR2(3)     | NO             | 代替，YES/NO。表示组合触发器是否包含指定类型的 Section。                   |
| FIRE_ONCE         | VARCHAR2(3)     | NO             | 目前暂不支持该字段                                             |
| APPLY_SERVER_ONLY | VARCHAR2(3)     | NO             | 目前暂不支持该字段                                             |

## 查询示例

查看当前用户拥有的所有触发器。

```shell
obclient[SYS]> SELECT * FROM SYS.USER_TRIGGERS\G
```

查询结果如下：

```shell
*************************** 1. row ***************************
     TRIGGER_NAME: TRG_BEFORE_UPDATE
     TRIGGER_TYPE: BEFORE EACH ROW
 TRIGGERING_EVENT: UPDATE
      TABLE_OWNER: SYS
 BASE_OBJECT_TYPE: TABLE
       TABLE_NAME: TEST_TABLE
      COLUMN_NAME: NULL
REFERENCING_NAMES: REFERENCING NEW AS NEW OLD AS OLD
      WHEN_CLAUSE: NULL
           STATUS: ENABLED
      DESCRIPTION: NULL
      ACTION_TYPE: PL/SQL
     TRIGGER_BODY: TRIGGER trg_before_update
BEFORE UPDATE ON test_table
FOR EACH ROW
BEGIN
    :NEW.update_time := SYSTIMESTAMP;
    DBMS_OUTPUT.PUT_LINE('Trigger trg_before_update executed');
END
     CROSSEDITION: NO
 BEFORE_STATEMENT: NO
       BEFORE_ROW: YES
        AFTER_ROW: NO
  AFTER_STATEMENT: NO
   INSTEAD_OF_ROW: NO
        FIRE_ONCE: YES
APPLY_SERVER_ONLY: NO
*************************** 2. row ***************************
     TRIGGER_NAME: TRG_AUDIT_BASE
     TRIGGER_TYPE: AFTER EACH ROW
 TRIGGERING_EVENT: UPDATE
      TABLE_OWNER: SYS
 BASE_OBJECT_TYPE: TABLE
       TABLE_NAME: TEST_ORDER
      COLUMN_NAME: NULL
REFERENCING_NAMES: REFERENCING NEW AS NEW OLD AS OLD
      WHEN_CLAUSE: NULL
           STATUS: ENABLED
      DESCRIPTION: NULL
      ACTION_TYPE: PL/SQL
     TRIGGER_BODY: TRIGGER trg_audit_base
AFTER UPDATE ON test_order
FOR EACH ROW
BEGIN
    INSERT INTO audit_log(action_type, log_content, log_time)
    VALUES ('UPDATE', 'Base audit triggered', SYSTIMESTAMP);
END
     CROSSEDITION: NO
 BEFORE_STATEMENT: NO
       BEFORE_ROW: NO
        AFTER_ROW: YES
  AFTER_STATEMENT: NO
   INSTEAD_OF_ROW: NO
        FIRE_ONCE: YES
APPLY_SERVER_ONLY: NO
*************************** 3. row ***************************
     TRIGGER_NAME: TRG_AUDIT_DETAIL
     TRIGGER_TYPE: AFTER EACH ROW
 TRIGGERING_EVENT: UPDATE
      TABLE_OWNER: SYS
 BASE_OBJECT_TYPE: TABLE
       TABLE_NAME: TEST_ORDER
      COLUMN_NAME: NULL
REFERENCING_NAMES: REFERENCING NEW AS NEW OLD AS OLD
      WHEN_CLAUSE: NULL
           STATUS: ENABLED
      DESCRIPTION: NULL
      ACTION_TYPE: PL/SQL
     TRIGGER_BODY: TRIGGER trg_audit_detail
AFTER UPDATE ON test_order
FOR EACH ROW
FOLLOWS trg_audit_base
BEGIN
    INSERT INTO audit_log(action_type, log_content, log_time)
    VALUES ('UPDATE', 'Detail: Amount changed from ' || :OLD.amount || ' to ' || :NEW.amount, SYSTIMESTAMP);
END
     CROSSEDITION: NO
 BEFORE_STATEMENT: NO
       BEFORE_ROW: NO
        AFTER_ROW: YES
  AFTER_STATEMENT: NO
   INSTEAD_OF_ROW: NO
        FIRE_ONCE: YES
APPLY_SERVER_ONLY: NO
3 rows in set
```

## 相关视图或文档

* 查看当前用户可访问的所有触发器：[ALL_TRIGGERS](5900.all_triggers-of-oracle-mode.md)

* 查看当前租户下的所有触发器：[DBA_TRIGGERS](22100.dba_triggers-of-oracle-mode.md)

* 有关触发器的介绍和使用，参见 [创建和管理触发器](../../../300.database-object-management/200.manage-object-of-oracle-mode/800.manage-triggers-of-oracle-mode/100.trigger-overview-of-oracle-mode.md)。