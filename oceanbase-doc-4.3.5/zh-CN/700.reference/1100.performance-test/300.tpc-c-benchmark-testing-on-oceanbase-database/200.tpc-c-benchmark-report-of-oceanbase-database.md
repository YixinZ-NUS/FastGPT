|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# OceanBase TPC-C 性能测试报告

本文介绍 TPC-C 测试的测试环境、测试方案以及详细的测试数据结果。

## 测试环境

以阿里云 ECS 作为部署环境为例。

* 硬件配置

    | 服务类型 | ECS 类型 | 实例数 | 机器核心数 | 内存 |
    | --- | --- | --- | --- | --- |
    | OceanBase 数据库    | ecs.g7.8xlarge | 3 | 32C | 128G <br>每台机器系统盘 300G，再挂载两块 400G 云盘作为 clog 盘和 Data 盘，性能级别为 PL1|
    | ODP、Benchmark SQL | ecs.c7.16xlarge | 1 | 32C | 128G |

* 软件版本

    | 服务类型 | 软件版本 |
    | --- | --- |
    | OceanBase 数据库 | <ul><li>企业版：OceanBase 4.3.5.4</li><li>社区版：OceanBase_CE 4.3.5.4</li></ul> |
    | ODP             | OceanBase 4.3.1 |
    | Benchmark SQL   | Benchmark SQL V5.0 |
    | JDBC            | mysql-connector-java-5.1.47 |
    | OS              | CentOS Linux release 7.9.2009 (Core) |

* 租户规格

    ```shell
    obd cluster tenant create obperf -n tpcc_tenant --max-cpu=28 --memory-size=180G -–zone-list=zone1,zone2,zone3 -–primary-zone=RANDOM  --locality=F@zone1,F@zone2,F@zone3 --charset=utf8 -s 'ob_tcp_invited_nodes="%"' --optimize=htap
    ```

    <main id="notice" type='explain'>
      <h4>说明</h4>
      <p>本示例中 <code>--optimize=htap</code> 为默认负载类型，在生产环境中请根据实际的集群类型来选择合适的负载类型。</p>
    </main>

## 测试方案

1. 通过 OBD 部署 OceanBase 集群，ODP 和 TPC-C 单独部署在一台机器上, 防止客户端的压力不足成为性能瓶颈。

2. 3 节点的 OceanBase 集群部署规模为 1：1：1，部署成功后先新建跑 TPC-C 测试的租户及用户（`sys` 租户是管理集群的内置系统租户，请勿直接使用 `sys` 租户进行测试），设置租户的 `primary_zone` 为 RANDOM。

3. 测试步骤请详见：[OceanBase 数据库 TPC-C 测试](100.run-the-tpc-c-benchmark-on-oceanbase-database.md)。

## 测试规格

```shell
warehouses=1000
loadWorkers=40
terminals=1000
runMins=5
newOrderWeight=45
paymentWeight=43
orderStatusWeight=4
deliveryWeight=4
stockLevelWeight=4
```

## 测试结果

本测试中创建集群指定的集群负载类型与创建租户时指定的租户参数模版类型一致，所有测试均在并发量为 96 的条件下进行。

| TPC-C Result | warehouses/terminals=1000 | warehouses/terminals=1200 | warehouses/terminals=1500 |
|------|------|------|------|------|
| tpmC (NewOrders)  | 320903.49 | 373314.21 | 375926.53 |
| tpmTOTAL          | 712868.92 | 829627.72 | 835495.46 |
| Transaction Count | 7132407   | 8299816   | 8359340 |
