|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 查看合并信息

发起合并后，您可以通过视图来查看合并信息。

合并的过程可以通过视图进行查看，通常合并的时间是取决于两次合并之间的数据变化量。两次合并之间的数据变化大，合并的时间会更长。同时，合并的线程数、合并时的集群压力等都影响合并的时间长短。

## 系统租户查看所有租户的合并信息

系统租户可以通过视图来观察所有租户的租户级合并信息和分区级合并信息。

1. 使用 `root` 用户登录集群的 `sys` 租户。

2. 执行以下语句，查看合并信息。

    * 通过视图 `CDB_OB_ZONE_MAJOR_COMPACTION` 或 `CDB_OB_MAJOR_COMPACTION` 查看租户级合并信息。

      视图 `CDB_OB_ZONE_MAJOR_COMPACTION` 展示了所有租户各个 Zone 的合并过程。

      ```shel
      obclient> SELECT * FROM oceanbase.CDB_OB_ZONE_MAJOR_COMPACTION;
      ```

      查询结果如下：

      ```shell
      +-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      | TENANT_ID | ZONE  | BROADCAST_SCN       | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS |
      +-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      |         1 | zone1 | 1748368801021617000 | 1748368801021617000 | 2025-05-28 02:04:15.351286 | 2025-05-28 02:00:01.051592 | IDLE   |
      |      1001 | zone1 | 1748368802924607000 | 1748368802924607000 | 2025-05-28 02:02:16.412661 | 2025-05-28 02:00:02.965810 | IDLE   |
      |      1002 | zone1 | 1748368802035321000 | 1748368802035321000 | 2025-05-28 02:03:25.019173 | 2025-05-28 02:00:02.090687 | IDLE   |
      |      1003 | zone1 | 1748368802977311000 | 1748368802977311000 | 2025-05-28 02:02:46.565036 | 2025-05-28 02:00:03.009192 | IDLE   |
      |      1004 | zone1 | 1748368801786323000 | 1748368801786323000 | 2025-05-28 02:03:54.629630 | 2025-05-28 02:00:01.820863 | IDLE   |
      +-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      5 rows in set
      ```

      在执行结果中观察 `status` 列，部分字段说明如下表所示。

      |字段|说明|
      |---|---|
      |TENANT_ID | 租户 ID。|
      |ZONE|Zone 名称。|
      |BROADCAST_SCN|广播的合并版本号。|
      |LAST_SCN  |上一次合并的版本号。|
      |LAST_FINISH_TIME|上一次合并结束时间。|
      |START_TIME|合并开始时间。|
      |STATUS|合并状态：<ul><li>`IDLE`：未在合并中</li>   <li>`COMPACTING`：正在合并中</li> <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|

      视图 `CDB_OB_ZONE_MAJOR_COMPACTION` 展示了所有租户的合并全局信息。

      ```shell
      obclient> SELECT * FROM oceanbase.CDB_OB_MAJOR_COMPACTION;
      ```

      查询结果如下：

      ```shell
      +-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      | TENANT_ID | FROZEN_SCN          | FROZEN_TIME                | GLOBAL_BROADCAST_SCN | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS | IS_ERROR | IS_SUSPENDED | INFO |
      +-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      |         1 | 1748368801021617000 | 2025-05-28 02:00:01.021617 |  1748368801021617000 | 1748368801021617000 | 2025-05-28 02:04:15.380802 | 2025-05-28 02:00:01.042282 | IDLE   | NO       | NO           |      |
      |      1001 | 1748368802924607000 | 2025-05-28 02:00:02.924607 |  1748368802924607000 | 1748368802924607000 | 2025-05-28 02:02:16.440351 | 2025-05-28 02:00:02.957000 | IDLE   | NO       | NO           |      |
      |      1002 | 1748368802035321000 | 2025-05-28 02:00:02.035321 |  1748368802035321000 | 1748368802035321000 | 2025-05-28 02:03:25.035666 | 2025-05-28 02:00:02.075224 | IDLE   | NO       | NO           |      |
      |      1003 | 1748368802977311000 | 2025-05-28 02:00:02.977311 |  1748368802977311000 | 1748368802977311000 | 2025-05-28 02:02:46.592681 | 2025-05-28 02:00:03.003544 | IDLE   | NO       | NO           |      |
      |      1004 | 1748368801786323000 | 2025-05-28 02:00:01.786323 |  1748368801786323000 | 1748368801786323000 | 2025-05-28 02:03:54.645389 | 2025-05-28 02:00:01.809475 | IDLE   | NO       | NO           |      |
      +-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      5 rows in set
      ```

      在执行结果中观察 `status` 列，部分参数的说明如下表所示。

      |字段|说明|
      |---|---|
      |TENANT_ID | 租户 ID。|
      |FROZEN_SCN|最近一次合并的版本号|
      |FROZEN_TIME|`FROZEN_SCN` 的可读时间类型。|
      |GLOBAL_BROADCAST_SCN |全局广播的合并版本。|
      |LAST_SCN|上一个已经完成合并的版本。|
      |LAST_FINISH_TIME|上一次合并结束时间。|
      |START_TIME|合并开始时间。|
      |STATUS|合并状态：<ul><li>`IDLE`：未在合并中</li>  <li>`COMPACTING`：正在合并中</li>  <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|
      |IS_ERROR|<ul><li>`YES`：合并过程存在错误</li><li>`NO`： 合并过程没有报错</li></ul>|
      |IS_SUSPENDED|<ul><li>`YES`：暂停合并 </li><li>`NO`： 没有暂停合并</li></ul>|
      |INFO|展示合并信息。|

    * 通过视图 `GV$OB_MERGE_INFO` 或 `GV$OB_TABLET_COMPACTION_HISTORY` 查看分区级合并信息

      视图 `GV$OB_MERGE_INFO` 展示了 Tablet 级别的合并基础统计信息。

      ```shell
      obclient [oceanbase]> SELECT * FROM oceanbase.GV$OB_MERGE_INFO WHERE TENANT_ID=1002 AND TABLET_ID=200001 ORDER BY START_TIME DESC LIMIT 10;
      ```

      查询结果如下：

      ```shell
      +----------------+----------+-----------+-------+-----------+-----------------+---------------------+----------------------------+----------------------------+-------------------+-----------+-----------------+
      | SVR_IP         | SVR_PORT | TENANT_ID | LS_ID | TABLET_ID | ACTION          | COMPACTION_SCN      | START_TIME                 | END_TIME                   | MACRO_BLOCK_COUNT | REUSE_PCT | PARALLEL_DEGREE |
      +----------------+----------+-----------+-------+-----------+-----------------+---------------------+----------------------------+----------------------------+-------------------+-----------+-----------------+
      | 172.xx.xxx.xxx |     2882 |      1002 |  1001 |    200001 | MAJOR_MERGE     | 1706119204801812283 | 2024-01-25 02:03:03.876629 | 2024-01-25 02:03:03.929758 |                 0 |      0.00 |               1 |
      | 172.xx.xxx.xxx |     2882 |      1002 |  1001 |    200001 | MDS_TABLE_MERGE | 1706086731631303497 | 2024-01-24 16:58:52.078436 | 2024-01-24 16:58:52.080722 |                 0 |      0.00 |               0 |
      | 172.xx.xxx.xxx |     2882 |      1002 |  1001 |    200001 | MEDIUM_MERGE    | 1706086435242718629 | 2024-01-24 16:56:57.297697 | 2024-01-24 16:56:57.305654 |                 0 |      0.00 |               1 |
      | 172.xx.xxx.xxx |     2882 |      1002 |  1001 |    200001 | MDS_TABLE_MERGE | 1706086356639492056 | 2024-01-24 16:52:37.067139 | 2024-01-24 16:52:37.069771 |                 0 |      0.00 |               0 |
      +----------------+----------+-----------+-------+-----------+-----------------+---------------------+----------------------------+----------------------------+-------------------+-----------+-----------------+
      4 rows in set
      ```

      查询结果中，`ACTION` 列中各值的含义如下：

      * `MDS_TABLE_MERGE`：将系统的元数据按照 SSTable 的格式持久化到磁盘里。
      * `MAJOR_MERGE`：租户级合并
      * `MEDIUM_MERGE`：分区级合并
      * `MINI_MERGE`：Mini Compaction，将 MemTable 转变成 Mini SSTable。
      * `MINOR_MERGE`：Minor Compaction，多个 Mini SSTable 合成一个新的 Mini SSTable 或者多个 Mini SSTable 与一个 Minor SSTable 合成一个新的 Minor SSTable。
      * `META_MAJOR_MERGE`：一种特殊的 Compaction 类型，是将某个指定时间点之前的数据合成一个 Meta Major SSTable，其数据格式与 Major SSTable 一样，不包含多版本数据和未提交事务数据。

      视图 `GV$OB_MERGE_INFO` 中更多字段的详细说明，请参见 [GV$OB_MERGE_INFO](../../../700.system-views/300.system-view-of-sys-tenant/300.performance-view-of-sys-tenant/1800.gv-ob_merge_info-of-sys-tenant.md)。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 展示了 Tablet 级的合并的详细历史信息。

      ```shell
      obclient [oceanbase]> SELECT * FROM oceanbase.GV$OB_TABLET_COMPACTION_HISTORY WHERE TENANT_ID=1002 AND TABLET_ID=200001 ORDER BY START_TIME DESC LIMIT 2\G
      ```

      查询结果如下：

      ```shell
      *************************** 1. row ***************************
                                     SVR_IP: 172.xx.xxx.xxx
                                   SVR_PORT: 2882
                                  TENANT_ID: 1002
                                      LS_ID: 1001
                                  TABLET_ID: 200001
                                       TYPE: MAJOR_MERGE
                             COMPACTION_SCN: 1748455203748142000
                                 START_TIME: 2025-05-29 02:03:35.771081
                                FINISH_TIME: 2025-05-29 02:03:35.778086
                                    TASK_ID: YB42AC1E87E0-000635386FA342D5-0-0
                                OCCUPY_SIZE: 0
                          MACRO_BLOCK_COUNT: 0
              MULTIPLEXED_MACRO_BLOCK_COUNT: 0
               NEW_MICRO_COUNT_IN_NEW_MACRO: 0
       MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO: 0
                            TOTAL_ROW_COUNT: 0
                      INCREMENTAL_ROW_COUNT: 0
                          COMPRESSION_RATIO: 1
                        NEW_FLUSH_DATA_RATE: 0
               PROGRESSIVE_COMPACTION_ROUND: 1
                 PROGRESSIVE_COMPACTION_NUM: 0
                            PARALLEL_DEGREE: 1
                              PARALLEL_INFO: -
                          PARTICIPANT_TABLE: table_cnt=1,[MAJOR]snapshot_version=1748368801840485000;
                              MACRO_ID_LIST:
                                   COMMENTS:
                                START_CG_ID: 0
                                  END_CG_ID: 0
                              KEPT_SNAPSHOT: {type:"UNDO_RETENTION", snapshot:1748453603923723000}
                                MERGE_LEVEL: MICRO_BLOCK_LEVEL
                                  EXEC_MODE: EXEC_MODE_LOCAL
                              IS_FULL_MERGE: FALSE
                    IO_COST_TIME_PERCENTAGE: 0
                               MERGE_REASON: TENANT_MAJOR
                          BASE_MAJOR_STATUS:
                              CO_MERGE_TYPE:
                            MDS_FILTER_INFO:
      *************************** 2. row ***************************
                                     SVR_IP: 172.xx.xxx.xxx
                                   SVR_PORT: 2882
                                  TENANT_ID: 1002
                                      LS_ID: 1001
                                  TABLET_ID: 200001
                                       TYPE: MDS_MINOR_MERGE
                             COMPACTION_SCN: 1748398151630809003
                                 START_TIME: 2025-05-28 10:09:12.139170
                                FINISH_TIME: 2025-05-28 10:09:12.145988
                                    TASK_ID: YB42AC1E87E0-000635386FA3413D-0-0
                                OCCUPY_SIZE: 493
                          MACRO_BLOCK_COUNT: 1
              MULTIPLEXED_MACRO_BLOCK_COUNT: 0
               NEW_MICRO_COUNT_IN_NEW_MACRO: 1
       MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO: 0
                            TOTAL_ROW_COUNT: 1
                      INCREMENTAL_ROW_COUNT: 1
                          COMPRESSION_RATIO: 1
                        NEW_FLUSH_DATA_RATE: 78
               PROGRESSIVE_COMPACTION_ROUND: 0
                 PROGRESSIVE_COMPACTION_NUM: 0
                            PARALLEL_DEGREE: 1
                              PARALLEL_INFO: -
                          PARTICIPANT_TABLE: table_cnt=2,start_scn=1,end_scn=1748398151630809003;
                              MACRO_ID_LIST: 77871
                                   COMMENTS: comment="cost_mb=2;";
                                START_CG_ID: 0
                                  END_CG_ID: 0
                              KEPT_SNAPSHOT:
                                MERGE_LEVEL: MACRO_BLOCK_LEVEL
                                  EXEC_MODE: EXEC_MODE_LOCAL
                              IS_FULL_MERGE: FALSE
                    IO_COST_TIME_PERCENTAGE: 3
                               MERGE_REASON:
                          BASE_MAJOR_STATUS:
                              CO_MERGE_TYPE:
                            MDS_FILTER_INFO:
      2 rows in set
      ```

      查询结果中，`TYPE` 列中各值的含义如下：

      * `MDS_TABLE_MERGE`：将系统的元数据按照 SSTable 的格式持久化到磁盘里。
      * `MAJOR_MERGE`：租户级合并
      * `MEDIUM_MERGE`：分区级合并
      * `MINI_MERGE`：Mini Compaction，将 MemTable 转变成 Mini SSTable。
      * `MINOR_MERGE`：Minor Compaction，多个 Mini SSTable 合成一个新的 Mini SSTable 或者多个 Mini SSTable 与一个 Minor SSTable 合成一个新的 Minor SSTable。
      * `META_MAJOR_MERGE`：一种特殊的 Compaction 类型，是将某个指定时间点之前的数据合成一个 Meta Major SSTable，其数据格式与 Major SSTable 一样，不包含多版本数据和未提交事务数据。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 中更多字段的详细说明，参见 [GV$OB_TABLET_COMPACTION_HISTORY](../../../700.system-views/300.system-view-of-sys-tenant/300.performance-view-of-sys-tenant/4300.gv-ob_tablet_compaction_history-of-sys-tenant.md)。

## 用户租户查看本租户的合并信息

用户租户也可以通过视图来查看本租户的合并信息。

1. 用户租户的租户管理员登录到数据库。

2. 执行以下语句，查看合并信息。

    :::tab
    tab MySQL 模式

    * 通过视图 `DBA_OB_ZONE_MAJOR_COMPACTION` 或 `DBA_OB_MAJOR_COMPACTION` 查看本租户的租户级合并信息。

      视图 `DBA_OB_ZONE_MAJOR_COMPACTION` 展示了本租户各个 Zone 的合并信息。

      ```sql
      obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_ZONE_MAJOR_COMPACTION;
      ```

      查询结果的示例如下：

      ```shell
      +-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      | ZONE  | BROADCAST_SCN       | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS |
      +-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      | zone1 | 1748455202538454000 | 1748455202538454000 | 2025-05-29 02:04:34.174642 | 2025-05-29 02:00:02.679713 | IDLE   |
      +-------+---------------------+---------------------+----------------------------+----------------------------+--------+
      1 row in set
      ```

      在执行结果中观察 `status` 列，部分参数的说明如下表所示。

      |字段|说明|
      |---|---|
      |ZONE|Zone 名称。|
      |BROADCAST_SCN|广播的合并版本号。|
      |LAST_SCN  |上一次合并的版本号。|
      |LAST_FINISH_TIME|上一次合并结束时间。|
      |START_TIME|合并开始时间。|
      |STATUS|合并状态：<ul><li>`IDLE`：未在合并中</li>   <li>`COMPACTING`：正在合并中</li> <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|

      视图 `DBA_OB_MAJOR_COMPACTION` 展示了本租户的合并全局信息。

      ```shell
      obclient [oceanbase]> SELECT * FROM oceanbase.DBA_OB_MAJOR_COMPACTION;
      ```

      查询结果如下：

      ```shell
      +---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      | FROZEN_SCN          | FROZEN_TIME                | GLOBAL_BROADCAST_SCN | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS | IS_ERROR | IS_SUSPENDED | INFO |
      +---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      | 1748455202538454000 | 2025-05-29 02:00:02.538454 |  1748455202538454000 | 1748455202538454000 | 2025-05-29 02:04:34.171690 | 2025-05-29 02:00:02.670090 | IDLE   | NO       | NO           |      |
      +---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+
      1 row in set
      ```

      在执行结果中观察 `status` 列，部分参数的说明如下表所示。

      |字段|说明|
      |---|---|
      |FROZEN_SCN|最近一次合并的版本号|
      |FROZEN_TIME|`FROZEN_SCN` 的可读时间类型。|
      |GLOBAL_BROADCAST_SCN |全局广播的合并版本。|
      |LAST_SCN|上一个已经完成合并的版本。|
      |LAST_FINISH_TIME|上一次合并结束时间。|
      |START_TIME|合并开始时间。|
      |STATUS|合并状态：<ul><li>`IDLE`：未在合并中</li>   <li>`COMPACTING`：正在合并中</li>   <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|
      |IS_ERROR|<ul><li>`YES`：合并过程存在错误 </li><li>`NO`：合并过程没有报错</li></ul>|
      |IS_SUSPENDED|<ul><li>`YES`：暂停合并 </li><li>`NO`：没有暂停合并</li></ul>|
      |INFO|展示合并信息。|

    * 通过视图 `GV$OB_TABLET_COMPACTION_HISTORY` 查看本租户分区级合并信息。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 展示了 Tablet 级的合并的详细历史信息。

      ```shell
      obclient [oceanbase]> SELECT * FROM oceanbase.GV$OB_TABLET_COMPACTION_HISTORY WHERE TABLET_ID=200001 ORDER BY START_TIME DESC LIMIT 2\G
      ```

      查询结果如下：

      ```shell
      *************************** 1. row ***************************
                                     SVR_IP: 172.xx.xxx.xxx
                                   SVR_PORT: 2882
                                  TENANT_ID: 1002
                                      LS_ID: 1001
                                  TABLET_ID: 200001
                                       TYPE: MAJOR_MERGE
                             COMPACTION_SCN: 1748455203748142000
                                 START_TIME: 2025-05-29 02:03:35.771081
                                FINISH_TIME: 2025-05-29 02:03:35.778086
                                    TASK_ID: YB42AC1E87E0-000635386FA342D5-0-0
                                OCCUPY_SIZE: 0
                          MACRO_BLOCK_COUNT: 0
              MULTIPLEXED_MACRO_BLOCK_COUNT: 0
               NEW_MICRO_COUNT_IN_NEW_MACRO: 0
       MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO: 0
                            TOTAL_ROW_COUNT: 0
                      INCREMENTAL_ROW_COUNT: 0
                          COMPRESSION_RATIO: 1
                        NEW_FLUSH_DATA_RATE: 0
               PROGRESSIVE_COMPACTION_ROUND: 1
                 PROGRESSIVE_COMPACTION_NUM: 0
                            PARALLEL_DEGREE: 1
                              PARALLEL_INFO: -
                          PARTICIPANT_TABLE: table_cnt=1,[MAJOR]snapshot_version=1748368801840485000;
                              MACRO_ID_LIST:
                                   COMMENTS:
                                START_CG_ID: 0
                                  END_CG_ID: 0
                              KEPT_SNAPSHOT: {type:"UNDO_RETENTION", snapshot:1748453603923723000}
                                MERGE_LEVEL: MICRO_BLOCK_LEVEL
                                  EXEC_MODE: EXEC_MODE_LOCAL
                              IS_FULL_MERGE: FALSE
                    IO_COST_TIME_PERCENTAGE: 0
                               MERGE_REASON: TENANT_MAJOR
                          BASE_MAJOR_STATUS:
                              CO_MERGE_TYPE:
                            MDS_FILTER_INFO:
      *************************** 2. row ***************************
                                     SVR_IP: 172.xx.xxx.xxx
                                   SVR_PORT: 2882
                                  TENANT_ID: 1002
                                      LS_ID: 1001
                                  TABLET_ID: 200001
                                       TYPE: MDS_MINOR_MERGE
                             COMPACTION_SCN: 1748398151630809003
                                 START_TIME: 2025-05-28 10:09:12.139170
                                FINISH_TIME: 2025-05-28 10:09:12.145988
                                    TASK_ID: YB42AC1E87E0-000635386FA3413D-0-0
                                OCCUPY_SIZE: 493
                          MACRO_BLOCK_COUNT: 1
              MULTIPLEXED_MACRO_BLOCK_COUNT: 0
               NEW_MICRO_COUNT_IN_NEW_MACRO: 1
       MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO: 0
                            TOTAL_ROW_COUNT: 1
                      INCREMENTAL_ROW_COUNT: 1
                          COMPRESSION_RATIO: 1
                        NEW_FLUSH_DATA_RATE: 78
               PROGRESSIVE_COMPACTION_ROUND: 0
                 PROGRESSIVE_COMPACTION_NUM: 0
                            PARALLEL_DEGREE: 1
                              PARALLEL_INFO: -
                          PARTICIPANT_TABLE: table_cnt=2,start_scn=1,end_scn=1748398151630809003;
                              MACRO_ID_LIST: 77871
                                   COMMENTS: comment="cost_mb=2;";
                                START_CG_ID: 0
                                  END_CG_ID: 0
                              KEPT_SNAPSHOT:
                                MERGE_LEVEL: MACRO_BLOCK_LEVEL
                                  EXEC_MODE: EXEC_MODE_LOCAL
                              IS_FULL_MERGE: FALSE
                    IO_COST_TIME_PERCENTAGE: 3
                               MERGE_REASON:
                          BASE_MAJOR_STATUS:
                              CO_MERGE_TYPE:
                            MDS_FILTER_INFO:
      2 rows in set
      ```

      查询结果中，`TYPE` 列中各值的含义如下：

      * `MDS_TABLE_MERGE`：将系统的元数据按照 SSTable 的格式持久化到磁盘里。
      * `MAJOR_MERGE`：租户级合并
      * `MEDIUM_MERGE`：分区级合并
      * `MINI_MERGE`：Mini Compaction，将 MemTable 转变成 Mini SSTable。
      * `MINOR_MERGE`：Minor Compaction，多个 Mini SSTable 合成一个新的 Mini SSTable 或者多个 Mini SSTable 与一个 Minor SSTable 合成一个新的 Minor SSTable。
      * `META_MAJOR_MERGE`：一种特殊的 Compaction 类型，是将某个指定时间点之前的数据合成一个 Meta Major SSTable，其数据格式与 Major SSTable 一样，不包含多版本数据和未提交事务数据。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 中更多字段的详细说明，参见 [GV$OB_TABLET_COMPACTION_HISTORY](../../../700.system-views/400.system-view-of-mysql-mode/300.performance-view-of-mysql-mode/4200.gv-ob_tablet_compaction_history-of-mysql-mode.md)。

    tab Oracle 模式

    * 通过视图 `DBA_OB_ZONE_MAJOR_COMPACTION` 或 `DBA_OB_MAJOR_COMPACTION` 查看本租户的租户级合并信息。

      视图 `DBA_OB_ZONE_MAJOR_COMPACTION` 展示了本租户各个 Zone 的合并信息。

      ```shell
      obclient [TEST]>  SELECT * FROM SYS.DBA_OB_ZONE_MAJOR_COMPACTION;
      ```

      查询结果如下：

      ```shell
      +-------+---------------------+----------+------------------+------------------+------------+
      | ZONE  | BROADCAST_SCN       | LAST_SCN | LAST_FINISH_TIME | START_TIME       | STATUS     |
      +-------+---------------------+----------+------------------+------------------+------------+
      | zone1 | 1748487596765126000 |        1 |                0 | 1748487596921347 | COMPACTING |
      +-------+---------------------+----------+------------------+------------------+------------+
      1 row in set
      ```

      在执行结果中观察 `status` 列，部分参数的说明如下表所示。

      |字段|说明|
      |---|---|
      |ZONE|Zone 名称。|
      |BROADCAST_SCN|广播的合并版本号。|
      |LAST_SCN  |上一次合并的版本号。|
      |LAST_FINISH_TIME|上一次合并结束时间。|
      |START_TIME|合并开始时间。|
      |STATUS|合并状态：<ul><li>`IDLE`：未在合并中</li>   <li>`COMPACTING`：正在合并中</li> <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|

      视图 `DBA_OB_MAJOR_COMPACTION` 展示了本租户的合并全局信息。

      ```shell
      obclient [TEST]> SELECT * FROM SYS.DBA_OB_MAJOR_COMPACTION;
      ```

      查询结果如下：

      ```shell
      +---------------------+----------------------+----------+------------------+------------------+------------+----------+--------------+------+
      | FROZEN_SCN          | GLOBAL_BROADCAST_SCN | LAST_SCN | LAST_FINISH_TIME | START_TIME       | STATUS     | IS_ERROR | IS_SUSPENDED | INFO |
      +---------------------+----------------------+----------+------------------+------------------+------------+----------+--------------+------+
      | 1748487596765126000 |  1748487596765126000 |        1 |                0 | 1748487596900693 | COMPACTING | NO       | NO           | NULL |
      +---------------------+----------------------+----------+------------------+------------------+------------+----------+--------------+------+
      1 row in set
      ```

      在执行结果中观察 `status` 列，部分参数的说明如下表所示。

      |字段|说明|
      |---|---|
      |FROZEN_SCN              |最新的合并快照。|
      |GLOBAL_BROADCAST_SCN    |全局广播的合并版本。|
      |LAST_SCN                |上一个已经完成合并的版本。|
      |LAST_FINISH_TIME        |上一次合并结束时间。|
      |START_TIME              |合并开始时间。|
      |STATUS                  |合并状态：<ul><li>`IDLE`：未在合并中</li>   <li>COMPACTING：正在合并中</li>   <li>`VERIFYING`：正在校验 Checksum 中</li></ul>|
      |IS_ERROR                |<ul><li>`YES`：合并过程存在错误 </li><li>`NO`：合并过程没有报错</li></ul>|
      |IS_SUSPENDED            |<ul><li>`YES`：暂停合并</li><li>`NO`：没有暂停合并</li></ul>|
      |INFO|展示合并信息。|

    * 通过视图 `GV$OB_TABLET_COMPACTION_HISTORY` 查看本租户分区级合并信息。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 展示了 Tablet 级的合并的详细历史信息。

      ```shell
      obclient [TEST]> SELECT * FROM SYS.GV$OB_TABLET_COMPACTION_HISTORY WHERE TABLET_ID=200001 AND ROWNUM<=10 ORDER BY START_TIME\G
      ```

      查询结果如下：

      ```shell
      *************************** 1. row ***************************
                                     SVR_IP: 172.xx.xxx.xxx
                                   SVR_PORT: 2882
                                  TENANT_ID: 1004
                                      LS_ID: 1001
                                  TABLET_ID: 200001
                                       TYPE: MDS_MINOR_MERGE
                             COMPACTION_SCN: 1748368803414843000
                                 START_TIME: 28-MAY-25 02.00.05.107746 AM
                                FINISH_TIME: 28-MAY-25 02.00.05.113086 AM
                                    TASK_ID: YB42AC1E87E0-00063538753335FD-0-0
                                OCCUPY_SIZE: 630
                          MACRO_BLOCK_COUNT: 1
              MULTIPLEXED_MACRO_BLOCK_COUNT: 0
               NEW_MICRO_COUNT_IN_NEW_MACRO: 1
       MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO: 0
                            TOTAL_ROW_COUNT: 2
                      INCREMENTAL_ROW_COUNT: 2
                          COMPRESSION_RATIO: 1
                        NEW_FLUSH_DATA_RATE: 191
               PROGRESSIVE_COMPACTION_ROUND: 0
                 PROGRESSIVE_COMPACTION_NUM: 0
                            PARALLEL_DEGREE: 1
                              PARALLEL_INFO: -
                          PARTICIPANT_TABLE: table_cnt=2,start_scn=1,end_scn=1748368803414843000;
                              MACRO_ID_LIST: 75689
                                   COMMENTS: comment="cost_mb=2;";
                                START_CG_ID: 0
                                  END_CG_ID: 0
                              KEPT_SNAPSHOT: NULL
                                MERGE_LEVEL: MACRO_BLOCK_LEVEL
                                  EXEC_MODE: EXEC_MODE_LOCAL
                              IS_FULL_MERGE: FALSE
                    IO_COST_TIME_PERCENTAGE: 2
                               MERGE_REASON: NULL
                          BASE_MAJOR_STATUS: NULL
                              CO_MERGE_TYPE: NULL
                            MDS_FILTER_INFO: NULL
      1 row in set
      ```

      查询结果中，`TYPE` 列中各值的含义如下：

      * `MDS_TABLE_MERGE`：将系统的元数据按照 SSTable 的格式持久化到磁盘里。
      * `MAJOR_MERGE`：租户级合并
      * `MEDIUM_MERGE`：分区级合并
      * `MINI_MERGE`：Mini Compaction，将 MemTable 转变成 Mini SSTable。
      * `MINOR_MERGE`：Minor Compaction，多个 Mini SSTable 合成一个新的 Mini SSTable 或者多个 Mini SSTable 与一个 Minor SSTable 合成一个新的 Minor SSTable。
      * `META_MAJOR_MERGE`：一种特殊的 Compaction 类型，是将某个指定时间点之前的数据合成一个 Meta Major SSTable，其数据格式与 Major SSTable 一样，不包含多版本数据和未提交事务数据。

      视图 `GV$OB_TABLET_COMPACTION_HISTORY` 中更多字段的详细说明，请参见 [GV$OB_TABLET_COMPACTION_HISTORY](../../../700.system-views/500.system-view-of-oracle-mode/300.performance-view-of-oracle-mode/900.gv-ob_tablet_compaction_history-of-oracle-mode.md)。

    :::
