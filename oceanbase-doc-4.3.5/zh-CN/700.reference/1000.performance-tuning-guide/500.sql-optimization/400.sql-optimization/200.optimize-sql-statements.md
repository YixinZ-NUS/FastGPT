# SQL 调优基本流程

## 步骤一：定位慢 SQL

通过以下工具初步查找耗时或消耗资源（如内存、磁盘 IO）的 SQL：

- **全局 SQL 审计表**：`(G)V$OB_SQL_AUDIT`
- **SQL Trace**
- **计划缓存视图**

请参见示例：[查询某段时间内执行时间排名 TOP N 的请求](../1100.sql-performance-analysis-best-practices/700.top-n-sql-statements.md)

关于 SQL 性能分析的详细说明，请参见：[SQL 执行性能监控](300.monitor-sql-execution-performance/100.gv-ob-sql-audit.md)

## 步骤二：分析执行计划

单条 SQL 的执行性能与执行计划密切相关。通过以下步骤分析执行计划：

1. **查看逻辑执行计划**： 执行 `EXPALIN` 命令，获取优化器生成的执行计划。
2. **确定调优方向**：根据执行计划中的操作类型（如全表扫描、索引选择）判断优化方向。

请参见示例：[查看执行计划形状并做分析](../1100.sql-performance-analysis-best-practices/300.view-and-analyze-the-execution-plan.md)

关于执行计划的详细说明，请参见：[SQL 执行计划简介](../200.sql-execution-plan/100.introduction-to-sql-execution-plans.md)

## 步骤三：收集统计信息

收集 SQL 涉及的表、列、谓词等对象的统计信息。

**关键作用**：统计信息是代价模型选取最优执行计划的核心依据，优化器可通过统计信息优化计划选择策略。

请参见：[收集统计信息](400.optimizer-statistics/100.statistics-overview.md)

## 步骤四：具体调优方法

针对具体的慢 SQL，通过以下方式优化其执行时间或资源消耗：

### 查询改写

对 SQL 进行等价改写，生成最佳执行计划。

请参见：[查询改写](500.query-rewrite/100.query-rewrite-overview.md)

### 优化多表联接

针对多表访问的 SQL，需关注以下联接优化方向：

- **访问路径优化**：选择更高效的表访问方式（如索引扫描 vs 全表扫描）
- **联接顺序调整**：优化表的联接顺序以减少中间结果集
- **联接算法选择**：根据数据分布选择合适的联接算法（如 Hash Join、Nested Loop）

请参见：
- [访问路径](600.query-optimization/100.access-path/100.access-path-overview.md)
- [联接算法](600.query-optimization/200.join-algorithm/200.join-algorithm.md)
- [联接顺序](600.query-optimization/200.join-algorithm/400.join-order.md)
