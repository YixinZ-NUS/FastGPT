|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||
|machine-translation||

# major_compact_trigger

<main id="notice" type='explain'>
<h4>说明</h4>
<ul><li><p>OceanBase 数据库 V4.x 版本已具备了自适应合并能力(由 <code>_enable_adaptive_compaction</code> 开关进行控制)，自适应合并开启期间，系统会实时采集并统计用户的查询、写入等信息，并按需对分区调度分区合并任务。自适应合并触发的其中一个场景为：当某个分区转储频繁，并且达到阈值后，就会为该分区调度分区合并任务。有关自适应合并功能的详细操作及说明，参见 <a href="../../../200.system-management/500.manage-data-storage/200.merge-management/320.adaptive-compaction.md">自适应合并</a>。</p>
<p>配置项 <code>major_compact_trigger</code> 表示的是当某个租户冻结的次数达到阈值时，则为该租户调度一次租户级合并任务。配置项 <code>major_compact_trigger</code> 的控制范围为租户级，相比于自适应合并功能，租户级合并的粒度更大、涉及的分区更多，系统消耗的资源也会更多，因此，在自适应合并能力开启时，不建议租户使用配置项 <code>major_compact_trigger</code>。</p></li>
<li>该配置项从 V4.0.0 版本开始生效范围由集群级调整为租户级。</li></ul>
</main>

## 功能描述

`major_compact_trigger` 用于设置多少次冻结（转储的前置动作）触发一次合并。

## 权限要求

* 查询配置项

  `sys` 租户和所有用户租户均可以使用 `SHOW PARAMETERS` 语句或视图 `GV$OB_PARAMETERS` 查询该配置项。

* 修改配置项

  `sys` 租户和用户租户均可修改该配置项。

## 属性说明

|      **属性**      |    **描述**    |
|------------------|--------------|
| 参数类型             | Int           |
| 默认值               | 0，表示无论冻结多少次都不会自动触发合并。 <main id="notice" type='explain'><h4>说明</h4><p>该配置项从 V4.0.0 版本开始默认值由 5 调整为 0。</p></main>           |
| 取值范围             | \[0, 65535\] |
| 是否可修改           | 是，支持通过 `ALTER SYSTEM SET` 语句修改。|
| 是否重启 OBServer 节点生效 | 否，设置后立即生效。     |

## 配置示例

设置 10 次冻结后触发一次租户级合并。

```shell
obclient> ALTER SYSTEM SET major_compact_trigger=10;
```