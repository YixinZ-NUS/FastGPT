|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 备份前准备

在进行数据备份前，需要进行一些备份前的准备工作，包括配置备份目的端、备份秘钥等。

## 配置备份目的端

配置备份目的端时，由于系统租户不包含用户数据，是集群管理用的租户，不支持备份恢复，故 `sys` 租户无需配置 `DATA_BACKUP_DEST` 参数。

### 注意事项

配置备份目的端时，要求每个租户的备份路径需要配置为独立的空目录，不同租户不能配置相同的备份路径。

### 操作步骤

1. `sys` 租户或用户租户的租户管理员登录数据库。

   <main id="notice" type='explain'>
   <h4>说明</h4>
   <p>MySQL 模式的管理员用户为 <code> root</code> 用户，Oracle 模式的管理员用户为 <code>SYS</code> 用户。</p>
   </main>

2. 配置备份目的端。

   * 系统租户为指定租户配置备份目的端

     ```sql
     ALTER SYSTEM SET DATA_BACKUP_DEST= 'data_backup_path' TENANT = mysql_tenant;
     ```

   * 用户租户配置本租户的备份目的端

     语句如下：

     ```sql
     ALTER SYSTEM SET DATA_BACKUP_DEST= 'data_backup_path';
     ```

   <main id="notice" type='notice'>
   <h4>注意</h4>
   <p>对于从 OceanBase 数据库 V4.0.x 版本升级到 V4.1.0 版本的场景，版本升级后需要更改备份路径。对于从 OceanBase 数据库 V4.1.x 版本升级到 V4.2.0 版本的场景，版本升级后不需要更改备份路径。</p>
   </main>

   目前，OceanBase 数据库支持的备份介质为 NFS、阿里云 OSS、Azure Blob（在 V4.3.5 版本中，从 V4.3.5 BP3 版本开始支持）、AWS S3 以及兼容 S3 协议的对象存储，例如：华为 OBS、Google GCS、腾讯云 COS。部分备份介质可能需要满足一些基本要求才能使用，有关各备份介质的具体要求，参见 [物理备份与恢复概述](../100.overview-of-physical-backup-and-recovery.md) 中的 **备份介质要求**。

   详细设置说明如下。
  
    :::tab
    tab 阿里云 OSS

    当使用 OSS 作为备份介质时，除了设置备份路径，您还可以通过 `delete_mode` 参数来配置备份文件的清理模式。`delete_mode` 参数当前支持 `delete` 模式和 `tagging` 模式。如果不显式配置 `delete_mode` 参数，则默认使用 `delete` 模式。

    此外，OSS 还支持通过 `checksum_type` 参数指定校验算法来校验备份数据的完整性，支持的取值为 `md5` 和 `no_checksum`。如果不显式配置 `checksum_type` 参数，则默认值为 `md5`。

    在 V4.3.5 版本中，从 V4.3.5 BP2 版本开始，OceanBase 数据库支持使用已配置了合规保留策略的阿里云 OSS Bucket 作为备份路径。在配置备份路径时，可以通过 `enable_worm` 参数来指定 OceanBase 数据库是否按照 Bucket 的保留策略（WORM 策略）对该路径执行写入及删除操作。该参数支持的取值为 `true` 和 `false`。如果不显式配置 `enable_worm` 参数，则默认为 `false`。设置 `enable_worm=true` 时要求同时显式配置 `checksum_type=md5`。该参数一旦设置后，不支持变更。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>OceanBase 数据库当前不会替代您设置合规保留策略，请在设置备份路径前确保 OSS Bucket 已正确设置保留策略（WORM 策略）并锁定。</p>
    </main>

    有关各参数的详细说明，参见 [SET DATA_BACKUP_DEST](../../../700.reference/500.sql-reference/100.sql-syntax/100.system-tenants/200.alter-system/3500.set-data-backup-dest.md)。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>使用对象存储作为备份介质时，对象存储路径的各项参数由 <code>&</code> 符号进行分隔，请确保您输入的参数值中仅包含英文字母大小写、数字、<code>/-_$+=</code> 以及通配符。如果您输入了上述以外的其他字符，可能会导致设置失败。</p>
    </main>

    示例如下：

    * 使用 OSS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径，配置备份文件的清理模式，同时指定校验算法为 `md5`。

      ```shell
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='oss://oceanbase-test-bucket/backup/data?host=****.aliyun-inc.com&access_id=****&access_key=****&delete_mode=delete&checksum_type=md5' TENANT = mysql_tenant;
      ```

      如果不希望校验备份数据的完整性，可以将 `checksum_type` 参数设置为 `no_checksum`，示例如下：

      ```shell
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='oss://oceanbase-test-bucket/backup/data?host=****.aliyun-inc.com&access_id=****&access_key=****&delete_mode=delete&checksum_type=no_checksum' TENANT = mysql_tenant;
      ```

    * 使用 OSS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径，配置备份文件的清理模式，指定以 WORM 支持的方式写入和删除 Object，同时指定校验算法为 `md5`。

      <main id="notice" type='notice'>
      <h4>注意</h4>
      <ul><li>OceanBase 数据库当前不会替代您设置合规保留策略，请在设置备份路径前确保 OSS Bucket 已正确设置保留策略（WORM 策略）并锁定。</li>
      <li>使用配置了 WORM 策略的 Bucket 作为备份路径时，推荐清理模式使用 <code>tagging</code> 模式。</li></ul>
      </main>

      ```shell
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='oss://oceanbase-test-bucket/backup/data?host=****.aliyun-inc.com&access_id=****&access_key=****&delete_mode=tagging&checksum_type=md5&enable_worm=true' TENANT = mysql_tenant;
      ```

    * 使用 OSS 作为备份介质时，用户租户为本租户设置备份路径，配置备份文件的清理模式，同时指定校验算法为 `md5`。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='oss://oceanbase-test-bucket/backup/data?host=****.aliyun-inc.com&access_id=****&access_key=****&delete_mode=delete&checksum_type=md5';
      ```

    示例中，`oss://` 表示使用 OSS 作为备份介质类型，存储桶名 `oceanbase-test-bucket`，在存储桶中的路径是 `/backup/data`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 用于设置存储桶的主机地址，`access_id` 和 `access_key` 用于设置 `OSS` 的访问密钥，清理模式为 `delete`，并使用 MD5 算法校验归档文件的完整性。`enable_worm=true` 表示系统将按照 WORM 的规范执行写入与删除操作。需要注意的是，OceanBase 数据库当前不会替代您设置合规保留策略，请在设置备份路径前确保 OSS Bucket 已正确设置保留策略（WORM 策略）并锁定。

    tab NFS

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>使用 NFS 作为备份介质时，需要注意以下事项：</p>
    <ul>
    <li><code>data_backup_dest</code> 的值不支持设置为带有问号（?）的字符串。</li>
    <li><code>data_backup_dest</code> 的值必须设置为绝对路径，保证 OBServer 服务器对 <code>data_backup_dest</code> 具有写权限。</li>
    <li>必须保证所有 OBServer 服务器都挂载了同一个服务器的 NFS。同时，为保证备份的顺利进行，务必使用本文档中建议的参数挂载 NFS。挂载 NFS 具体操作请参见 <a href="../200.deploy-nfs.md">部署 NFS 客户端</a>。</li>
    </ul>
    </main>

    * 使用 NFS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST= 'file:///data/nfs/backup/data' TENANT = mysql_tenant;
      ```

    * 使用 NFS 作为备份介质时，用户租户为本租户设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='file:///data/nfs/backup/data';
      ```

    示例中，`file://` 表示使用 NFS 作为备份介质类型，备份路径为 `file:///data/nfs/backup/data`。

    tab AWS S3

    与 OSS 一样，AWS S3 也支持通过 `delete_mode` 参数来配置备份文件的清理模式，配置方法与 OSS 一样。同样，AWS S3 也支持通过 `checksum_type` 参数指定校验算法来校验备份数据的完整性，支持的取值为 `md5` 和 `crc32`。如果不显式配置 `checksum_type` 参数，则默认为值为 `md5`。

    有关 `delete_mode` 参数和 `checksum_type` 参数的详细说明，参见 [SET DATA_BACKUP_DEST](../../../700.reference/500.sql-reference/100.sql-syntax/100.system-tenants/200.alter-system/3500.set-data-backup-dest.md)。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <p>使用对象存储作为备份介质时，对象存储路径的各项参数由 <code>&</code> 符号进行分隔，请确保您输入的参数值中仅包含英文字母大小写、数字、<code>/-_$+=</code> 以及通配符。如果您输入了上述以外的其他字符，可能会导致设置失败。</p>
    </main>

    使用 S3 作为备份介质的配置示例如下：

    * 使用 S3 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径，配置清理模式为 `delete`，指定校验算法为 `crc32`。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=s3.<region>.amazonaws.com&access_id=****&access_key=****&s3_region=****&delete_mode=delete&checksum_type=crc32' TENANT = mysql_tenant;
      ```

    * 使用 S3 作为备份介质时，用户租户为本租户设置备份路径，配置清理模式为 `delete`，指定校验算法为 `crc32`。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=s3.<region>.amazonaws.com&access_id=****&access_key=****&s3_region=****&delete_mode=delete&checksum_type=crc32';
      ```

    示例中，`s3://` 表示使用 S3 作为备份介质类型，存储桶名 `oceanbase-test-bucket`，在存储桶中的路径是 `/backup/data`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 用于设置 Amazon S3 服务的域名，`access_id` 和 `access_key` 用于设置 AWS 服务的访问密钥，`s3_region` 在使用 S3 作为备份介质时为必选参数，表示 S3 的存储桶所在的地域，清理模式为 `delete`，使用 CRC32 算法来校验备份数据的完整性。

    有关 AWS S3 路径格式的详细说明，参见 [附：AWS S3 路径格式说明](../1500.appendix-explanation-of-aws-s3-backupdest.md)。

    tab 兼容 S3 协议的对象存储

    由于大多数对象存储兼容了 S3 协议，对于兼容 S3 协议并满足 OceanBase 数据库要求（对象存储需要兼容实现了 OceanBase 系统调用的几个 S3 API 的行为）的对象存储均可以作为 OceanBase 数据库的备份介质，并通过访问 S3 的方式来访问兼容的对象存储，例如：OBS、GCS、COS 等都是通过 S3 协议访问。

    对于通过 S3 协议接入的 OBS、GCS、COS 等对象存储，也支持通过 `checksum_type` 参数指定校验算法来校验备份数据的完整性，仅支持取值为 `md5`。如果不显式配置 `checksum_type` 参数，则默认值为 `md5`。有关 `checksum_type` 参数的详细说明，参见 [SET DATA_BACKUP_DEST](../../../700.reference/500.sql-reference/100.sql-syntax/100.system-tenants/200.alter-system/3500.set-data-backup-dest.md)。

    <main id="notice" type='notice'>
    <h4>注意</h4>
    <ul><li>使用对象存储作为备份介质时，对象存储路径的各项参数由 <code>&</code> 符号进行分隔，请确保您输入的参数值中仅包含英文字母大小写、数字、<code>/-_$+=</code> 以及通配符。如果您输入了上述以外的其他字符，可能会导致设置失败。</li>
    <li>对于部分兼容 S3 协议的对象存储，可能不支持 AWS S3 SDK 默认的 URL 编码方式，在使用 <code>s3://</code> 协议访问时，如果出现 9129、9026 等对象存储相关的错误码，建议通过设置集群级配置项 <a href="../../../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/16620.ob_storage_s3_url_encode_type.md">ob_storage_s3_url_encode_type</a> 来指定 AWS S3 发送请求时的 URL 编码方式兼容 Rfc3986 标准。详细设置方法可参考下方 <b>使用 COS 作为备份介质的操作步骤及示例</b>。</li></ul>
    </main>

    **使用 OBS 作为备份介质的配置示例如下**：

    * 使用 OBS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=obs.****.myhuaweicloud.com&access_id=****&access_key=****' TENANT = mysql_tenant;
      ```

    * 使用 OBS 作为备份介质时，用户租户为本租户设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=obs.****.myhuaweicloud.com&access_id=****&access_key=****';
      ```

    上述示例中，`s3://` 表示使用 S3 协议访问备份目的端，存储桶名 `oceanbase-test-bucket`，在存储桶中的路径是 `/backup/data`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 用于设置 OBS 服务的域名，`access_id` 和 `access_key` 用于设置 OBS 服务的访问密钥。

    **使用 GCS 作为备份介质的配置示例如下**：

    * 使用 GCS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=https://storage.googleapis.com&access_id=****&access_key=****' TENANT = mysql_tenant;
      ```

    * 使用 GCS 作为备份介质时，用户租户为本租户设置备份路径。

      ```sql
      obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test-bucket/backup/data?host=https://storage.googleapis.com&access_id=****&access_key=****';
      ```

    上述示例中，`s3://` 表示使用 S3 协议访问备份目的端，存储桶名 `oceanbase-test-bucket`，在存储桶中的路径是 `/backup/data`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 用于设置 GCS 服务的域名，`access_id` 和 `access_key` 用于设置 GCS 服务的访问密钥。

    **使用 COS 作为备份介质的操作步骤及示例如下**：

    1. 查看集群级配置项 `ob_storage_s3_url_encode_type` 的取值。

        ```shell
        obclient> SHOW PARAMETERS LIKE '%ob_storage_s3_url_encode_type%';
        ```

        查询结果如下：

        ```shell
        +-------+----------+----------------+----------+-------------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+
        | zone  | svr_type | svr_ip         | svr_port | name                          | data_type | value   | info                                                                                                                                                                                        | section  | scope   | source  | edit_level        |
        +-------+----------+----------------+----------+-------------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+
        | zone1 | observer | 172.xx.xxx.xxx |     2882 | ob_storage_s3_url_encode_type | NULL      | default | Determines the URL encoding method for S3 requests."default": Uses the S3 standard URL encoding method."compliantRfc3986Encoding": Uses URL encoding that adheres to the RFC 3986 standard. | OBSERVER | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |
        +-------+----------+----------------+----------+-------------------------------+-----------+---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+
        1 row in set
        ```
      
    2. 如果取值为 `default`，则修改为 `compliantRfc3986Encoding`。

        ```shell
        obclient>ALTER SYSTEM SET ob_storage_s3_url_encode_type='compliantRfc3986Encoding';
        ```

        有关该配置项具体信息，参见 [ob_storage_s3_url_encode_type](../../../700.reference/800.configuration-items-and-system-variables/100.system-configuration-items/300.cluster-level-configuration-items/16620.ob_storage_s3_url_encode_type.md)。

    3. 设置备份路径并通过 `delete_mode` 参数来配置备份文件的清理模式。

        使用 COS 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径并配置为 `delete` 清理模式的示例如下：

        ```shell
        obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test/backup/data?host=cos.ap-xxxx.myqcloud.com&access_id=***&access_key=***&delete_mode=delete' TENANT = mysql_tenant;
        ```

        使用 COS 作为备份介质时，用户租户为本租户设置备份路径并配置为 `delete` 清理模式的示例如下：

        ```shell
        obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='s3://oceanbase-test/backup/data?host=cos.ap-xxxx.myqcloud.com&access_id=***&access_key=***&delete_mode=delete';
        ```

        示例中，`s3://` 表示使用 S3 协议访问备份目的端，存储桶名 `oceanbase-test`，在存储桶中的路径是 `/backup/archive`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 用于设置 COS 的主机地址，即 endpoint（不带存储桶名的地址），`access_id` 和 `access_key` 用于设置 `COS` 的访问密钥，清理模式设置为 `delete`。

      tab Azure Blob

      在 V4.3.5 版本中，从 V4.3.5 BP3 版本开始支持 Azure Blob 作为备份介质。

      与 OSS 一样，Azure Blob 也支持 `delete_mode` 参数和 `checksum_type` 参数。其中，`delete_mode` 参数用于配置备份文件的清理模式，如果不显式配置 `delete_mode` 参数，则默认使用 `delete` 模式。`checksum_type` 参数用于指定校验算法来校验备份文件的完整性，支持的取值为 `md5` 和 `no_checksum`。如果不显式配置 `checksum_type` 参数，则默认值为 `md5`。

      更多参数的详细说明，参见 [SET DATA_BACKUP_DEST](../../../700.reference/500.sql-reference/100.sql-syntax/100.system-tenants/200.alter-system/3500.set-data-backup-dest.md)。

      示例如下：

      <main id="notice" type='notice'>
      <h4>注意</h4>
      <ul><li>使用对象存储作为备份介质时，对象存储路径的各项参数由 <code>&</code> 符号进行分隔，请确保您输入的参数值中仅包含英文字母大小写、数字、<code>/-_$+=</code> 以及通配符。如果您输入了上述以外的其他字符，可能会导致设置失败。</li>
      <li>在使用 Azure Blob 作为备份介质时，要求 <code>host</code> 参数的前缀必须指定为 <code>http://</code> 或 <code>https://</code>。同时，由于 Azure Blob 默认开启了安全传输，默认是通过 <code>https://</code> 来访问，如果需要通过 <code>http://</code> 来访问，需要关闭 Azure Blob 的安全传输选项。关闭 Azure Blob 安全传输选项的详细操作，参见 <a href="https://learn.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json">Azure Blob 官网文档</a>。</li></ul>
      </main>

      * 使用 Azure Blob 作为备份介质时，系统租户为指定租户 `mysql_tenant` 设置备份路径，配置清理模式为 `delete`，同时指定校验算法为 `md5`。

        ```sql
        obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='azblob://oceanbase-test-bucket/backup/data?host=http://****.blob.core.windows.net&access_id=****&access_key=****&delete_mode=delete&checksum_type=md5' TENANT = mysql_tenant;
        ```

      * 使用 Azure Blob 作为备份介质时，用户租户为本租户设置备份路径，配置清理模式为 `delete`，同时指定校验算法为 `md5`。

        ```shell
        obclient> ALTER SYSTEM SET DATA_BACKUP_DEST='azblob://oceanbase-test-bucket/backup/data?host=http://****.blob.core.windows.net&access_id=****&access_key=****&delete_mode=delete&checksum_type=md5';
        ```

      示例中，`azblob://` 表示使用 Azure Blob 作为备份介质类型，存储桶名 `oceanbase-test-bucket`，在存储桶中的路径是 `backup/data`，同时使用 `?` 来分隔路径与参数，参数之间使用 `&` 分隔。`host` 为存储桶的主机地址，可通过容器属性或存储账户的连接串拼接得到。`access_id` 为存储账户名称，`access_key` 为 Azure Blob 的访问密钥，清理模式为 `delete`，并使用 MD5 算法校验归档文件的完整性。

    :::

3. 配置成功后，可以通过视图确认详细的配置信息。

   `sys` 租户可通过视图 `CDB_OB_BACKUP_PARAMETER` 来查看，用户租户可通过 `DBA_OB_BACKUP_PARAMETER` 来查看。

   有关数据备份相关的参数信息及查看方法，参见 [查看数据备份相关参数](700.parameters-of-data-backup.md)。

### 配置后的注意事项及说明

1. 参数 `data_backup_dest` 设置成功后，默认系统会在配置的目的端所在的目录下创建一个 `format` 文件，用于校验备份目的端的有效性信息，确保目的端内数据的完整性。故，在配置数据备份的目的端 `data_backup_dest` 时，需要注意以下事项：

   * 如果 `format` 文件不存在，则要求配置的目的端所在的目录为空，配置项才能设置成功。否则，系统会报 `-9080` 的错误，提示 format 文件不存在。

   * 如果 `format` 文件已存在，则要求 `format` 文件的内容检验通过，配置项才能设置成功。否则，系统会报 `-9081` 的错误，提示 format 文件不匹配，format 文件的内容校验主要是检查集群、租户与备份目的端类型等与当前操作的集群、租户及备份目的端类型是否匹配。

   * 在执行备份任务时，如果 `format` 文件不存在或 `format` 文件校验不通过，任务会发起失败。

2. 备份目的端设置成功后，如果用户因安全或其他原因，更改了对象存储的密钥信息，需要为已设置的备份路径更新 `access_id` 和 `access_key` 信息，具体操作参见 [更新对象存储的密钥信息](../450.change-sk-and-ak-for-the-backup-path-or-logarchive-path.md)。

## 备份秘钥

在进行数据备份前，还需要考虑源租户的加密情况，如果源租户配置了透明加密，则还需要为源租户备份秘钥。

<main id="notice" type='notice'>
<h4>注意</h4>
<p>备份秘钥后，在恢复数据前，如果源租户的加密信息触发过秘钥轮转，则需要重新备份源租户的秘钥。</p>
</main>

1. `sys` 租户或用户租户的租户管理员登录数据库。

2. 备份秘钥。

   * 系统租户为指定租户备份秘钥

     ```sql
     ALTER SYSTEM BACKUP KEY TENANT = tenant_name TO 'backup_key_path' ENCRYPTED BY 'password';
     ```

   * 用户租户为本租户备份秘钥

     语句如下：

     ```sql
     ALTER SYSTEM BACKUP KEY TO 'backup_key_path' ENCRYPTED BY 'password';
     ```

   语句中：

   * `backup_key_path`：指定秘钥待备份的路径。该路径由用户自定义，不能与数据备份或日志归档的路径相同。

   * `password`：为秘钥备份路径指定加密密码。

   系统租户将租户 `mysql_tenant` 的秘钥备份到 `file:///data_backup_dest/key` 路径的示例如下：

   ```sql
   obclient [(none)]> ALTER SYSTEM BACKUP KEY TENANT = mysql_tenant TO 'file:///data_backup_dest/key' ENCRYPTED BY '******';
   ```

3. 配置成功后，可以通过视图查看秘钥备份的路径。

   * 系统租户通过视图 `CDB_OB_BACKUP_STORAGE_INFO` 查看秘钥备份路径

     ```sql
     SELECT * FROM oceanbase.CDB_OB_BACKUP_STORAGE_INFO;
     ```

   * 用户租户通过视图 `DBA_OB_BACKUP_STORAGE_INFO` 查看秘钥备份路径

     :::tab
     tab MySQL 模式

     语句如下：

     ```sql
     SELECT * FROM oceanbase.DBA_OB_BACKUP_STORAGE_INFO;
     ```

     tab Oracle 模式

     语句如下：

     ```sql
     SELECT * FROM SYS.DBA_OB_BACKUP_STORAGE_INFO;
     ```

     :::

     有关视图 `CDB_OB_BACKUP_STORAGE_INFO` 和 `DBA_OB_BACKUP_STORAGE_INFO` 中字段的详细说明，请参见 [CDB_OB_BACKUP_STORAGE_INFO](../../../700.reference/700.system-views/300.system-view-of-sys-tenant/200.dictionary-view-of-sys-tenant/7300.o-cdb_ob_backup_storage_info-of-sys-tenant.md) 和 [DBA_OB_BACKUP_STORAGE_INFO](../../../700.reference/700.system-views/400.system-view-of-mysql-mode/200.dictionary-view-of-mysql-mode/7300.o-dba_ob_backup_storage_info-of-mysql-mode.md)。
