|description||
|---|---|
|keywords||
|dir-name||
|dir-name-en||
|tenant-type||

# 查询 tenant_id 和 table_id

在日常运维过程中，`tenant_id` 和 `table_id` 是最常用的信息。

## 查询 tenant_id

已知租户名称，需要查询租户的 `tenant_id` 时，可以通过视图 `DBA_OB_TENANTS` 来查询，系统租户和用户租户均可以查询该视图。不同的是，系统租户下展示的是所有租户（含 Meta 租户）的租户信息，用户租户展示的是本租户的信息。

* 系统租户

  系统租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT TENANT_ID, TENANT_NAME, TENANT_TYPE FROM oceanbase.DBA_OB_TENANTS WHERE TENANT_NAME='tanant_name';
  ```

* 用户租户

  MySQL 模式的用户租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT TENANT_ID, TENANT_NAME, TENANT_TYPE FROM oceanbase.DBA_OB_TENANTS;
  ```

  Oracle 模式的用户租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT TENANT_ID, TENANT_NAME, TENANT_TYPE FROM SYS.DBA_OB_TENANTS;
  ```

除此之外，系统租户和 MySQL 模式的用户租户还可以通过函数 `effective_tenant_id()` 来快速获取当前租户的 `tenant_id`。

语句如下：

```shell
obclient> SELECT effective_tenant_id();
```

## 查询 table_id

已知表名时，可以通过视图 `CDB_OB_TABLE_LOCATIONS`（系统租户） 或 `DBA_OB_TABLE_LOCATIONS`（用户租户） 查询表的 `table_id`。

* 系统租户

  系统租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT DISTINCT TABLE_ID, DATABASE_NAME, TABLE_NAME, TABLE_TYPE FROM oceanbase.CDB_OB_TABLE_LOCATIONS WHERE TENANT_ID=tenant_id AND TABLE_NAME='table_name';
  ```

* 用户租户

  MySQL 模式的用户租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT DISTINCT TABLE_ID, DATABASE_NAME, TABLE_NAME, TABLE_TYPE FROM oceanbase.DBA_OB_TABLE_LOCATIONS WHERE TABLE_NAME='table_name';
  ```

  Oracle 模式的用户租户下，可以通过以下语句进行查询。

  ```shell
  obclient> SELECT DISTINCT TABLE_ID, DATABASE_NAME, TABLE_NAME, TABLE_TYPE FROM SYS.DBA_OB_TABLE_LOCATIONS WHERE TABLE_NAME='table_name';
  ```
